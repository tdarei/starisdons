<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test All Models</title>
    <style>
        body { font-family: monospace; background: #000; color: #0f0; padding: 20px; }
        .log { margin: 5px 0; padding: 5px; background: #111; }
        .error { color: #f00; }
        .success { color: #0f0; }
        .info { color: #ff0; }
        button { background: #0f0; color: #000; padding: 10px 20px; border: none; cursor: pointer; margin: 5px; }
    </style>
</head>
<body>
    <h1>üß™ Test All Model Combinations</h1>
    <button onclick="testAll()">Test All Models</button>
    <div id="log"></div>

    <script>
        const API_KEY = new URLSearchParams(window.location.search).get('key') || localStorage.getItem('GOOGLE_API_KEY') || '';
        const TEST_PROMPT = 'Say hello';

        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${msg}`;
            document.getElementById('log').appendChild(div);
            console.log(msg);
        }

        async function testModel(modelName, endpoint) {
            log(`\nüìã Testing: ${modelName} with ${endpoint}`, 'info');
            
            try {
                const response = await fetch(
                    `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:${endpoint}?key=${API_KEY}`,
                    {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: TEST_PROMPT }] }],
                            generationConfig: {
                                temperature: 0.7,
                                maxOutputTokens: 100
                            }
                        })
                    }
                );

                if (!response.ok) {
                    const errorText = await response.text();
                    log(`‚ùå HTTP ${response.status}: ${errorText.substring(0, 200)}`, 'error');
                    return false;
                }

                if (endpoint === 'streamGenerateContent') {
                    const reader = response.body.getReader();
                    const decoder = new TextDecoder();
                    let text = '';
                    
                    while (true) {
                        const { done, value } = await reader.read();
                        if (done) break;
                        const chunk = decoder.decode(value);
                        const lines = chunk.split('\n').filter(l => l.trim());
                        for (const line of lines) {
                            if (line.startsWith('data: ')) {
                                try {
                                    const data = JSON.parse(line.substring(6));
                                    text += data.candidates?.[0]?.content?.parts?.[0]?.text || '';
                                } catch (e) {}
                            }
                        }
                    }
                    log(`‚úÖ SUCCESS! Response: "${text}"`, 'success');
                } else {
                    const data = await response.json();
                    const text = data.candidates?.[0]?.content?.parts?.[0]?.text || '';
                    log(`‚úÖ SUCCESS! Response: "${text}"`, 'success');
                }
                return true;
            } catch (error) {
                log(`‚ùå Error: ${error.message}`, 'error');
                return false;
            }
        }

        async function testAll() {
            document.getElementById('log').innerHTML = '';
            log('üöÄ Testing all model/endpoint combinations...', 'info');
            
            const tests = [
                { model: 'gemini-2.5-flash', endpoint: 'generateContent', desc: 'Standard REST' },
                { model: 'gemini-2.5-flash', endpoint: 'streamGenerateContent', desc: 'Standard Streaming' },
                { model: 'gemini-2.5-flash-live', endpoint: 'streamGenerateContent', desc: 'Live Streaming' },
                { model: 'gemini-2.5-flash-live-preview', endpoint: 'generateContent', desc: 'Preview REST' },
                { model: 'gemini-2.5-flash-live-preview', endpoint: 'streamGenerateContent', desc: 'Preview Streaming' },
                { model: 'gemini-live-2.5-flash-preview', endpoint: 'generateContent', desc: 'Live Preview REST' },
                { model: 'gemini-live-2.5-flash-preview', endpoint: 'streamGenerateContent', desc: 'Live Preview Streaming' },
            ];

            const results = [];
            for (const test of tests) {
                const success = await testModel(test.model, test.endpoint);
                results.push({ ...test, success });
                await new Promise(resolve => setTimeout(resolve, 1000)); // Wait 1 second between tests
            }

            log('\n' + '='.repeat(60), 'info');
            log('üìä SUMMARY', 'info');
            log('='.repeat(60), 'info');
            results.forEach(r => {
                log(`${r.success ? '‚úÖ' : '‚ùå'} ${r.model}:${r.endpoint} (${r.desc})`, r.success ? 'success' : 'error');
            });
        }
    </script>
</body>
</html>

