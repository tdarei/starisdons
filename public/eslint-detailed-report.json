[{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\animations.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\auth-supabase.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":161,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":161,"endColumn":20},{"ruleId":"complexity","severity":1,"message":"Async method 'register' has a complexity of 29. Maximum allowed is 20.","line":167,"column":5,"nodeType":"FunctionExpression","messageId":"complex","endLine":167,"endColumn":19},{"ruleId":"max-statements","severity":1,"message":"Async method 'register' has too many statements (54). Maximum allowed is 30.","line":167,"column":19,"nodeType":"FunctionExpression","messageId":"exceed","endLine":289,"endColumn":6},{"ruleId":"complexity","severity":1,"message":"Async method 'login' has a complexity of 25. Maximum allowed is 20.","line":292,"column":5,"nodeType":"FunctionExpression","messageId":"complex","endLine":292,"endColumn":16},{"ruleId":"max-statements","severity":1,"message":"Async method 'login' has too many statements (50). Maximum allowed is 30.","line":292,"column":16,"nodeType":"FunctionExpression","messageId":"exceed","endLine":398,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":487,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":487,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Supabase Authentication Manager\n// Handles login, registration, and user management using Supabase\n// Falls back to localStorage if Supabase is not configured\n\nclass SupabaseAuthManager {\n    constructor() {\n        this.supabase = null;\n        this.user = null;\n        this.session = null;\n        this.useSupabase = false;\n        this.fallbackToLocalStorage = true;\n\n        this.init();\n    }\n\n    async init() {\n        // Check if Supabase is configured and available\n        if (typeof SUPABASE_CONFIG !== 'undefined' && USE_SUPABASE) {\n            try {\n                // Load Supabase from CDN if not already loaded\n                if (typeof supabase === 'undefined') {\n                    await this.loadSupabase();\n                }\n\n                // Initialize Supabase client\n                this.supabase = supabase.createClient(SUPABASE_CONFIG.url, SUPABASE_CONFIG.anonKey);\n\n                this.useSupabase = true;\n                console.log('âœ… Supabase initialized');\n\n                // Check for existing session\n                const {\n                    data: { session },\n                } = await this.supabase.auth.getSession();\n                if (session) {\n                    this.session = session;\n                    await this.loadUser();\n                }\n\n                // Listen for auth state changes\n                // Store subscription for potential cleanup\n                this.authStateSubscription = this.supabase.auth.onAuthStateChange(\n                    (event, session) => {\n                        console.log('ðŸ” Auth state changed:', event);\n                        if (session) {\n                            this.session = session;\n                            this.loadUser();\n                        } else {\n                            this.session = null;\n                            this.user = null;\n                        }\n                        this.updateUI();\n                    }\n                );\n            } catch (error) {\n                console.error('âœ— Error initializing Supabase:', error);\n                console.log('âš ï¸ Falling back to localStorage');\n                this.useSupabase = false;\n                this.initLocalStorageFallback();\n            }\n        } else {\n            console.log('â„¹ï¸ Supabase not configured, using localStorage fallback');\n            this.useSupabase = false;\n            this.initLocalStorageFallback();\n        }\n\n        this.updateUI();\n    }\n\n    async loadSupabase() {\n        return new Promise((resolve, reject) => {\n            // Check if already loaded\n            if (typeof supabase !== 'undefined') {\n                resolve();\n                return;\n            }\n\n            // Load Supabase from CDN\n            const script = document.createElement('script');\n            script.src =\n                'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.0/dist/umd/supabase.min.js';\n            script.onload = () => {\n                console.log('âœ… Supabase library loaded');\n                resolve();\n            };\n            script.onerror = () => {\n                console.error('âœ— Failed to load Supabase library');\n                reject(new Error('Failed to load Supabase'));\n            };\n            document.head.appendChild(script);\n        });\n    }\n\n    initLocalStorageFallback() {\n        // Initialize localStorage-based auth as fallback\n        this.usersStorageKey = 'adriano_users';\n        this.initUsersStorage();\n        this.token = localStorage.getItem('auth_token');\n        if (this.token) {\n            this.loadUserFromLocalStorage();\n        }\n    }\n\n    initUsersStorage() {\n        if (!localStorage.getItem(this.usersStorageKey)) {\n            localStorage.setItem(this.usersStorageKey, JSON.stringify([]));\n        }\n    }\n\n    getUsers() {\n        this.initUsersStorage();\n        const usersJson = localStorage.getItem(this.usersStorageKey);\n        return JSON.parse(usersJson || '[]');\n    }\n\n    saveUsers(users) {\n        try {\n            localStorage.setItem(this.usersStorageKey, JSON.stringify(users));\n            localStorage.setItem(\n                this.usersStorageKey + '_backup',\n                JSON.stringify({\n                    users: users,\n                    timestamp: new Date().toISOString(),\n                    version: '1.0',\n                })\n            );\n        } catch (error) {\n            console.error('âœ— Error saving users:', error);\n            if (error.name === 'QuotaExceededError') {\n                localStorage.removeItem(this.usersStorageKey + '_backup');\n                localStorage.setItem(this.usersStorageKey, JSON.stringify(users));\n            }\n        }\n    }\n\n    async hashPassword(password) {\n        const encoder = new TextEncoder();\n        const data = encoder.encode(password);\n        const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n        const hashArray = Array.from(new Uint8Array(hashBuffer));\n        return hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');\n    }\n\n    generateToken(user) {\n        const payload = {\n            id: user.id,\n            username: user.username,\n            email: user.email,\n            exp: Date.now() + 7 * 24 * 60 * 60 * 1000,\n        };\n        return btoa(JSON.stringify(payload));\n    }\n\n    verifyToken(token) {\n        try {\n            const payload = JSON.parse(atob(token));\n            if (payload.exp && payload.exp < Date.now()) {\n                return null;\n            }\n            return payload;\n        } catch (_e) {\n            return null;\n        }\n    }\n\n    // Register new user\n    async register(username, email, password, fullName) {\n        console.log(`ðŸ“ Registering user: ${username}`);\n\n        if (this.useSupabase) {\n            try {\n                // Validate input\n                if (!email || !password) {\n                    return { success: false, error: 'Email and password are required' };\n                }\n\n                if (password.length < 8) {\n                    return { success: false, error: 'Password must be at least 8 characters' };\n                }\n\n                // Register with Supabase\n                const { data, error } = await this.supabase.auth.signUp({\n                    email: email.trim().toLowerCase(),\n                    password: password,\n                    options: {\n                        data: {\n                            username: username.trim(),\n                            full_name: fullName ? fullName.trim() : username.trim(),\n                        },\n                    },\n                });\n\n                if (error) {\n                    console.error('âœ— Supabase registration error:', error);\n                    return { success: false, error: error.message || 'Registration failed' };\n                }\n\n                if (data.user) {\n                    console.log('âœ“ User registered successfully with Supabase');\n                    this.user = {\n                        id: data.user.id,\n                        username: data.user.user_metadata?.username || username,\n                        email: data.user.email,\n                        fullName: data.user.user_metadata?.full_name || fullName || username,\n                    };\n                    this.session = data.session;\n                    // Store token for compatibility\n                    if (data.session && data.session.access_token) {\n                        this.token = data.session.access_token;\n                        localStorage.setItem('auth_token', data.session.access_token);\n                    }\n                    this.updateUI();\n                    return { success: true, user: this.user };\n                }\n\n                // If email confirmation is required\n                if (data.user === null) {\n                    return {\n                        success: true,\n                        message: 'Please check your email to confirm your account',\n                        user: null,\n                    };\n                }\n            } catch (error) {\n                console.error('âœ— Registration error:', error);\n                return { success: false, error: 'Registration failed. Please try again.' };\n            }\n        }\n\n        // Fallback to localStorage\n        try {\n            if (!username || !email || !password) {\n                return { success: false, error: 'Username, email, and password are required' };\n            }\n\n            if (username.length < 3) {\n                return { success: false, error: 'Username must be at least 3 characters' };\n            }\n\n            if (password.length < 8) {\n                return { success: false, error: 'Password must be at least 8 characters' };\n            }\n\n            const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n            if (!emailRegex.test(email)) {\n                return { success: false, error: 'Please enter a valid email address' };\n            }\n\n            const users = this.getUsers();\n\n            if (users.find((u) => u.username.toLowerCase() === username.toLowerCase())) {\n                return { success: false, error: 'Username already exists' };\n            }\n\n            if (users.find((u) => u.email.toLowerCase() === email.toLowerCase())) {\n                return { success: false, error: 'Email already registered' };\n            }\n\n            const hashedPassword = await this.hashPassword(password);\n\n            const newUser = {\n                id: users.length > 0 ? Math.max(...users.map((u) => u.id)) + 1 : 1,\n                username: username.trim(),\n                email: email.trim().toLowerCase(),\n                password: hashedPassword,\n                fullName: fullName ? fullName.trim() : username.trim(),\n                createdAt: new Date().toISOString(),\n                groups: [1],\n            };\n\n            users.push(newUser);\n            this.saveUsers(users);\n\n            const token = this.generateToken(newUser);\n\n            console.log('âœ“ User registered successfully (localStorage)');\n            this.token = token;\n            this.user = { ...newUser };\n            delete this.user.password;\n            localStorage.setItem('auth_token', token);\n            localStorage.setItem('auth_user', JSON.stringify(this.user));\n            this.updateUI();\n\n            return { success: true, user: this.user };\n        } catch (error) {\n            console.error('âœ— Registration error:', error);\n            return { success: false, error: 'Registration failed. Please try again.' };\n        }\n    }\n\n    // Login user\n    async login(username, password) {\n        console.log(`ðŸ”‘ Logging in: ${username}`);\n\n        if (this.useSupabase) {\n            try {\n                if (!username || !password) {\n                    return { success: false, error: 'Email and password are required' };\n                }\n\n                // Supabase uses email for login\n                // If username doesn't contain @, try to find user by username in localStorage first\n                let email = username.trim().toLowerCase();\n\n                if (!email.includes('@')) {\n                    // User entered username, not email\n                    // Try to find email from localStorage users\n                    const users = this.getUsers();\n                    const user = users.find(\n                        (u) => u.username.toLowerCase() === email || u.email.toLowerCase() === email\n                    );\n                    if (user && user.email) {\n                        email = user.email.toLowerCase();\n                    } else {\n                        // If not found in localStorage, try username as email (might work if username is email)\n                        // But Supabase requires email, so return error\n                        return {\n                            success: false,\n                            error: 'Please use your email address to login. If you registered with a username, use the email you provided during registration.',\n                        };\n                    }\n                }\n\n                const { data, error } = await this.supabase.auth.signInWithPassword({\n                    email: email,\n                    password: password,\n                });\n\n                if (error) {\n                    console.error('âœ— Supabase login error:', error);\n                    return { success: false, error: error.message || 'Invalid credentials' };\n                }\n\n                if (data.user && data.session) {\n                    console.log('âœ“ Login successful with Supabase');\n                    this.session = data.session;\n                    this.user = {\n                        id: data.user.id,\n                        username:\n                            data.user.user_metadata?.username || data.user.email?.split('@')[0],\n                        email: data.user.email,\n                        fullName:\n                            data.user.user_metadata?.full_name || data.user.email?.split('@')[0],\n                    };\n                    this.session = data.session;\n                    // Store token for compatibility\n                    if (data.session && data.session.access_token) {\n                        this.token = data.session.access_token;\n                        localStorage.setItem('auth_token', data.session.access_token);\n                    }\n                    localStorage.setItem('auth_user', JSON.stringify(this.user));\n                    this.updateUI();\n                    return { success: true, user: this.user };\n                }\n            } catch (error) {\n                console.error('âœ— Login error:', error);\n                return { success: false, error: 'Login failed. Please try again.' };\n            }\n        }\n\n        // Fallback to localStorage\n        try {\n            if (!username || !password) {\n                return { success: false, error: 'Username and password are required' };\n            }\n\n            const users = this.getUsers();\n            const user = users.find(\n                (u) =>\n                    u.username.toLowerCase() === username.toLowerCase() ||\n                    u.email.toLowerCase() === username.toLowerCase()\n            );\n\n            if (!user) {\n                return { success: false, error: 'Invalid credentials' };\n            }\n\n            const hashedPassword = await this.hashPassword(password);\n            if (hashedPassword !== user.password) {\n                return { success: false, error: 'Invalid credentials' };\n            }\n\n            const token = this.generateToken(user);\n\n            console.log('âœ“ Login successful (localStorage)');\n            const { password: _, ...userWithoutPassword } = user;\n            this.token = token;\n            this.user = userWithoutPassword;\n            localStorage.setItem('auth_token', token);\n            localStorage.setItem('auth_user', JSON.stringify(this.user));\n            this.updateUI();\n\n            return { success: true, user: this.user };\n        } catch (error) {\n            console.error('âœ— Login error:', error);\n            return { success: false, error: 'Login failed. Please try again.' };\n        }\n    }\n\n    // Logout user\n    async logout() {\n        console.log('ðŸ‘‹ Logging out');\n\n        if (this.useSupabase && this.supabase) {\n            try {\n                // Clean up auth state subscription if it exists\n                if (\n                    this.authStateSubscription &&\n                    this.authStateSubscription.data &&\n                    this.authStateSubscription.data.subscription\n                ) {\n                    this.authStateSubscription.data.subscription.unsubscribe();\n                    this.authStateSubscription = null;\n                }\n                await this.supabase.auth.signOut();\n            } catch (error) {\n                console.error('âœ— Error signing out from Supabase:', error);\n            }\n        }\n\n        this.token = null;\n        this.user = null;\n        this.session = null;\n        localStorage.removeItem('auth_token');\n        localStorage.removeItem('auth_user');\n        this.updateUI();\n\n        const basePath = window.location.pathname.split('/').slice(0, -1).join('/');\n        if (basePath && basePath !== '/') {\n            window.location.href = basePath + '/index.html';\n        } else {\n            window.location.href = 'index.html';\n        }\n    }\n\n    // Load current user\n    async loadUser() {\n        if (this.useSupabase && this.supabase) {\n            try {\n                const {\n                    data: { user },\n                    error,\n                } = await this.supabase.auth.getUser();\n\n                if (error) {\n                    throw error;\n                }\n\n                if (user) {\n                    this.user = {\n                        id: user.id,\n                        username: user.user_metadata?.username || user.email?.split('@')[0],\n                        email: user.email,\n                        fullName: user.user_metadata?.full_name || user.email?.split('@')[0],\n                    };\n                    console.log('âœ“ User loaded from Supabase:', this.user.email);\n                    return;\n                }\n            } catch (error) {\n                console.error('âœ— Error loading user from Supabase:', error);\n            }\n        }\n\n        // Fallback to localStorage\n        this.loadUserFromLocalStorage();\n    }\n\n    loadUserFromLocalStorage() {\n        if (!this.token) return;\n\n        try {\n            const payload = this.verifyToken(this.token);\n            if (!payload) {\n                throw new Error('Invalid or expired token');\n            }\n\n            const savedUser = localStorage.getItem('auth_user');\n            if (savedUser) {\n                try {\n                    this.user = JSON.parse(savedUser);\n                    const users = this.getUsers();\n                    const userExists = users.find((u) => u.id === this.user.id);\n                    if (userExists) {\n                        console.log('âœ“ User loaded from localStorage:', this.user.username);\n                        return;\n                    }\n                } catch (_e) {\n                    // Continue\n                }\n            }\n\n            const users = this.getUsers();\n            const user = users.find((u) => u.id === payload.id);\n            if (user) {\n                const { password: _, ...userWithoutPassword } = user;\n                this.user = userWithoutPassword;\n                localStorage.setItem('auth_user', JSON.stringify(this.user));\n                console.log('âœ“ User loaded from localStorage:', this.user.username);\n            } else {\n                throw new Error('User not found');\n            }\n        } catch (error) {\n            console.error('âœ— Error loading user:', error);\n            this.logout();\n        }\n    }\n\n    // Check if user is authenticated\n    isAuthenticated() {\n        if (this.useSupabase && this.supabase && this.session) {\n            return !!this.user && !!this.session;\n        }\n        return !!this.token && !!this.user && this.verifyToken(this.token) !== null;\n    }\n\n    // Get current user\n    getCurrentUser() {\n        return this.user;\n    }\n\n    // Get authorization headers\n    getHeaders() {\n        if (this.useSupabase && this.session) {\n            return {\n                'Content-Type': 'application/json',\n                Authorization: `Bearer ${this.session.access_token}`,\n            };\n        }\n        return {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${this.token}`,\n        };\n    }\n\n    // Update UI based on authentication state\n    updateUI() {\n        const isAuth = this.isAuthenticated();\n\n        const loginButtons = document.querySelectorAll('.login-button');\n        const logoutButtons = document.querySelectorAll('.logout-button');\n        const memberButtons = document.querySelectorAll('.members-only');\n\n        loginButtons.forEach((btn) => {\n            if (btn) btn.style.display = isAuth ? 'none' : 'block';\n        });\n\n        logoutButtons.forEach((btn) => {\n            if (btn) btn.style.display = isAuth ? 'block' : 'none';\n        });\n\n        memberButtons.forEach((btn) => {\n            if (btn) btn.style.display = isAuth ? 'block' : 'none';\n        });\n\n        const userDisplays = document.querySelectorAll('.user-display');\n        userDisplays.forEach((display) => {\n            if (display) {\n                if (this.user) {\n                    display.textContent = this.user.fullName || this.user.username;\n                    display.style.display = 'inline';\n                } else {\n                    display.style.display = 'none';\n                }\n            }\n        });\n\n        console.log(\n            `ðŸŽ¨ UI updated - Auth status: ${isAuth} (${this.useSupabase ? 'Supabase' : 'localStorage'})`\n        );\n    }\n}\n\n// Initialize global auth manager\n// This will use Supabase if configured, otherwise fallback to localStorage\nconst _authManager = new SupabaseAuthManager();\n// Make it available globally\nwindow.authManager = _authManager;\n\n// Modal helpers\nfunction _showModal(modalId) {\n    const modal = document.getElementById(modalId);\n    if (modal) {\n        modal.classList.add('active');\n        document.body.style.overflow = 'hidden';\n    }\n}\nwindow.showModal = _showModal;\n\nfunction _hideModal(modalId) {\n    const modal = document.getElementById(modalId);\n    if (modal) {\n        modal.classList.remove('active');\n        document.body.style.overflow = '';\n    }\n}\n\n// Close modals when clicking outside\ndocument.addEventListener('click', (e) => {\n    if (e.target.classList.contains('modal') && e.target.classList.contains('active')) {\n        e.target.classList.remove('active');\n        document.body.style.overflow = '';\n    }\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\auth.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":103,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":20},{"ruleId":"complexity","severity":1,"message":"Async method 'register' has a complexity of 21. Maximum allowed is 20.","line":117,"column":5,"nodeType":"FunctionExpression","messageId":"complex","endLine":117,"endColumn":19},{"ruleId":"max-statements","severity":1,"message":"Async method 'register' has too many statements (54). Maximum allowed is 30.","line":117,"column":19,"nodeType":"FunctionExpression","messageId":"exceed","endLine":238,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":205,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":205,"endColumn":28},{"ruleId":"max-statements","severity":1,"message":"Async method 'login' has too many statements (47). Maximum allowed is 30.","line":241,"column":16,"nodeType":"FunctionExpression","messageId":"exceed","endLine":341,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":308,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":308,"endColumn":28},{"ruleId":"max-statements","severity":1,"message":"Async method 'loadUser' has too many statements (34). Maximum allowed is 30.","line":361,"column":19,"nodeType":"FunctionExpression","messageId":"exceed","endLine":425,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":384,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":384,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Frontend Authentication Manager\n// Handles login, registration, token management, and authentication state\n// Auto-detects GitLab Pages and uses client-side auth, otherwise uses backend\n\nclass AuthManager {\n    constructor() {\n        // Auto-detect environment\n        const isGitLabPages =\n            window.location.hostname.includes('gitlab.io') ||\n            window.location.hostname.includes('gitlab-pages') ||\n            (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1');\n\n        if (isGitLabPages) {\n            console.log('ðŸŒ GitLab Pages detected - Using client-side authentication');\n            this.API_URL = null; // No backend on GitLab Pages\n            this.useClientSideAuth = true;\n            this.usersStorageKey = 'adriano_users';\n            this.initUsersStorage();\n        } else {\n            console.log('ðŸ’» Localhost detected - Using backend authentication');\n            this.API_URL = 'http://localhost:3000/api';\n            this.useClientSideAuth = false;\n        }\n\n        this.token = localStorage.getItem('auth_token');\n        this.user = null;\n        this.init();\n    }\n\n    // Initialize users storage if needed (for client-side auth)\n    initUsersStorage() {\n        if (!localStorage.getItem(this.usersStorageKey)) {\n            localStorage.setItem(this.usersStorageKey, JSON.stringify([]));\n        }\n    }\n\n    // Get all users from localStorage (for client-side auth)\n    getUsers() {\n        this.initUsersStorage();\n        const usersJson = localStorage.getItem(this.usersStorageKey);\n        return JSON.parse(usersJson || '[]');\n    }\n\n    // Save users to localStorage (for client-side auth)\n    saveUsers(users) {\n        try {\n            localStorage.setItem(this.usersStorageKey, JSON.stringify(users));\n            // Also save a backup timestamp\n            localStorage.setItem(\n                this.usersStorageKey + '_backup',\n                JSON.stringify({\n                    users: users,\n                    timestamp: new Date().toISOString(),\n                    version: '1.0',\n                })\n            );\n            console.log('âœ“ Users saved to localStorage');\n        } catch (error) {\n            console.error('âœ— Error saving users:', error);\n            // If localStorage is full, try to clean up old data\n            if (error.name === 'QuotaExceededError') {\n                console.warn('âš ï¸ localStorage full, attempting cleanup...');\n                try {\n                    // Remove old backup\n                    localStorage.removeItem(this.usersStorageKey + '_backup');\n                    // Try again\n                    localStorage.setItem(this.usersStorageKey, JSON.stringify(users));\n                } catch (e) {\n                    console.error('âœ— Could not save users after cleanup:', e);\n                }\n            }\n        }\n    }\n\n    // Simple password hashing using Web Crypto API\n    async hashPassword(password) {\n        const encoder = new TextEncoder();\n        const data = encoder.encode(password);\n        const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n        const hashArray = Array.from(new Uint8Array(hashBuffer));\n        return hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');\n    }\n\n    // Generate simple token (for client-side auth)\n    generateToken(user) {\n        const payload = {\n            id: user.id,\n            username: user.username,\n            email: user.email,\n            exp: Date.now() + 7 * 24 * 60 * 60 * 1000, // 7 days\n        };\n        return btoa(JSON.stringify(payload)); // Base64 encode\n    }\n\n    // Verify token (for client-side auth)\n    verifyToken(token) {\n        try {\n            const payload = JSON.parse(atob(token));\n            if (payload.exp && payload.exp < Date.now()) {\n                return null; // Token expired\n            }\n            return payload;\n        } catch (_e) {\n            return null;\n        }\n    }\n\n    async init() {\n        console.log('ðŸ” Auth Manager initialized');\n        if (this.token) {\n            await this.loadUser();\n        }\n        this.updateUI();\n    }\n\n    // Register new user\n    async register(username, email, password, fullName) {\n        console.log(`ðŸ“ Registering user: ${username}`);\n\n        // Use client-side authentication on GitLab Pages\n        if (this.useClientSideAuth) {\n            try {\n                // Validation\n                if (!username || !email || !password) {\n                    return { success: false, error: 'Username, email, and password are required' };\n                }\n\n                if (username.length < 3) {\n                    return { success: false, error: 'Username must be at least 3 characters' };\n                }\n\n                if (password.length < 8) {\n                    return { success: false, error: 'Password must be at least 8 characters' };\n                }\n\n                // Email validation\n                const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n                if (!emailRegex.test(email)) {\n                    return { success: false, error: 'Please enter a valid email address' };\n                }\n\n                const users = this.getUsers();\n\n                // Check if username already exists\n                if (users.find((u) => u.username.toLowerCase() === username.toLowerCase())) {\n                    return { success: false, error: 'Username already exists' };\n                }\n\n                // Check if email already exists\n                if (users.find((u) => u.email.toLowerCase() === email.toLowerCase())) {\n                    return { success: false, error: 'Email already registered' };\n                }\n\n                // Hash password\n                const hashedPassword = await this.hashPassword(password);\n\n                // Create user\n                const newUser = {\n                    id: users.length > 0 ? Math.max(...users.map((u) => u.id)) + 1 : 1,\n                    username: username.trim(),\n                    email: email.trim().toLowerCase(),\n                    password: hashedPassword,\n                    fullName: fullName ? fullName.trim() : username.trim(),\n                    createdAt: new Date().toISOString(),\n                    groups: [1],\n                };\n\n                users.push(newUser);\n                this.saveUsers(users);\n\n                // Generate token\n                const token = this.generateToken(newUser);\n\n                console.log('âœ“ User registered successfully: ' + username);\n                this.token = token;\n                this.user = { ...newUser };\n                delete this.user.password;\n                localStorage.setItem('auth_token', token);\n                localStorage.setItem('auth_user', JSON.stringify(this.user));\n                this.updateUI();\n\n                return { success: true, user: this.user };\n            } catch (error) {\n                console.error('âœ— Registration error:', error);\n                return { success: false, error: 'Registration failed. Please try again.' };\n            }\n        }\n\n        // Backend authentication (localhost)\n        try {\n            const response = await fetch(`${this.API_URL}/auth/register`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ username, email, password, fullName }),\n            });\n\n            // Check if response is ok before trying to parse JSON\n            if (!response.ok) {\n                let errorMessage = 'Registration failed';\n                try {\n                    const errorData = await response.json();\n                    errorMessage = errorData.error || errorMessage;\n                } catch (_e) {\n                    // If response is not JSON, use status text\n                    errorMessage = response.statusText || `Server error (${response.status})`;\n                }\n                throw new Error(errorMessage);\n            }\n\n            const data = await response.json();\n\n            console.log('âœ“ Registration successful');\n            this.token = data.token;\n            this.user = data.user;\n            localStorage.setItem('auth_token', data.token);\n            this.updateUI();\n\n            return { success: true, user: data.user };\n        } catch (error) {\n            console.error('âœ— Registration error:', error);\n\n            // Provide more helpful error messages\n            let errorMessage = error.message;\n            if (\n                error.message.includes('Failed to fetch') ||\n                error.message.includes('NetworkError')\n            ) {\n                errorMessage =\n                    'Cannot connect to server. Please make sure the backend server is running on port 3000.';\n            } else if (error.message.includes('CORS')) {\n                errorMessage = 'CORS error. Please check backend CORS settings.';\n            }\n\n            return { success: false, error: errorMessage };\n        }\n    }\n\n    // Login user\n    async login(username, password) {\n        console.log(`ðŸ”‘ Logging in: ${username}`);\n\n        // Use client-side authentication on GitLab Pages\n        if (this.useClientSideAuth) {\n            try {\n                if (!username || !password) {\n                    return { success: false, error: 'Username and password are required' };\n                }\n\n                const users = this.getUsers();\n\n                // Find user by username or email\n                const user = users.find(\n                    (u) =>\n                        u.username.toLowerCase() === username.toLowerCase() ||\n                        u.email.toLowerCase() === username.toLowerCase()\n                );\n\n                if (!user) {\n                    console.log('âœ— User not found');\n                    return { success: false, error: 'Invalid credentials' };\n                }\n\n                // Verify password\n                const hashedPassword = await this.hashPassword(password);\n                if (hashedPassword !== user.password) {\n                    console.log('âœ— Invalid password');\n                    return { success: false, error: 'Invalid credentials' };\n                }\n\n                // Generate token\n                const token = this.generateToken(user);\n\n                console.log('âœ“ Login successful: ' + user.username);\n\n                // Return user (without password)\n                const { password: _, ...userWithoutPassword } = user;\n                this.token = token;\n                this.user = userWithoutPassword;\n                localStorage.setItem('auth_token', token);\n                localStorage.setItem('auth_user', JSON.stringify(this.user));\n                this.updateUI();\n\n                return { success: true, user: this.user };\n            } catch (error) {\n                console.error('âœ— Login error:', error);\n                return { success: false, error: 'Login failed. Please try again.' };\n            }\n        }\n\n        // Backend authentication (localhost)\n        try {\n            const response = await fetch(`${this.API_URL}/auth/login`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ username, password }),\n            });\n\n            // Check if response is ok before trying to parse JSON\n            if (!response.ok) {\n                let errorMessage = 'Login failed';\n                try {\n                    const errorData = await response.json();\n                    errorMessage = errorData.error || errorMessage;\n                } catch (_e) {\n                    // If response is not JSON, use status text\n                    errorMessage = response.statusText || `Server error (${response.status})`;\n                }\n                throw new Error(errorMessage);\n            }\n\n            const data = await response.json();\n\n            console.log('âœ“ Login successful');\n            this.token = data.token;\n            this.user = data.user;\n            localStorage.setItem('auth_token', data.token);\n            this.updateUI();\n\n            return { success: true, user: data.user };\n        } catch (error) {\n            console.error('âœ— Login error:', error);\n\n            // Provide more helpful error messages\n            let errorMessage = error.message;\n            if (\n                error.message.includes('Failed to fetch') ||\n                error.message.includes('NetworkError')\n            ) {\n                errorMessage =\n                    'Cannot connect to server. Please make sure the backend server is running on port 3000.';\n            } else if (error.message.includes('CORS')) {\n                errorMessage = 'CORS error. Please check backend CORS settings.';\n            }\n\n            return { success: false, error: errorMessage };\n        }\n    }\n\n    // Logout user\n    logout() {\n        console.log('ðŸ‘‹ Logging out');\n        this.token = null;\n        this.user = null;\n        localStorage.removeItem('auth_token');\n        localStorage.removeItem('auth_user');\n        this.updateUI();\n        // Use relative path for GitLab Pages compatibility\n        const basePath = window.location.pathname.split('/').slice(0, -1).join('/');\n        if (basePath && basePath !== '/') {\n            window.location.href = basePath + '/index.html';\n        } else {\n            window.location.href = 'index.html';\n        }\n    }\n\n    // Load current user\n    async loadUser() {\n        if (!this.token) return;\n\n        // Use client-side authentication on GitLab Pages\n        if (this.useClientSideAuth) {\n            try {\n                const payload = this.verifyToken(this.token);\n                if (!payload) {\n                    throw new Error('Invalid or expired token');\n                }\n\n                // Try to get user from localStorage first\n                const savedUser = localStorage.getItem('auth_user');\n                if (savedUser) {\n                    try {\n                        this.user = JSON.parse(savedUser);\n                        // Verify user still exists\n                        const users = this.getUsers();\n                        const userExists = users.find((u) => u.id === this.user.id);\n                        if (userExists) {\n                            console.log('âœ“ User loaded:', this.user.username);\n                            return;\n                        }\n                    } catch (_e) {\n                        // Continue to load from users array\n                    }\n                }\n\n                // Load from users array\n                const users = this.getUsers();\n                const user = users.find((u) => u.id === payload.id);\n                if (user) {\n                    const { password: _, ...userWithoutPassword } = user;\n                    this.user = userWithoutPassword;\n                    localStorage.setItem('auth_user', JSON.stringify(this.user));\n                    console.log('âœ“ User loaded:', this.user.username);\n                } else {\n                    throw new Error('User not found');\n                }\n            } catch (error) {\n                console.error('âœ— Error loading user:', error);\n                this.logout();\n            }\n            return;\n        }\n\n        // Backend authentication (localhost)\n        try {\n            const response = await fetch(`${this.API_URL}/auth/me`, {\n                headers: {\n                    Authorization: `Bearer ${this.token}`,\n                },\n            });\n\n            if (!response.ok) {\n                throw new Error('Failed to load user');\n            }\n\n            this.user = await response.json();\n            console.log('âœ“ User loaded:', this.user.username);\n        } catch (error) {\n            console.error('âœ— Error loading user:', error);\n            this.logout();\n        }\n    }\n\n    // Check if user is authenticated\n    isAuthenticated() {\n        if (this.useClientSideAuth) {\n            return !!this.token && !!this.user && this.verifyToken(this.token) !== null;\n        }\n        return !!this.token && !!this.user;\n    }\n\n    // Get current user\n    getCurrentUser() {\n        return this.user;\n    }\n\n    // Get authorization headers\n    getHeaders() {\n        return {\n            'Content-Type': 'application/json',\n            Authorization: `Bearer ${this.token}`,\n        };\n    }\n\n    // Update UI based on authentication state\n    updateUI() {\n        const isAuth = this.isAuthenticated();\n\n        // Update login/logout buttons\n        const loginButtons = document.querySelectorAll('.login-button');\n        const logoutButtons = document.querySelectorAll('.logout-button');\n        const memberButtons = document.querySelectorAll('.members-only');\n\n        loginButtons.forEach((btn) => {\n            btn.style.display = isAuth ? 'none' : 'block';\n        });\n\n        logoutButtons.forEach((btn) => {\n            btn.style.display = isAuth ? 'block' : 'none';\n        });\n\n        memberButtons.forEach((btn) => {\n            btn.style.display = isAuth ? 'block' : 'none';\n        });\n\n        // Update user info displays\n        const userDisplays = document.querySelectorAll('.user-display');\n        userDisplays.forEach((display) => {\n            if (this.user) {\n                display.textContent = this.user.fullName || this.user.username;\n                display.style.display = 'inline';\n            } else {\n                display.style.display = 'none';\n            }\n        });\n\n        console.log(`ðŸŽ¨ UI updated - Auth status: ${isAuth}`);\n    }\n}\n\n// Initialize global auth manager\nconst _authManager = new AuthManager();\n// Make it available globally\nwindow.authManager = _authManager;\n\n// Modal helpers\nfunction _showModal(modalId) {\n    const modal = document.getElementById(modalId);\n    if (modal) {\n        modal.classList.add('active');\n        document.body.style.overflow = 'hidden';\n    }\n}\nwindow.showModal = _showModal;\n\nfunction _hideModal(modalId) {\n    const modal = document.getElementById(modalId);\n    if (modal) {\n        modal.classList.remove('active');\n        document.body.style.overflow = '';\n    }\n}\n\n// Close modals when clicking outside\ndocument.addEventListener('click', (e) => {\n    if (e.target.classList.contains('modal') && e.target.classList.contains('active')) {\n        e.target.classList.remove('active');\n        document.body.style.overflow = '';\n    }\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\backend\\auth-server.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'req' is defined but never used. Allowed unused args must match /^_/u.","line":45,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":45,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"req"},"fix":{"range":[1359,1364],"text":""},"desc":"Remove unused variable 'req'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":81,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":98,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":98,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":126,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":126,"endColumn":20}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Authentication Backend Server\n * Handles user registration, login, JWT tokens, groups, and posts\n */\n\nconst express = require('express');\nconst cors = require('cors');\nconst fs = require('fs');\nconst path = require('path');\nconst bcrypt = require('bcryptjs');\nconst jwt = require('jsonwebtoken');\n\nconst app = express();\nconst PORT = process.env.AUTH_PORT || 3000;\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production';\nconst DATA_DIR = path.join(__dirname, 'database');\nconst LOGS_DIR = path.join(__dirname, 'logs');\n\n// Ensure directories exist\n[DATA_DIR, LOGS_DIR].forEach((dir) => {\n    if (!fs.existsSync(dir)) {\n        fs.mkdirSync(dir, { recursive: true });\n    }\n});\n\n// Middleware\napp.use(cors());\napp.use(express.json());\n\n// Logging middleware\nfunction logAccess(req, res, next) {\n    const timestamp = new Date().toISOString();\n    // Get IP address safely (req.ip might not be available without trust proxy)\n    const ip =\n        req.ip || req.connection?.remoteAddress || req.headers['x-forwarded-for'] || 'unknown';\n    const logEntry = `[${timestamp}] ${req.method} ${req.path} - IP: ${ip}\\n`;\n    try {\n        fs.appendFileSync(path.join(LOGS_DIR, 'access.log'), logEntry);\n    } catch (error) {\n        console.error('Error writing to access log:', error);\n    }\n    next();\n}\n\nfunction logError(error, req) {\n    const timestamp = new Date().toISOString();\n    const logEntry = `[${timestamp}] ERROR: ${error.message}\\n${error.stack}\\n\\n`;\n    try {\n        fs.appendFileSync(path.join(LOGS_DIR, 'error.log'), logEntry);\n    } catch (logErr) {\n        console.error('Error writing to error log:', logErr);\n    }\n}\n\napp.use(logAccess);\n\n// JWT Authentication Middleware\nfunction authenticateToken(req, res, next) {\n    const authHeader = req.headers['authorization'];\n    const token = authHeader && authHeader.split(' ')[1];\n\n    if (!token) {\n        return res.status(401).json({ error: 'No token provided' });\n    }\n\n    jwt.verify(token, JWT_SECRET, (err, user) => {\n        if (err) {\n            return res.status(403).json({ error: 'Invalid or expired token' });\n        }\n        req.user = user;\n        next();\n    });\n}\n\n// Load data functions\nfunction loadUsers() {\n    const usersPath = path.join(DATA_DIR, 'users.json');\n    if (fs.existsSync(usersPath)) {\n        try {\n            return JSON.parse(fs.readFileSync(usersPath, 'utf8'));\n        } catch (_e) {\n            return [];\n        }\n    }\n    return [];\n}\n\nfunction saveUsers(users) {\n    const usersPath = path.join(DATA_DIR, 'users.json');\n    fs.writeFileSync(usersPath, JSON.stringify(users, null, 2));\n}\n\nfunction loadGroups() {\n    const groupsPath = path.join(DATA_DIR, 'groups.json');\n    if (fs.existsSync(groupsPath)) {\n        try {\n            return JSON.parse(fs.readFileSync(groupsPath, 'utf8'));\n        } catch (_e) {\n            return [];\n        }\n    }\n    // Initialize default groups\n    const defaultGroups = [\n        {\n            id: 1,\n            name: 'Cosmic Explorers',\n            description: 'Main community for all space enthusiasts',\n            members: [],\n            posts: [],\n        },\n    ];\n    saveGroups(defaultGroups);\n    return defaultGroups;\n}\n\nfunction saveGroups(groups) {\n    const groupsPath = path.join(DATA_DIR, 'groups.json');\n    fs.writeFileSync(groupsPath, JSON.stringify(groups, null, 2));\n}\n\nfunction loadPosts() {\n    const postsPath = path.join(DATA_DIR, 'posts.json');\n    if (fs.existsSync(postsPath)) {\n        try {\n            return JSON.parse(fs.readFileSync(postsPath, 'utf8'));\n        } catch (_e) {\n            return [];\n        }\n    }\n    return [];\n}\n\nfunction savePosts(posts) {\n    const postsPath = path.join(DATA_DIR, 'posts.json');\n    fs.writeFileSync(postsPath, JSON.stringify(posts, null, 2));\n}\n\n// ===== AUTHENTICATION ENDPOINTS =====\n\n// Register new user\napp.post('/api/auth/register', async (req, res) => {\n    try {\n        const { username, email, password, fullName } = req.body;\n\n        // Validation\n        if (!username || !email || !password) {\n            return res.status(400).json({ error: 'Username, email, and password are required' });\n        }\n\n        if (username.length < 3) {\n            return res.status(400).json({ error: 'Username must be at least 3 characters' });\n        }\n\n        if (password.length < 8) {\n            return res.status(400).json({ error: 'Password must be at least 8 characters' });\n        }\n\n        const users = loadUsers();\n\n        // Check if username already exists\n        if (users.find((u) => u.username === username)) {\n            return res.status(409).json({ error: 'Username already exists' });\n        }\n\n        // Check if email already exists\n        if (users.find((u) => u.email === email)) {\n            return res.status(409).json({ error: 'Email already registered' });\n        }\n\n        console.log(`ðŸ“ Registration attempt: ${username} (${email})`);\n        console.log('ðŸ”’ Hashing password...');\n\n        // Hash password\n        const hashedPassword = await bcrypt.hash(password, 12);\n\n        // Create user\n        const newUser = {\n            id: users.length > 0 ? Math.max(...users.map((u) => u.id)) + 1 : 1,\n            username,\n            email,\n            password: hashedPassword,\n            fullName: fullName || username,\n            createdAt: new Date().toISOString(),\n            groups: [1], // Auto-join main group\n        };\n\n        users.push(newUser);\n        saveUsers(users);\n\n        // Add user to main group\n        const groups = loadGroups();\n        const mainGroup = groups.find((g) => g.id === 1);\n        if (mainGroup && !mainGroup.members.includes(newUser.id)) {\n            mainGroup.members.push(newUser.id);\n            saveGroups(groups);\n        }\n\n        // Generate JWT token\n        const token = jwt.sign(\n            { id: newUser.id, username: newUser.username, email: newUser.email },\n            JWT_SECRET,\n            { expiresIn: '7d' }\n        );\n\n        console.log(`âœ“ User registered successfully: ${username}`);\n\n        // Return user (without password)\n        const { password: _, ...userWithoutPassword } = newUser;\n        res.json({\n            success: true,\n            token,\n            user: userWithoutPassword,\n        });\n    } catch (error) {\n        console.error('âœ— Registration error:', error);\n        logError(error, req);\n        res.status(500).json({ error: 'Internal server error' });\n    }\n});\n\n// Login user\napp.post('/api/auth/login', async (req, res) => {\n    try {\n        const { username, password } = req.body;\n\n        if (!username || !password) {\n            return res.status(400).json({ error: 'Username and password are required' });\n        }\n\n        console.log(`ðŸ”‘ Login attempt: ${username}`);\n\n        const users = loadUsers();\n\n        // Find user by username or email\n        const user = users.find((u) => u.username === username || u.email === username);\n\n        if (!user) {\n            console.log('âœ— User not found');\n            return res.status(401).json({ error: 'Invalid credentials' });\n        }\n\n        // Verify password\n        const isValidPassword = await bcrypt.compare(password, user.password);\n        if (!isValidPassword) {\n            console.log('âœ— Invalid password');\n            return res.status(401).json({ error: 'Invalid credentials' });\n        }\n\n        // Generate JWT token\n        const token = jwt.sign(\n            { id: user.id, username: user.username, email: user.email },\n            JWT_SECRET,\n            { expiresIn: '7d' }\n        );\n\n        console.log(`âœ“ Login successful: ${user.username}`);\n\n        // Return user (without password)\n        const { password: _, ...userWithoutPassword } = user;\n        res.json({\n            success: true,\n            token,\n            user: userWithoutPassword,\n        });\n    } catch (error) {\n        console.error('âœ— Login error:', error);\n        logError(error, req);\n        res.status(500).json({ error: 'Internal server error' });\n    }\n});\n\n// Get current user\napp.get('/api/auth/me', authenticateToken, (req, res) => {\n    try {\n        const users = loadUsers();\n        const user = users.find((u) => u.id === req.user.id);\n\n        if (!user) {\n            return res.status(404).json({ error: 'User not found' });\n        }\n\n        const { password: _, ...userWithoutPassword } = user;\n        res.json(userWithoutPassword);\n    } catch (error) {\n        console.error('âœ— Error loading user:', error);\n        logError(error, req);\n        res.status(500).json({ error: 'Internal server error' });\n    }\n});\n\n// ===== GROUPS ENDPOINTS =====\n\n// Get all groups\napp.get('/api/groups', (req, res) => {\n    try {\n        const groups = loadGroups();\n        res.json(groups);\n    } catch (error) {\n        console.error('âœ— Error loading groups:', error);\n        logError(error, req);\n        res.status(500).json({ error: 'Internal server error' });\n    }\n});\n\n// Join a group\napp.post('/api/groups/:groupId/join', authenticateToken, (req, res) => {\n    try {\n        const groupId = parseInt(req.params.groupId, 10);\n        const userId = req.user.id;\n\n        const groups = loadGroups();\n        const group = groups.find((g) => g.id === groupId);\n\n        if (!group) {\n            return res.status(404).json({ error: 'Group not found' });\n        }\n\n        if (group.members.includes(userId)) {\n            return res.status(409).json({ error: 'Already a member of this group' });\n        }\n\n        group.members.push(userId);\n        saveGroups(groups);\n\n        // Update user's groups\n        const users = loadUsers();\n        const user = users.find((u) => u.id === userId);\n        if (user && !user.groups.includes(groupId)) {\n            user.groups.push(groupId);\n            saveUsers(users);\n        }\n\n        res.json({ success: true, message: 'Joined group successfully' });\n    } catch (error) {\n        console.error('âœ— Error joining group:', error);\n        logError(error, req);\n        res.status(500).json({ error: 'Internal server error' });\n    }\n});\n\n// ===== POSTS ENDPOINTS =====\n\n// Get all posts (optionally filtered by group)\napp.get('/api/posts', (req, res) => {\n    try {\n        const groupId = req.query.groupId ? parseInt(req.query.groupId, 10) : null;\n        let posts = loadPosts();\n\n        if (groupId) {\n            posts = posts.filter((p) => p.groupId === groupId);\n        }\n\n        res.json(posts);\n    } catch (error) {\n        console.error('âœ— Error loading posts:', error);\n        logError(error, req);\n        res.status(500).json({ error: 'Internal server error' });\n    }\n});\n\n// Create a post\napp.post('/api/posts', authenticateToken, (req, res) => {\n    try {\n        const { groupId, content } = req.body;\n        const userId = req.user.id;\n\n        if (!groupId || !content) {\n            return res.status(400).json({ error: 'Group ID and content are required' });\n        }\n\n        const posts = loadPosts();\n        const newPost = {\n            id: posts.length > 0 ? Math.max(...posts.map((p) => p.id)) + 1 : 1,\n            groupId: parseInt(groupId, 10),\n            authorId: userId,\n            authorName: req.user.username,\n            content: content.trim(),\n            likes: 0,\n            comments: [],\n            views: 0,\n            createdAt: new Date().toISOString(),\n            updatedAt: new Date().toISOString(),\n        };\n\n        posts.push(newPost);\n        savePosts(posts);\n\n        console.log(`âœ“ Post created: ${newPost.id} by ${req.user.username}`);\n\n        res.json(newPost);\n    } catch (error) {\n        console.error('âœ— Error creating post:', error);\n        logError(error, req);\n        res.status(500).json({ error: 'Internal server error' });\n    }\n});\n\n// Like a post\napp.post('/api/posts/:postId/like', authenticateToken, (req, res) => {\n    try {\n        const postId = parseInt(req.params.postId, 10);\n        const posts = loadPosts();\n        const post = posts.find((p) => p.id === postId);\n\n        if (!post) {\n            return res.status(404).json({ error: 'Post not found' });\n        }\n\n        post.likes = (post.likes || 0) + 1;\n        savePosts(posts);\n\n        res.json({ likes: post.likes });\n    } catch (error) {\n        console.error('âœ— Error liking post:', error);\n        logError(error, req);\n        res.status(500).json({ error: 'Internal server error' });\n    }\n});\n\n// Add comment to post\napp.post('/api/posts/:postId/comments', authenticateToken, (req, res) => {\n    try {\n        const postId = parseInt(req.params.postId, 10);\n        const { content } = req.body;\n\n        if (!content) {\n            return res.status(400).json({ error: 'Comment content is required' });\n        }\n\n        const posts = loadPosts();\n        const post = posts.find((p) => p.id === postId);\n\n        if (!post) {\n            return res.status(404).json({ error: 'Post not found' });\n        }\n\n        if (!post.comments) {\n            post.comments = [];\n        }\n\n        const newComment = {\n            id: post.comments.length > 0 ? Math.max(...post.comments.map((c) => c.id)) + 1 : 1,\n            authorId: req.user.id,\n            authorName: req.user.username,\n            content: content.trim(),\n            createdAt: new Date().toISOString(),\n        };\n\n        post.comments.push(newComment);\n        savePosts(posts);\n\n        res.json(newComment);\n    } catch (error) {\n        console.error('âœ— Error adding comment:', error);\n        logError(error, req);\n        res.status(500).json({ error: 'Internal server error' });\n    }\n});\n\n// Root endpoint\napp.get('/', (req, res) => {\n    res.json({\n        message: 'ðŸ” ADRIANO TO THE STAR - Authentication Server',\n        version: '1.0.0',\n        endpoints: {\n            register: 'POST /api/auth/register',\n            login: 'POST /api/auth/login',\n            me: 'GET /api/auth/me',\n            groups: 'GET /api/groups',\n            joinGroup: 'POST /api/groups/:id/join',\n            posts: 'GET /api/posts',\n            createPost: 'POST /api/posts',\n            likePost: 'POST /api/posts/:id/like',\n            addComment: 'POST /api/posts/:id/comments',\n        },\n    });\n});\n\n// Health check\napp.get('/health', (_req, res) => {\n    res.json({\n        status: 'healthy',\n        server: 'Authentication Server',\n        port: PORT,\n        timestamp: new Date().toISOString(),\n    });\n});\n\n// Start server\napp.listen(PORT, () => {\n    console.log('============================================================');\n    console.log('ðŸš€ ADRIANO TO THE STAR - Backend Server');\n    console.log('============================================================');\n    console.log(`âœ“ Server running on port ${PORT}`);\n    console.log(`âœ“ Database directory: ${DATA_DIR}`);\n    console.log(`âœ“ Logs directory: ${LOGS_DIR}`);\n    console.log('âœ“ JWT encryption enabled');\n    console.log('âœ“ Password hashing: bcrypt (12 rounds)');\n    console.log('============================================================');\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\backend\\download-music.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\backend\\package-cli.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\backend\\planet-server.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\backend\\server.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\backend\\stellar-ai-server.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\booking-system.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'bookingSystem' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":321,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":321,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Epic Booking System with Countdown & Graphics\nclass BookingSystem {\n    constructor() {\n        this.events = [\n            {\n                id: 1,\n                title: 'Andromeda Galaxy Grand Opening',\n                date: new Date('2025-02-01T19:00:00'),\n                location: 'Virtual Reality Space',\n                description: 'Join us for the official launch of the Andromeda Galaxy ownership program! Experience VR tours of your future celestial properties, meet fellow space enthusiasts, and claim exclusive launch-day discounts.',\n                image: 'images/event-opening.png',\n                capacity: 500,\n                booked: 237,\n                price: 'FREE',\n                badge: 'Featured',\n                type: 'virtual'\n            },\n            {\n                id: 2,\n                title: 'Kepler-452b Ownership Ceremony',\n                date: new Date('2025-02-14T20:00:00'),\n                location: 'Online Livestream',\n                description: 'Special Valentine\\'s Day event! Claim ownership of the most Earth-like exoplanet ever discovered. Perfect romantic gift for space lovers. Includes personalized certificate and romantic star-naming options.',\n                image: 'images/bg-large.jpg',\n                capacity: 200,\n                booked: 87,\n                price: 'Â£49.99',\n                badge: 'VIP',\n                type: 'premium'\n            },\n            {\n                id: 3,\n                title: 'Cosmic Trivia Night - Win Free Planets',\n                date: new Date('2025-02-21T21:00:00'),\n                location: 'Discord + Twitch',\n                description: 'Test your space knowledge and win FREE ownership of celestial bodies! 20 planets will be given away. Compete in astronomy trivia, exoplanet identification, and NASA mission challenges.',\n                image: 'images/image_2.jpg',\n                capacity: 1000,\n                booked: 543,\n                price: 'FREE',\n                badge: 'Community',\n                type: 'free'\n            }\n        ];\n        \n        this.init();\n    }\n\n    init() {\n        this.renderEvents();\n        this.createBookingModal();\n        this.startCountdowns();\n        this.addBookingGraphics();\n    }\n\n    renderEvents() {\n        const container = document.querySelector('.events-container');\n        if (!container) return;\n\n        container.innerHTML = `\n            <div class=\"events-grid\">\n                ${this.events.map(event => this.createEventCard(event)).join('')}\n            </div>\n        `;\n    }\n\n    createEventCard(event) {\n        // const daysUntil = Math.ceil((event.date - new Date()) / (1000 * 60 * 60 * 24)); // Unused\n        const spotsLeft = event.capacity - event.booked;\n        const percentFull = Math.round((event.booked / event.capacity) * 100);\n\n        return `\n            <div class=\"event-card\" data-event-id=\"${event.id}\">\n                <div class=\"event-image-container\">\n                    <img src=\"${event.image}\" alt=\"${event.title}\" class=\"event-image\">\n                    <div class=\"event-badge ${event.type}\">${event.badge}</div>\n                </div>\n                \n                <div class=\"event-content\">\n                    <h3 class=\"event-title\">${event.title}</h3>\n                    \n                    <div class=\"event-date\">\n                        ðŸ“… ${this.formatDate(event.date)}\n                    </div>\n                    \n                    <div class=\"event-location\">\n                        ðŸ“ ${event.location}\n                    </div>\n                    \n                    <p class=\"event-description\">${event.description}</p>\n                    \n                    <div class=\"event-stats\">\n                        <div class=\"event-stat\">\n                            <span class=\"event-stat-value\">${spotsLeft}</span>\n                            <span class=\"event-stat-label\">Spots Left</span>\n                        </div>\n                        <div class=\"event-stat\">\n                            <span class=\"event-stat-value\">${percentFull}%</span>\n                            <span class=\"event-stat-label\">Booked</span>\n                        </div>\n                        <div class=\"event-stat\">\n                            <span class=\"event-stat-value\">${event.price}</span>\n                            <span class=\"event-stat-label\">Price</span>\n                        </div>\n                    </div>\n                    \n                    <div class=\"event-countdown\" data-date=\"${event.date.toISOString()}\">\n                        <div class=\"countdown-title\">Event starts in:</div>\n                        <div class=\"countdown-timer\">\n                            <div class=\"countdown-unit\">\n                                <span class=\"countdown-value days\">00</span>\n                                <span class=\"countdown-label\">Days</span>\n                            </div>\n                            <div class=\"countdown-unit\">\n                                <span class=\"countdown-value hours\">00</span>\n                                <span class=\"countdown-label\">Hours</span>\n                            </div>\n                            <div class=\"countdown-unit\">\n                                <span class=\"countdown-value minutes\">00</span>\n                                <span class=\"countdown-label\">Minutes</span>\n                            </div>\n                            <div class=\"countdown-unit\">\n                                <span class=\"countdown-value seconds\">00</span>\n                                <span class=\"countdown-label\">Seconds</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <button class=\"book-button\" onclick=\"bookingSystem.openBookingModal(${event.id})\">\n                        ${event.price === 'FREE' ? 'RSVP Now' : 'Book Tickets'}\n                    </button>\n                </div>\n            </div>\n        `;\n    }\n\n    formatDate(date) {\n        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };\n        return date.toLocaleDateString('en-GB', options);\n    }\n\n    startCountdowns() {\n        setInterval(() => {\n            document.querySelectorAll('.event-countdown').forEach(countdown => {\n                const eventDate = new Date(countdown.dataset.date);\n                const now = new Date();\n                const diff = eventDate - now;\n\n                if (diff > 0) {\n                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));\n                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);\n\n                    const daysEl = countdown.querySelector('.days');\n                    const hoursEl = countdown.querySelector('.hours');\n                    const minutesEl = countdown.querySelector('.minutes');\n                    const secondsEl = countdown.querySelector('.seconds');\n                    if (daysEl) daysEl.textContent = String(days).padStart(2, '0');\n                    if (hoursEl) hoursEl.textContent = String(hours).padStart(2, '0');\n                    if (minutesEl) minutesEl.textContent = String(minutes).padStart(2, '0');\n                    if (secondsEl) secondsEl.textContent = String(seconds).padStart(2, '0');\n                }\n            });\n        }, 1000);\n    }\n\n    createBookingModal() {\n        const modal = document.createElement('div');\n        modal.className = 'booking-modal';\n        modal.id = 'booking-modal';\n        modal.innerHTML = `\n            <div class=\"booking-modal-content\">\n                <div class=\"modal-header\">\n                    <h2 class=\"modal-title\">Book Your Spot</h2>\n                    <button class=\"modal-close\" onclick=\"bookingSystem.closeBookingModal()\">âœ• Close</button>\n                </div>\n                <form class=\"booking-form\" onsubmit=\"bookingSystem.submitBooking(event)\">\n                    <div class=\"form-group\">\n                        <label class=\"form-label\">Full Name</label>\n                        <input type=\"text\" class=\"form-input\" required placeholder=\"Enter your name\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label class=\"form-label\">Email Address</label>\n                        <input type=\"email\" class=\"form-input\" required placeholder=\"your.email@example.com\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label class=\"form-label\">Number of Tickets</label>\n                        <select class=\"form-input\" required>\n                            <option value=\"1\">1 Ticket</option>\n                            <option value=\"2\">2 Tickets</option>\n                            <option value=\"3\">3 Tickets</option>\n                            <option value=\"4\">4 Tickets</option>\n                            <option value=\"5\">5 Tickets</option>\n                        </select>\n                    </div>\n                    <div class=\"form-group\">\n                        <label class=\"form-label\">Special Requests (Optional)</label>\n                        <textarea class=\"form-input\" rows=\"3\" placeholder=\"Any special requirements or questions?\"></textarea>\n                    </div>\n                    <button type=\"submit\" class=\"submit-button\">\n                        ðŸš€ Confirm Booking\n                    </button>\n                </form>\n            </div>\n        `;\n        document.body.appendChild(modal);\n\n        // Close on background click\n        modal.addEventListener('click', (e) => {\n            if (e.target === modal) {\n                this.closeBookingModal();\n            }\n        });\n    }\n\n    openBookingModal(eventId) {\n        const event = this.events.find(e => e.id === eventId);\n        const modal = document.getElementById('booking-modal');\n        \n        if (event && modal) {\n            const modalTitle = modal.querySelector('.modal-title');\n            if (modalTitle) {\n                modalTitle.textContent = `Book: ${event.title}`;\n            }\n            modal.classList.add('active');\n            document.body.style.overflow = 'hidden';\n        }\n    }\n\n    closeBookingModal() {\n        const modal = document.getElementById('booking-modal');\n        modal.classList.remove('active');\n        document.body.style.overflow = '';\n    }\n\n    submitBooking(e) {\n        e.preventDefault();\n        \n        // Create success animation\n        const form = e.target;\n        // const formData = new FormData(form); // Unused\n        \n        alert('ðŸŽ‰ Booking Confirmed!\\n\\nYour spot has been reserved.\\nConfirmation email will be sent shortly.\\n\\nâœ¨ See you among the stars!');\n        \n        this.closeBookingModal();\n        form.reset();\n    }\n\n    addBookingGraphics() {\n        // Add animated background particles specific to booking page\n        const canvas = document.createElement('canvas');\n        canvas.id = 'booking-particles';\n        canvas.style.cssText = `\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            z-index: -3;\n            pointer-events: none;\n        `;\n        document.body.insertBefore(canvas, document.body.firstChild);\n\n        const ctx = canvas.getContext('2d');\n        canvas.width = window.innerWidth;\n        canvas.height = window.innerHeight;\n\n        // Create ticket particles\n        const tickets = [];\n        for (let i = 0; i < 30; i++) {\n            tickets.push({\n                x: Math.random() * canvas.width,\n                y: Math.random() * canvas.height,\n                size: Math.random() * 30 + 20,\n                rotation: Math.random() * Math.PI * 2,\n                rotationSpeed: (Math.random() - 0.5) * 0.02,\n                vx: (Math.random() - 0.5) * 0.5,\n                vy: (Math.random() - 0.5) * 0.5,\n                opacity: Math.random() * 0.3 + 0.1\n            });\n        }\n\n        const animateTickets = () => {\n            ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n            tickets.forEach(ticket => {\n                ticket.x += ticket.vx;\n                ticket.y += ticket.vy;\n                ticket.rotation += ticket.rotationSpeed;\n\n                if (ticket.x < -50) ticket.x = canvas.width + 50;\n                if (ticket.x > canvas.width + 50) ticket.x = -50;\n                if (ticket.y < -50) ticket.y = canvas.height + 50;\n                if (ticket.y > canvas.height + 50) ticket.y = -50;\n\n                ctx.save();\n                ctx.translate(ticket.x, ticket.y);\n                ctx.rotate(ticket.rotation);\n                ctx.fillStyle = `rgba(186, 148, 79, ${ticket.opacity})`;\n                ctx.fillRect(-ticket.size / 2, -ticket.size / 4, ticket.size, ticket.size / 2);\n                ctx.strokeStyle = `rgba(186, 148, 79, ${ticket.opacity * 0.5})`;\n                ctx.lineWidth = 2;\n                ctx.strokeRect(-ticket.size / 2, -ticket.size / 4, ticket.size, ticket.size / 2);\n                ctx.restore();\n            });\n\n            requestAnimationFrame(animateTickets);\n        };\n\n        animateTickets();\n\n        window.addEventListener('resize', () => {\n            canvas.width = window.innerWidth;\n            canvas.height = window.innerHeight;\n        });\n    }\n}\n\n// Initialize booking system\nlet bookingSystem;\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', () => {\n        bookingSystem = new BookingSystem();\n        console.log('ðŸŽŸï¸ Booking System Loaded!');\n    });\n} else {\n    const _bookingSystem = new BookingSystem();\n    window.bookingSystem = _bookingSystem;\n    console.log('ðŸŽŸï¸ Booking System Loaded!');\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\broadband-checker.js","messages":[{"ruleId":"complexity","severity":1,"message":"Method 'findProviderWebsite' has a complexity of 21. Maximum allowed is 20.","line":235,"column":5,"nodeType":"FunctionExpression","messageId":"complex","endLine":235,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used. Allowed unused args must match /^_/u.","line":555,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":555,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"e"},"fix":{"range":[30036,30037],"text":""},"desc":"Remove unused variable 'e'."}]},{"ruleId":"max-statements","severity":1,"message":"Method 'cleanup' has too many statements (32). Maximum allowed is 30.","line":738,"column":12,"nodeType":"FunctionExpression","messageId":"exceed","endLine":790,"endColumn":6}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Broadband Deal Checker\r\n// Searches and filters 339+ UK broadband providers\r\n\r\nclass BroadbandChecker {\r\n    constructor() {\r\n        this.providers = [];\r\n        this.filteredProviders = [];\r\n        this.providerWebsites = this.initializeProviderWebsites();\r\n        this.searchTimeout = null;\r\n        this.eventHandlers = {};\r\n        this.currentIframe = null;\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.loadProviders();\r\n        this.setupEventListeners();\r\n    }\r\n\r\n    initializeProviderWebsites() {\r\n        // Map of provider names to their websites\r\n        // This is a curated list - many providers may need manual lookup\r\n        return {\r\n            'BT': 'https://www.bt.com',\r\n            'EE': 'https://ee.co.uk',\r\n            'Sky': 'https://www.sky.com',\r\n            'TalkTalk': 'https://www.talktalk.co.uk',\r\n            'Virgin Media Limited': 'https://www.virginmedia.com',\r\n            'Vodafone Ltd': 'https://www.vodafone.co.uk',\r\n            'Three UK': 'https://www.three.co.uk',\r\n            'Plusnet': 'https://www.plus.net',\r\n            'NOW': 'https://www.nowtv.com/broadband',\r\n            'NOW TV': 'https://www.nowtv.com/broadband',\r\n            'giffgaff': 'https://www.giffgaff.com',\r\n            'Zen Internet': 'https://www.zen.co.uk',\r\n            'Hyperoptic Limited': 'https://www.hyperoptic.com',\r\n            'Gigaclear Limited': 'https://www.gigaclear.com',\r\n            'Community Fibre Ltd': 'https://www.communityfibre.co.uk',\r\n            'G.Network Communications Limited': 'https://www.g.network',\r\n            'CityFibre': 'https://www.cityfibre.com',\r\n            'KCOM': 'https://www.kcom.com/home/broadband',\r\n            'Origin Broadband': 'https://www.origin-broadband.co.uk',\r\n            'Aquiss': 'https://www.aquiss.net',\r\n            'Andrews & Arnold Ltd': 'https://www.aa.net.uk',\r\n            'IDNet': 'https://www.idnet.net',\r\n            'Zen Internet': 'https://www.zen.co.uk',\r\n            'Brsk': 'https://www.brsk.co.uk',\r\n            'YouFibre Limited': 'https://www.youfibre.com',\r\n            'Giganet (Cuckoo Fibre Ltd)': 'https://www.giganet.uk',\r\n            'Lit Fibre Ltd': 'https://www.litfibre.com',\r\n            'Trooli': 'https://www.trooli.com',\r\n            'Grain Connect': 'https://www.grainconnect.com',\r\n            'toob': 'https://www.toob.co.uk',\r\n            'Lightning Fibre': 'https://www.lightningfibre.com',\r\n            'WightFibre': 'https://www.wightfibre.com',\r\n            'GoFibre Broadband Limited': 'https://www.gofibre.com',\r\n            'FIBRUS NETWORKS LTD': 'https://www.fibrus.com',\r\n            'LilaConnect Ltd': 'https://www.lilaconnect.com',\r\n            'Zzoomm plc': 'https://www.zzoomm.com',\r\n            'Yayzi Broadband': 'https://www.yayzi.co.uk',\r\n            'Truespeed Communications Ltd': 'https://www.truespeed.com',\r\n            'Quickline': 'https://www.quickline.co.uk',\r\n            'Wildanet': 'https://www.wildanet.com',\r\n            'Wessex Internet Limited': 'https://www.wessexinternet.com',\r\n            'Voneus Limited': 'https://www.voneus.com',\r\n            'Twyce': 'https://www.twyce.com',\r\n            'Swish Fibre Limited (Cuckoo Fibre Ltd)': 'https://www.swishfibre.co.uk',\r\n            'Rise Fibre': 'https://www.risefibre.com',\r\n            'Purefibre Internet Ltd': 'https://www.purefibre.net',\r\n            'Opus Broadband Limited': 'https://www.opusbroadband.co.uk',\r\n            'LightSpeed Broadband Ltd': 'https://www.lightspeed.co.uk',\r\n            'Lima Communications Ltd': 'https://www.limacomms.com',\r\n            'ItsFibre': 'https://www.itsfibre.com',\r\n            'ITS Technology Group': 'https://www.itstechnologygroup.com',\r\n            'Fresh Fibre': 'https://www.freshfibre.com',\r\n            'Fibrely': 'https://www.fibrely.com',\r\n            'FibreNest': 'https://www.fibrenest.com',\r\n            'Fibrehop': 'https://www.fibrehop.com',\r\n            'Fibrecast Ltd': 'https://www.fibrecast.co.uk',\r\n            'Fusion Fibre': 'https://www.fusionfibre.co.uk',\r\n            'Fuse2': 'https://www.fuse2.com',\r\n            'Fram Broadband Ltd': 'https://www.frambroadband.com',\r\n            'Eclipse Home Broadband': 'https://www.eclipse.net.uk',\r\n            'Digital Fibre': 'https://www.digitalfibre.co.uk',\r\n            'ClearFibre': 'https://www.clearfibre.co.uk',\r\n            'Brighton Fibre': 'https://www.brightonfibre.com',\r\n            'Brillband': 'https://www.brillband.com',\r\n            'BrawBand': 'https://www.brawband.com',\r\n            'Be Fibre Limited': 'https://www.befibre.com',\r\n            'Airband Community Internet': 'https://www.airband.co.uk',\r\n            'B4RN': 'https://www.b4rn.org.uk',\r\n            'Broadband for the Rural North Limited (B4RN)': 'https://www.b4rn.org.uk',\r\n            'County Broadband': 'https://www.countybroadband.co.uk',\r\n            'Countryside Broadband': 'https://www.countrysidebroadband.co.uk',\r\n            'Connexin Limited': 'https://www.connexin.co.uk',\r\n            'Cuckoo Fibre Limited': 'https://www.cuckoo.co',\r\n            'Gigaloch Limited': 'https://www.gigaloch.com',\r\n            'Gigability Broadband Limited': 'https://www.gigability.co.uk',\r\n            'Gigabeam': 'https://www.gigabeam.co.uk',\r\n            'Hey! Broadband': 'https://www.heybroadband.com',\r\n            'Hull Fibre': 'https://www.hullfibre.com',\r\n            'Hull Telecoms': 'https://www.hulltelecoms.com',\r\n            'Mersey Fibre': 'https://www.merseyfibre.com',\r\n            'Ogi': 'https://www.ogi.co.uk',\r\n            'Onestream': 'https://www.onestream.co.uk',\r\n            'Open Fibre UK': 'https://www.openfibre.co.uk',\r\n            'Rocket Fibre Ltd': 'https://www.rocketfibre.co.uk',\r\n            'Rebel Broadband UK Limited': 'https://www.rebelbroadband.co.uk',\r\n            'Rural Communications': 'https://www.ruralcommunications.co.uk',\r\n            'Shetland Broadband': 'https://www.shetlandbroadband.com',\r\n            'Superhero Broadband': 'https://www.superhero-broadband.co.uk',\r\n            'The One Broadband': 'https://www.theonebroadband.co.uk',\r\n            'Utility Warehouse': 'https://www.utilitywarehouse.co.uk',\r\n            'Velocity1': 'https://www.velocity1.co.uk',\r\n            'Vfast ltd': 'https://www.vfast.co.uk',\r\n            'Village Networks': 'https://www.villagenetworks.co.uk',\r\n            'WeFibre': 'https://www.wefibre.com',\r\n            'WestFibre': 'https://www.westfibre.co.uk',\r\n            'York Fibre': 'https://www.yorkfibre.com',\r\n            'Your Co-op Broadband': 'https://www.coop.co.uk/broadband',\r\n            'Zarro Broadband': 'https://www.zarro.co.uk'\r\n        };\r\n    }\r\n\r\n    loadProviders() {\r\n        // Provider list from the text file\r\n        const providerList = [\r\n            '1310 LTD', '1pBroadband', '3DK (Scotland) Ltd', '6G internet Ltd',\r\n            'Acerola Telecom', 'Acorn Broadband', 'Advanced Connectivity Ltd',\r\n            'Airband Community Internet', 'AirFast', 'Alncom', 'AMG',\r\n            'Andrews & Arnold Ltd', 'Anglia Computer Solutions', 'Any Leads Ltd',\r\n            'APC Communications Solutions', 'Applecross Community Company',\r\n            'Aquilative Technologies', 'Aquiss', 'Arc', 'Arid Systems', 'Arrival',\r\n            'Ashford Fibre', 'Ask4', 'ASL', 'attend2IT', 'Auxilio IT', 'Avita Group',\r\n            'Azro Ltd', 'B4B Telecoms Ltd', 'B4RK', 'Babbacombe Computers Ltd',\r\n            'Badenoch Broadband', 'Ballscoigne', 'Be Fibre Limited', 'BeeBu Broadband',\r\n            'Bespoke Telecoms', 'Bink Broadband Ltd', 'Bletchley Networks', 'Bluwan',\r\n            'Bogons Ltd', 'Borders Online Ltd', 'BrawBand', 'Briant Broadband Limited',\r\n            'Brighton Fibre', 'Brillband', 'Broadband For Surrey Hills (B4SH)',\r\n            'Broadband for the Rural North Limited (B4RN)', 'Brsk', 'BT', 'Bunch',\r\n            'Callflow', 'Cambridge Fibre', 'Cargen Data Systems', 'Carnival Internet',\r\n            'Caspertech', 'CeltriiX Telecommunications', 'Cerberus Networks Ltd',\r\n            'Charter Software', 'Chess', 'Cipher IT Services Limited', 'Cirrus IT Services',\r\n            'CIS Ltd', 'CIX', 'ClearFibre', 'ClearSkyIT', 'CloudNet', 'Comms West',\r\n            'Community Fibre Ltd', 'Compucare trading as Pulse8', 'Comwales (Nonprofit it)',\r\n            'Connexin Limited', 'Converged Communication Solutions', 'Converged Rural Broadband',\r\n            'Corn on the Comms', 'Countrifi Networks', 'Country Connect', 'Countryside Broadband',\r\n            'County Broadband', 'CritchCorp', 'Cromarty Firth Wireless Networks',\r\n            'CTR Services Uk', 'Cuckoo Fibre Limited', 'Digita1 Ltd', 'Digital Fibre',\r\n            'Direct Save Telecom', 'DJG Technical Services LTD', 'Drimnin Community Broadband',\r\n            'Duplia', 'EasyPC Ltd', 'Eclipse Home Broadband', 'EE', 'Elite Limited',\r\n            'ElpaTech', 'e-volve Solutions', 'Exascale', 'Eze Talk Broadband', 'FAELIX',\r\n            'Fiber Zone', 'Fibrecast Ltd', 'Fibrehop', 'Fibrely', 'FibreNest',\r\n            'FIBRUS NETWORKS LTD', 'Fidelity Group', 'File Sanctuary', 'Fleur Telecom',\r\n            'Foreseer', 'Forth Tech Ltd', 'Fram Broadband Ltd', 'Freeola', 'Fresh Fibre',\r\n            'Fuse2', 'Fusion Fibre', 'G.Network Communications Limited', 'GC Broadband',\r\n            'Ghost Broadband', 'Ghost Gamer Broadband', 'Giant Communications', 'giffgaff',\r\n            'Gigabeam', 'Gigability Broadband Limited', 'Gigaclear Limited', 'Gigaloch Limited',\r\n            'Giganet (Cuckoo Fibre Ltd)', 'Glide Business', 'Go Internet', 'GoFibre Broadband Limited',\r\n            'Gower Coast IT Solutions', 'Grace Solutions', 'Grain Connect', 'Grayshott Gigabit',\r\n            'Greystar Communications', 'Hampshire Community Broadband', 'HCB', 'Hebnet',\r\n            'Hexsol Ltd', 'Hey! Broadband', 'High Tide Group', 'Highland Broadband and Lothian Broadband',\r\n            'Home Telecom', 'Home Unity', 'Host My Office', 'HS4 Internet Limited', 'Hull Fibre',\r\n            'Hull Telecoms', 'Husky Networks', 'Hyperoptic Limited', 'iceConnect',\r\n            'ICUK Computing Services Limited', 'IDNet', 'Imperial Telecom Ltd', 'incedIT',\r\n            'INeedBroadband Ltd', 'Inspira Technology Group Ltd', 'Inspire Telecom', 'Intech Fusion',\r\n            'INTERADS', 'Internet Central', 'Internet Logics', 'Internetty Limited', 'ION Systems',\r\n            'ISL Technology Group', 'IT4A', 'italk', 'ITCS UK LTD', 'ITS Technology Group',\r\n            'ItsFibre', 'ITWiser', 'Jarvis Cloud X', 'J-D Telecom', 'JJCS', 'JMS Systems',\r\n            'Jordec Communications', 'Juice Broadband', 'Jurassic (Cuckoo Fibre Ltd)', 'KCOM',\r\n            'KERO', 'KES', 'Kinetic Telecom', 'Knutsford IT', 'Kuiper Communications Limited',\r\n            'Landlines 2u', 'Lansalot', 'Leisure Connect', 'Lightning Fibre', 'LightSpeed Broadband Ltd',\r\n            'LilaConnect Ltd', 'Lima Communications Ltd', 'Link broadband', 'Lit Fibre Ltd',\r\n            'Localphone', 'Loop Scorpio', 'Mac-man Ltd', 'Marykirk.com', 'Max Fibre', 'MBDEV',\r\n            'Megganet', 'Mersey Fibre', 'Merula Limited', 'Michaelston-y-Fedw Internet CIC',\r\n            'Microtalk', 'MIH VoIP & Broadband', 'Millennium Telecom Ltd', 'MJRCC Ltd',\r\n            'Monsternet Highland', 'Moortek', 'Mt. Helicon Technologies Ltd', 'MTH Networks',\r\n            'Net1', 'Netcalibre', 'No Metric', 'No One Internet', 'Not Just Computers Ltd', 'NOW',\r\n            'NWIMS', 'Odyssey', 'Ogi', 'Olilo', 'Onecom', 'Onestream', 'Onex Solutions',\r\n            'Open Fibre UK', 'Optima', 'Opus Broadband Limited', 'ORBIX UK Ltd', 'Origin Broadband',\r\n            'Phase 5 communications', 'Photonic Networks', 'Plusnet', 'Point2Point IT', 'POP Telecom',\r\n            'Precision IT Cymru', 'Premier System Solutions Ltd', 'Premier Talk UK',\r\n            'Protect & Connect Ltd', 'Purefibre Internet Ltd', 'Puzzle Technology Ltd',\r\n            'Quayside Technical Services', 'Quickline', 'Rapid Rural Internet Services',\r\n            'Ravenbridge', 'Rebel Broadband UK Limited', 'Red Dragon I.T. Ltd.', 'RedBox Events',\r\n            'Regis IT', 'Rethink IT Group', 'Rise Fibre', 'Rocket Fibre Ltd', 'RooneyVOIP',\r\n            'Rural Communications', 'SCG', 'Scot-Tel-Gould', 'SDC Digital', 'seethelight From Sky',\r\n            'Sevenoaks Computers', 'Sherwood Data Systems Ltd', 'Shetland Broadband',\r\n            'Simple Telecoms', 'Single Mode Networks', 'SKT Controls & Communications Ltd', 'Sky',\r\n            'Skyenet', 'Squirrel Internet Ltd', 'StayConnected.Systems', 'Stride Communications',\r\n            'Structured Communications', 'Sumlock Bondain', 'Supanet Limited', 'Superhero Broadband',\r\n            'Supported Computing Limited', 'Swish Fibre Limited (Cuckoo Fibre Ltd)', 'TalkTalk',\r\n            'Tarragon Solutions Ltd', 'TeamIT Solutions ltd', 'Techworx IT', 'Teleconnect',\r\n            'The Cent.re Group Limited.', 'The Communication Gateway', 'The IT Dept',\r\n            'The One Broadband', 'Three UK', 'Time Talk', 'toob', 'TOTSCO Hub', 'Touch Telecom',\r\n            'Transparent Telecom', 'Triarom Ltd', 'Trooli', 'Truespeed Communications Ltd', 'Twyce',\r\n            'Unchained ISP', 'Unmasked Technology', 'Uptime Allies', 'UrFibre', 'Utility Warehouse',\r\n            'V4 Consumer', 'VDX Networks', 'Velocity1', 'VersaTek', 'Vfast ltd', 'Via Wire',\r\n            'Village Networks', 'Virgin Media Limited', 'Vispa', 'Vodafone Ltd', 'Voiceflex',\r\n            'VoiceHost Limited', 'VoIPVoice Telecom', 'Vonage Business Limited', 'Voneus Limited',\r\n            'Voxon', 'W3Z Broadband', 'Warden Technology Services Limited', 'Watch Software',\r\n            'WBCB', 'WebMate', 'Website Success', 'WeFibre', 'Welcoms', 'Wessex Internet Limited',\r\n            'WestFibre', 'WiFi Scotland LLP', 'WiFiSetup', 'WightFibre', 'Wildanet', 'WILDYE LIMITED',\r\n            'WiSpire', 'Wizards', 'WNCUK.NET', 'Worcester I.T. Services', 'XPON Wireless',\r\n            'Yayzi Broadband', 'York Fibre', 'YouFibre Limited', 'Your Computer People Ltd',\r\n            'Your Co-op Broadband', 'Zarro Broadband', 'Zen Internet', 'Zzoomm plc'\r\n        ];\r\n\r\n        // Process providers\r\n        this.providers = providerList.map(name => {\r\n            const cleanName = name.replace(/&amp;/g, '&');\r\n            const website = this.providerWebsites[cleanName] || this.findProviderWebsite(cleanName);\r\n            const type = this.determineProviderType(cleanName);\r\n            const hasGigabit = this.hasGigabitCapability(cleanName);\r\n            \r\n            return {\r\n                name: cleanName,\r\n                originalName: name,\r\n                website: website,\r\n                type: type,\r\n                hasFibre: this.hasFibreInName(cleanName),\r\n                hasGigabit: hasGigabit,\r\n                isRural: this.isRuralProvider(cleanName),\r\n                isBusiness: this.isBusinessProvider(cleanName),\r\n                deals: null // Will be populated by deal extraction\r\n            };\r\n        });\r\n\r\n        this.filteredProviders = [...this.providers];\r\n        this.renderProviders();\r\n        this.updateStatistics();\r\n        this.hideLoading();\r\n    }\r\n\r\n    findProviderWebsite(name) {\r\n        // Enhanced website lookup with better matching\r\n        const cleanName = name.toLowerCase().trim();\r\n        \r\n        // Try exact match first (case-insensitive)\r\n        const exactMatch = Object.keys(this.providerWebsites).find(\r\n            key => key.toLowerCase() === cleanName\r\n        );\r\n        if (exactMatch) {\r\n            return this.providerWebsites[exactMatch];\r\n        }\r\n        \r\n        // Try partial match (provider name contains key or vice versa)\r\n        for (const [key, url] of Object.entries(this.providerWebsites)) {\r\n            const keyLower = key.toLowerCase();\r\n            if (cleanName.includes(keyLower) || keyLower.includes(cleanName)) {\r\n                return url;\r\n            }\r\n        }\r\n        \r\n        // Try to construct URL from provider name (last resort)\r\n        const urlName = cleanName\r\n            .replace(/[^a-z0-9\\s]/g, '')\r\n            .replace(/\\s+/g, '')\r\n            .replace(/limited|ltd|plc|uk|communications|broadband|fibre|network|telecom|telecoms|group|holdings/gi, '')\r\n            .trim();\r\n        \r\n        // Special cases for common patterns\r\n        if (urlName.includes('bt') || urlName === 'bt') {\r\n            return 'https://www.bt.com';\r\n        }\r\n        if (urlName.includes('ee') || urlName === 'ee') {\r\n            return 'https://ee.co.uk';\r\n        }\r\n        if (urlName.includes('sky') || urlName === 'sky') {\r\n            return 'https://www.sky.com';\r\n        }\r\n        if (urlName.includes('virgin') || urlName === 'virgin') {\r\n            return 'https://www.virginmedia.com';\r\n        }\r\n        if (urlName.includes('talktalk') || urlName === 'talktalk') {\r\n            return 'https://www.talktalk.co.uk';\r\n        }\r\n        if (urlName.includes('vodafone') || urlName === 'vodafone') {\r\n            return 'https://www.vodafone.co.uk';\r\n        }\r\n        if (urlName.includes('plusnet') || urlName === 'plusnet') {\r\n            return 'https://www.plus.net';\r\n        }\r\n        \r\n        // Generic .co.uk pattern (only if we have a reasonable name)\r\n        if (urlName.length > 2 && urlName.length < 30) {\r\n            return `https://www.${urlName}.co.uk`;\r\n        }\r\n        \r\n        return null;\r\n    }\r\n\r\n    determineProviderType(name) {\r\n        const lower = name.toLowerCase();\r\n        if (lower.includes('business') || lower.includes('b2b') || lower.includes('enterprise')) {\r\n            return 'business';\r\n        }\r\n        if (lower.includes('rural') || lower.includes('countryside') || lower.includes('community')) {\r\n            return 'rural';\r\n        }\r\n        return 'residential';\r\n    }\r\n\r\n    hasFibreInName(name) {\r\n        return name.toLowerCase().includes('fibre') || name.toLowerCase().includes('fiber');\r\n    }\r\n\r\n    hasGigabitCapability(name) {\r\n        const lower = name.toLowerCase();\r\n        const gigabitKeywords = [\r\n            'gigabit', 'giga', 'gig', '1gbps', '1000mbps', 'hyperoptic', \r\n            'gigaclear', 'community fibre', 'g.network', 'brsk', 'youfibre',\r\n            'giganet', 'lit fibre', 'trooli', 'toob', 'lightning', 'fibrus',\r\n            'zzoomm', 'yayzi', 'truespeed', 'swish', 'lightspeed', 'fresh',\r\n            'fibrely', 'fibrenest', 'fusion', 'clearfibre', 'brighton', 'brillband',\r\n            'brawband', 'befibre', 'gigaloch', 'gigability', 'gigabeam', 'hey',\r\n            'rocket', 'wefibre', 'westfibre', 'york', 'open fibre'\r\n        ];\r\n        return gigabitKeywords.some(keyword => lower.includes(keyword));\r\n    }\r\n\r\n    isRuralProvider(name) {\r\n        const ruralKeywords = ['rural', 'countryside', 'community', 'village', 'b4rn', 'b4sh'];\r\n        return ruralKeywords.some(keyword => name.toLowerCase().includes(keyword));\r\n    }\r\n\r\n    isBusinessProvider(name) {\r\n        const businessKeywords = ['business', 'b2b', 'enterprise', 'commercial', 'corporate'];\r\n        return businessKeywords.some(keyword => name.toLowerCase().includes(keyword));\r\n    }\r\n\r\n    setupEventListeners() {\r\n        const searchInput = document.getElementById('provider-search');\r\n        const searchBtn = document.getElementById('search-btn');\r\n        const speedFilter = document.getElementById('speed-filter');\r\n        const typeFilter = document.getElementById('type-filter');\r\n        const clearFilters = document.getElementById('clear-filters');\r\n        const postcodeInput = document.getElementById('postcode-input');\r\n        const checkPostcodeBtn = document.getElementById('check-postcode-btn');\r\n\r\n        // Null checks\r\n        if (!searchInput || !searchBtn || !speedFilter || !typeFilter || \r\n            !clearFilters || !postcodeInput || !checkPostcodeBtn) {\r\n            console.warn('âš ï¸ Some DOM elements not found in broadband-checker');\r\n            return;\r\n        }\r\n\r\n        // Store event handlers for cleanup\r\n        this.eventHandlers.debouncedSearch = () => {\r\n            if (this.searchTimeout) clearTimeout(this.searchTimeout);\r\n            this.searchTimeout = setTimeout(() => this.filterProviders(), 300);\r\n        };\r\n\r\n        this.eventHandlers.searchClick = () => {\r\n            if (this.searchTimeout) clearTimeout(this.searchTimeout);\r\n            this.filterProviders();\r\n        };\r\n\r\n        this.eventHandlers.searchKeypress = (e) => {\r\n            if (e.key === 'Enter') {\r\n                if (this.searchTimeout) clearTimeout(this.searchTimeout);\r\n                this.filterProviders();\r\n            }\r\n        };\r\n\r\n        this.eventHandlers.speedFilterChange = () => this.filterProviders();\r\n        this.eventHandlers.typeFilterChange = () => this.filterProviders();\r\n        this.eventHandlers.clearFiltersClick = () => this.clearFilters();\r\n        this.eventHandlers.checkPostcodeClick = () => this.checkPostcode();\r\n        this.eventHandlers.postcodeKeypress = (e) => {\r\n            if (e.key === 'Enter') {\r\n                this.checkPostcode();\r\n            }\r\n        };\r\n\r\n        // Add event listeners\r\n        searchInput.addEventListener('input', this.eventHandlers.debouncedSearch);\r\n        searchBtn.addEventListener('click', this.eventHandlers.searchClick);\r\n        searchInput.addEventListener('keypress', this.eventHandlers.searchKeypress);\r\n        speedFilter.addEventListener('change', this.eventHandlers.speedFilterChange);\r\n        typeFilter.addEventListener('change', this.eventHandlers.typeFilterChange);\r\n        clearFilters.addEventListener('click', this.eventHandlers.clearFiltersClick);\r\n        checkPostcodeBtn.addEventListener('click', this.eventHandlers.checkPostcodeClick);\r\n        postcodeInput.addEventListener('keypress', this.eventHandlers.postcodeKeypress);\r\n    }\r\n\r\n    filterProviders() {\r\n        const searchInput = document.getElementById('provider-search');\r\n        const speedFilterEl = document.getElementById('speed-filter');\r\n        const typeFilterEl = document.getElementById('type-filter');\r\n        \r\n        if (!searchInput || !speedFilterEl || !typeFilterEl) {\r\n            console.warn('âš ï¸ Filter elements not found');\r\n            return;\r\n        }\r\n        \r\n        const searchTerm = searchInput.value.toLowerCase();\r\n        const speedFilter = speedFilterEl.value;\r\n        const typeFilter = typeFilterEl.value;\r\n\r\n        this.filteredProviders = this.providers.filter(provider => {\r\n            // Search filter\r\n            const matchesSearch = !searchTerm || provider.name.toLowerCase().includes(searchTerm);\r\n            \r\n            // Speed filter\r\n            let matchesSpeed = true;\r\n            if (speedFilter === 'fibre') {\r\n                matchesSpeed = provider.hasFibre;\r\n            } else if (speedFilter === 'ultra-fast') {\r\n                matchesSpeed = provider.hasFibre || provider.name.toLowerCase().includes('gigabit') || \r\n                              provider.name.toLowerCase().includes('ultra');\r\n            } else if (speedFilter === 'gigabit') {\r\n                matchesSpeed = provider.name.toLowerCase().includes('gigabit') || \r\n                              provider.name.toLowerCase().includes('giga');\r\n            }\r\n            \r\n            // Type filter\r\n            let matchesType = true;\r\n            if (typeFilter === 'residential') {\r\n                matchesType = provider.type === 'residential';\r\n            } else if (typeFilter === 'business') {\r\n                matchesType = provider.type === 'business' || provider.isBusiness;\r\n            } else if (typeFilter === 'rural') {\r\n                matchesType = provider.type === 'rural' || provider.isRural;\r\n            }\r\n\r\n            return matchesSearch && matchesSpeed && matchesType;\r\n        });\r\n\r\n        this.renderProviders();\r\n        this.updateStatistics();\r\n    }\r\n\r\n    clearFilters() {\r\n        const searchInput = document.getElementById('provider-search');\r\n        const speedFilter = document.getElementById('speed-filter');\r\n        const typeFilter = document.getElementById('type-filter');\r\n        \r\n        if (!searchInput || !speedFilter || !typeFilter) {\r\n            console.warn('âš ï¸ Filter elements not found');\r\n            return;\r\n        }\r\n        \r\n        searchInput.value = '';\r\n        speedFilter.value = '';\r\n        typeFilter.value = '';\r\n        \r\n        this.filteredProviders = [...this.providers];\r\n        this.renderProviders();\r\n        this.updateStatistics();\r\n    }\r\n\r\n    renderProviders() {\r\n        const resultsContainer = document.getElementById('provider-results');\r\n        const noResults = document.getElementById('no-results');\r\n        \r\n        if (!resultsContainer || !noResults) {\r\n            console.warn('âš ï¸ Results container or no-results element not found');\r\n            return;\r\n        }\r\n        \r\n        if (this.filteredProviders.length === 0) {\r\n            resultsContainer.innerHTML = '';\r\n            noResults.style.display = 'block';\r\n            return;\r\n        }\r\n\r\n        noResults.style.display = 'none';\r\n        resultsContainer.innerHTML = this.filteredProviders.map((provider, index) => `\r\n            <div class=\"provider-card\" data-entrance=\"fadeIn\" data-provider-index=\"${index}\">\r\n                <div class=\"provider-header\">\r\n                    <div class=\"provider-name\">${this.escapeHtml(provider.name)}</div>\r\n                    ${provider.hasGigabit ? '<span class=\"gigabit-badge\">âš¡ 1 Gbps+</span>' : ''}\r\n                </div>\r\n                <div class=\"provider-type\">${this.escapeHtml(provider.type)}</div>\r\n                ${provider.hasFibre ? '<div class=\"provider-info\">âœ“ Fibre Available</div>' : ''}\r\n                ${provider.hasGigabit ? '<div class=\"provider-info\" style=\"color: #4ade80; font-weight: 600;\">ðŸš€ Gigabit Speeds Available</div>' : ''}\r\n                ${this.renderDeals(provider)}\r\n                ${provider.website ? `\r\n                    <div class=\"provider-actions\">\r\n                        <button class=\"provider-link provider-view-btn\" data-url=\"${this.escapeHtml(provider.website)}\" data-name=\"${this.escapeHtml(provider.name)}\">\r\n                            ðŸŒ View in Page\r\n                        </button>\r\n                        <a href=\"${this.escapeHtml(provider.website)}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"provider-link provider-external-btn\">\r\n                            â†— Open in New Tab\r\n                        </a>\r\n                    </div>\r\n                ` : '<div class=\"provider-info\" style=\"color: rgba(255,255,255,0.4);\">Website: Check provider directly</div>'}\r\n            </div>\r\n        `).join('');\r\n        \r\n        // Add event listeners to view buttons\r\n        this.attachViewButtonListeners();\r\n    }\r\n\r\n    escapeHtml(text) {\r\n        const div = document.createElement('div');\r\n        div.textContent = text;\r\n        return div.innerHTML;\r\n    }\r\n\r\n    renderDeals(provider) {\r\n        if (!provider.hasGigabit) return '';\r\n        \r\n        // Known 1 Gbps+ deals for major providers\r\n        const knownDeals = {\r\n            'Hyperoptic Limited': { speed: '1 Gbps', price: 'From Â£35/month', note: 'Full Fibre' },\r\n            'Gigaclear Limited': { speed: '1 Gbps', price: 'From Â£49/month', note: 'Rural Gigabit' },\r\n            'Community Fibre Ltd': { speed: '1 Gbps', price: 'From Â£25/month', note: 'London Only' },\r\n            'G.Network Communications Limited': { speed: '1 Gbps', price: 'From Â£30/month', note: 'London' },\r\n            'Brsk': { speed: '1 Gbps', price: 'From Â£29/month', note: 'Full Fibre' },\r\n            'YouFibre Limited': { speed: '1 Gbps', price: 'From Â£29/month', note: 'Full Fibre' },\r\n            'Giganet (Cuckoo Fibre Ltd)': { speed: '1 Gbps', price: 'From Â£39/month', note: 'Full Fibre' },\r\n            'Lit Fibre Ltd': { speed: '1 Gbps', price: 'From Â£35/month', note: 'Full Fibre' },\r\n            'toob': { speed: '1 Gbps', price: 'From Â£25/month', note: 'Full Fibre' },\r\n            'Lightning Fibre': { speed: '1 Gbps', price: 'From Â£35/month', note: 'Full Fibre' },\r\n            'GoFibre Broadband Limited': { speed: '1 Gbps', price: 'From Â£35/month', note: 'Full Fibre' },\r\n            'FIBRUS NETWORKS LTD': { speed: '1 Gbps', price: 'From Â£30/month', note: 'Northern Ireland' },\r\n            'Zzoomm plc': { speed: '1 Gbps', price: 'From Â£29/month', note: 'Full Fibre' },\r\n            'Yayzi Broadband': { speed: '1 Gbps', price: 'From Â£25/month', note: 'Full Fibre' },\r\n            'Truespeed Communications Ltd': { speed: '1 Gbps', price: 'From Â£35/month', note: 'South West' },\r\n            'Virgin Media Limited': { speed: '1 Gbps', price: 'From Â£62/month', note: 'Cable' },\r\n            'BT': { speed: '1 Gbps', price: 'From Â£60/month', note: 'Full Fibre' },\r\n            'Sky': { speed: '1 Gbps', price: 'From Â£55/month', note: 'Full Fibre' },\r\n            'EE': { speed: '1 Gbps', price: 'From Â£60/month', note: 'Full Fibre' }\r\n        };\r\n\r\n        const deal = knownDeals[provider.name];\r\n        if (deal) {\r\n            return `\r\n                <div class=\"provider-deals\">\r\n                    <div class=\"deal-card\">\r\n                        <div class=\"deal-speed\">${deal.speed}</div>\r\n                        <div class=\"deal-price\">${deal.price}</div>\r\n                        <div class=\"deal-note\">${deal.note}</div>\r\n                    </div>\r\n                </div>\r\n            `;\r\n        }\r\n        \r\n        // Generic gigabit indicator\r\n        return `\r\n            <div class=\"provider-deals\">\r\n                <div class=\"deal-card generic-deal\">\r\n                    <div class=\"deal-speed\">1 Gbps+ Available</div>\r\n                    <div class=\"deal-note\">Check website for current deals</div>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    attachViewButtonListeners() {\r\n        const viewButtons = document.querySelectorAll('.provider-view-btn');\r\n        viewButtons.forEach(btn => {\r\n            btn.addEventListener('click', (e) => {\r\n                const url = btn.getAttribute('data-url');\r\n                const name = btn.getAttribute('data-name');\r\n                if (url) {\r\n                    this.openProviderInPage(url, name);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    openProviderInPage(url, providerName) {\r\n        // Create or show modal\r\n        let modal = document.getElementById('provider-viewer-modal');\r\n        if (!modal) {\r\n            modal = this.createViewerModal();\r\n            document.body.appendChild(modal);\r\n        }\r\n        \r\n        modal.style.display = 'flex';\r\n        document.body.style.overflow = 'hidden'; // Prevent background scrolling\r\n        \r\n        // Update modal title\r\n        const titleEl = modal.querySelector('.viewer-title');\r\n        if (titleEl) {\r\n            titleEl.textContent = `${providerName} - Website Viewer`;\r\n        }\r\n        \r\n        // Create or update iframe\r\n        let iframe = modal.querySelector('.provider-iframe');\r\n        if (!iframe) {\r\n            iframe = document.createElement('iframe');\r\n            iframe.className = 'provider-iframe';\r\n            iframe.setAttribute('sandbox', 'allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox');\r\n            iframe.setAttribute('loading', 'lazy');\r\n            const iframeContainer = modal.querySelector('.iframe-container');\r\n            if (iframeContainer) {\r\n                iframeContainer.appendChild(iframe);\r\n            }\r\n        }\r\n        \r\n        // Set iframe source\r\n        iframe.src = url;\r\n        this.currentIframe = iframe;\r\n        \r\n        // Show loading state\r\n        const loadingEl = modal.querySelector('.iframe-loading');\r\n        if (loadingEl) {\r\n            loadingEl.style.display = 'flex';\r\n        }\r\n        \r\n        // Timeout fallback for slow-loading sites\r\n        const loadTimeout = setTimeout(() => {\r\n            if (loadingEl && loadingEl.style.display !== 'none') {\r\n                loadingEl.innerHTML = `\r\n                    <p style=\"color: rgba(255,255,255,0.7); margin-bottom: 1rem;\">â³ Website is taking longer than expected to load...</p>\r\n                    <p style=\"color: rgba(255,255,255,0.5); font-size: 0.9rem;\">This may be due to slow connection or site restrictions.</p>\r\n                    <a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer\" \r\n                       style=\"display: inline-block; margin-top: 1rem; padding: 0.75rem 1.5rem; \r\n                              background: rgba(186, 148, 79, 0.3); border: 2px solid rgba(186, 148, 79, 0.5); \r\n                              border-radius: 8px; color: #ba944f; text-decoration: none; font-weight: 600;\">\r\n                        â†— Open in New Tab Instead\r\n                    </a>\r\n                `;\r\n            }\r\n        }, 10000); // 10 second timeout\r\n        \r\n        // Hide loading when iframe loads successfully\r\n        iframe.onload = () => {\r\n            clearTimeout(loadTimeout);\r\n            if (loadingEl) {\r\n                loadingEl.style.display = 'none';\r\n            }\r\n        };\r\n        \r\n        // Handle iframe loading errors\r\n        iframe.onerror = () => {\r\n            clearTimeout(loadTimeout);\r\n            if (loadingEl) {\r\n                loadingEl.innerHTML = `\r\n                    <p style=\"color: #ff6b6b; margin-bottom: 1rem;\">âš ï¸ Could not load website in iframe.</p>\r\n                    <p style=\"color: rgba(255,255,255,0.7); margin-bottom: 1rem;\">Some websites block iframe embedding for security reasons.</p>\r\n                    <a href=\"${url}\" target=\"_blank\" rel=\"noopener noreferrer\" \r\n                       style=\"display: inline-block; padding: 0.75rem 1.5rem; background: rgba(186, 148, 79, 0.3); \r\n                              border: 2px solid rgba(186, 148, 79, 0.5); border-radius: 8px; color: #ba944f; \r\n                              text-decoration: none; font-weight: 600;\">\r\n                        â†— Open in New Tab Instead\r\n                    </a>\r\n                `;\r\n            }\r\n        };\r\n    }\r\n\r\n    createViewerModal() {\r\n        const modal = document.createElement('div');\r\n        modal.id = 'provider-viewer-modal';\r\n        modal.className = 'provider-viewer-modal';\r\n        modal.innerHTML = `\r\n            <div class=\"viewer-overlay\"></div>\r\n            <div class=\"viewer-container\">\r\n                <div class=\"viewer-header\">\r\n                    <h2 class=\"viewer-title\">Provider Website</h2>\r\n                    <div class=\"viewer-controls\">\r\n                        <button class=\"viewer-btn refresh-btn\" title=\"Refresh\">ðŸ”„</button>\r\n                        <button class=\"viewer-btn fullscreen-btn\" title=\"Toggle Fullscreen\">â›¶</button>\r\n                        <button class=\"viewer-btn close-btn\" title=\"Close\">âœ•</button>\r\n                    </div>\r\n                </div>\r\n                <div class=\"iframe-container\">\r\n                    <div class=\"iframe-loading\">\r\n                        <div class=\"spinner\"></div>\r\n                        <p>Loading website...</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n        \r\n        // Add event listeners\r\n        const overlay = modal.querySelector('.viewer-overlay');\r\n        const closeBtn = modal.querySelector('.close-btn');\r\n        const refreshBtn = modal.querySelector('.refresh-btn');\r\n        const fullscreenBtn = modal.querySelector('.fullscreen-btn');\r\n        \r\n        const closeHandler = () => this.closeViewer();\r\n        const refreshHandler = () => {\r\n            const iframe = modal.querySelector('.provider-iframe');\r\n            if (iframe) {\r\n                iframe.src = iframe.src; // Reload iframe\r\n            }\r\n        };\r\n        const fullscreenHandler = () => this.toggleFullscreen();\r\n        \r\n        overlay.addEventListener('click', closeHandler);\r\n        closeBtn.addEventListener('click', closeHandler);\r\n        refreshBtn.addEventListener('click', refreshHandler);\r\n        fullscreenBtn.addEventListener('click', fullscreenHandler);\r\n        \r\n        // Store handlers for cleanup\r\n        modal._closeHandler = closeHandler;\r\n        modal._refreshHandler = refreshHandler;\r\n        modal._fullscreenHandler = fullscreenHandler;\r\n        \r\n        // Close on Escape key\r\n        const escapeHandler = (e) => {\r\n            if (e.key === 'Escape') {\r\n                this.closeViewer();\r\n            }\r\n        };\r\n        document.addEventListener('keydown', escapeHandler);\r\n        modal._escapeHandler = escapeHandler;\r\n        \r\n        return modal;\r\n    }\r\n\r\n    closeViewer() {\r\n        const modal = document.getElementById('provider-viewer-modal');\r\n        if (modal) {\r\n            modal.style.display = 'none';\r\n            document.body.style.overflow = ''; // Restore scrolling\r\n            \r\n            // Clear iframe to stop loading\r\n            const iframe = modal.querySelector('.provider-iframe');\r\n            if (iframe) {\r\n                iframe.src = 'about:blank';\r\n            }\r\n        }\r\n    }\r\n\r\n    toggleFullscreen() {\r\n        const modal = document.getElementById('provider-viewer-modal');\r\n        if (!modal) return;\r\n        \r\n        const container = modal.querySelector('.viewer-container');\r\n        if (!container) return;\r\n        \r\n        if (!document.fullscreenElement) {\r\n            container.requestFullscreen().catch(err => {\r\n                console.warn('Could not enter fullscreen:', err);\r\n            });\r\n        } else {\r\n            document.exitFullscreen();\r\n        }\r\n    }\r\n\r\n    cleanup() {\r\n        // Clear timeout\r\n        if (this.searchTimeout) {\r\n            clearTimeout(this.searchTimeout);\r\n            this.searchTimeout = null;\r\n        }\r\n        \r\n        // Remove event listeners (if elements still exist)\r\n        const searchInput = document.getElementById('provider-search');\r\n        const searchBtn = document.getElementById('search-btn');\r\n        const speedFilter = document.getElementById('speed-filter');\r\n        const typeFilter = document.getElementById('type-filter');\r\n        const clearFilters = document.getElementById('clear-filters');\r\n        const postcodeInput = document.getElementById('postcode-input');\r\n        const checkPostcodeBtn = document.getElementById('check-postcode-btn');\r\n        \r\n        if (searchInput && this.eventHandlers.debouncedSearch) {\r\n            searchInput.removeEventListener('input', this.eventHandlers.debouncedSearch);\r\n        }\r\n        if (searchBtn && this.eventHandlers.searchClick) {\r\n            searchBtn.removeEventListener('click', this.eventHandlers.searchClick);\r\n        }\r\n        if (searchInput && this.eventHandlers.searchKeypress) {\r\n            searchInput.removeEventListener('keypress', this.eventHandlers.searchKeypress);\r\n        }\r\n        if (speedFilter && this.eventHandlers.speedFilterChange) {\r\n            speedFilter.removeEventListener('change', this.eventHandlers.speedFilterChange);\r\n        }\r\n        if (typeFilter && this.eventHandlers.typeFilterChange) {\r\n            typeFilter.removeEventListener('change', this.eventHandlers.typeFilterChange);\r\n        }\r\n        if (clearFilters && this.eventHandlers.clearFiltersClick) {\r\n            clearFilters.removeEventListener('click', this.eventHandlers.clearFiltersClick);\r\n        }\r\n        if (checkPostcodeBtn && this.eventHandlers.checkPostcodeClick) {\r\n            checkPostcodeBtn.removeEventListener('click', this.eventHandlers.checkPostcodeClick);\r\n        }\r\n        if (postcodeInput && this.eventHandlers.postcodeKeypress) {\r\n            postcodeInput.removeEventListener('keypress', this.eventHandlers.postcodeKeypress);\r\n        }\r\n        \r\n        // Close modal if open\r\n        this.closeViewer();\r\n        \r\n        // Remove modal from DOM\r\n        const modal = document.getElementById('provider-viewer-modal');\r\n        if (modal) {\r\n            if (modal._escapeHandler) {\r\n                document.removeEventListener('keydown', modal._escapeHandler);\r\n            }\r\n            modal.remove();\r\n        }\r\n    }\r\n\r\n    updateStatistics() {\r\n        const totalEl = document.getElementById('total-providers');\r\n        const availableEl = document.getElementById('available-providers');\r\n        const fibreEl = document.getElementById('fibre-providers');\r\n        \r\n        if (totalEl) totalEl.textContent = this.providers.length;\r\n        if (availableEl) availableEl.textContent = this.filteredProviders.length;\r\n        \r\n        const fibreCount = this.filteredProviders.filter(p => p.hasFibre).length;\r\n        if (fibreEl) fibreEl.textContent = fibreCount;\r\n    }\r\n\r\n    hideLoading() {\r\n        const loading = document.getElementById('loading-message');\r\n        if (loading) {\r\n            loading.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    async checkPostcode() {\r\n        const postcodeInput = document.getElementById('postcode-input');\r\n        const resultsDiv = document.getElementById('postcode-results');\r\n        \r\n        if (!postcodeInput || !resultsDiv) {\r\n            console.warn('âš ï¸ Postcode input or results div not found');\r\n            return;\r\n        }\r\n        \r\n        const postcode = postcodeInput.value.trim().toUpperCase();\r\n        \r\n        if (!postcode) {\r\n            resultsDiv.innerHTML = '<p style=\"color: #ff6b6b;\">Please enter a valid UK postcode.</p>';\r\n            return;\r\n        }\r\n\r\n        // Basic UK postcode validation\r\n        const postcodeRegex = /^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$/i;\r\n        if (!postcodeRegex.test(postcode)) {\r\n            resultsDiv.innerHTML = '<p style=\"color: #ff6b6b;\">Invalid postcode format. Please use UK format (e.g., SW1A 1AA).</p>';\r\n            return;\r\n        }\r\n\r\n        resultsDiv.innerHTML = '<div class=\"spinner\"></div><p>Checking availability...</p>';\r\n\r\n        // Simulate checking availability (in real implementation, this would call provider APIs)\r\n        setTimeout(() => {\r\n            const availableProviders = this.filteredProviders.filter(_p => \r\n                Math.random() > 0.3 // Simulate 70% availability\r\n            ).slice(0, 10);\r\n\r\n            if (availableProviders.length === 0) {\r\n                resultsDiv.innerHTML = `\r\n                    <p style=\"color: #ff6b6b;\">No providers found for postcode ${postcode}.</p>\r\n                    <p style=\"color: rgba(255,255,255,0.7); margin-top: 1rem;\">\r\n                        Try checking with individual providers directly or contact them for availability in your area.\r\n                    </p>\r\n                `;\r\n            } else {\r\n                resultsDiv.innerHTML = `\r\n                    <h3 style=\"color: #ba944f; margin-bottom: 1rem;\">Available Providers for ${postcode}:</h3>\r\n                    <div style=\"display: grid; gap: 1rem; margin-top: 1rem;\">\r\n                        ${availableProviders.map(provider => `\r\n                            <div style=\"padding: 1rem; background: rgba(0,0,0,0.3); border: 1px solid rgba(186,148,79,0.3); border-radius: 8px;\">\r\n                                <strong style=\"color: #ba944f;\">${provider.name}</strong>\r\n                                ${provider.website ? `\r\n                                    <a href=\"${provider.website}\" target=\"_blank\" rel=\"noopener noreferrer\" \r\n                                       style=\"display: inline-block; margin-top: 0.5rem; color: #ba944f; text-decoration: underline;\">\r\n                                        Check deals â†’\r\n                                    </a>\r\n                                ` : ''}\r\n                            </div>\r\n                        `).join('')}\r\n                    </div>\r\n                    <p style=\"color: rgba(255,255,255,0.7); margin-top: 1.5rem; font-size: 0.9rem;\">\r\n                        ðŸ’¡ Tip: Contact providers directly for accurate pricing and availability in your area.\r\n                    </p>\r\n                `;\r\n            }\r\n        }, 1500);\r\n    }\r\n}\r\n\r\n// Initialize when DOM is ready\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    new BroadbandChecker();\r\n    console.log('ðŸŒ Broadband Checker initialized!');\r\n});\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\cosmic-effects.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\cosmic-music-player.js","messages":[{"ruleId":"max-statements","severity":1,"message":"Method 'cleanup' has too many statements (35). Maximum allowed is 30.","line":208,"column":12,"nodeType":"FunctionExpression","messageId":"exceed","endLine":263,"endColumn":6},{"ruleId":"max-statements","severity":1,"message":"Async method 'initPlayer' has too many statements (32). Maximum allowed is 30.","line":359,"column":21,"nodeType":"FunctionExpression","messageId":"exceed","endLine":491,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'_err' is defined but never used.","line":646,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":646,"endColumn":26}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Universal Cosmic Music Player - Available across all pages\r\n// Auto-initializes and persists across the website\r\n\r\nclass CosmicMusicPlayer {\r\n    constructor() {\r\n        console.log('ðŸŽµ CosmicMusicPlayer: Constructor called');\r\n        \r\n        // Stream directly from GitLab-hosted files (no backend needed!)\r\n        // When deployed to GitLab Pages, files are served from your repository\r\n        const BASE_URL = window.location.origin;\r\n        const BASE_PATH = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));\r\n        \r\n        // Log environment info for debugging\r\n        console.log('ðŸŽµ Music Player Environment:', {\r\n            origin: BASE_URL,\r\n            pathname: window.location.pathname,\r\n            basePath: BASE_PATH,\r\n            protocol: window.location.protocol,\r\n            host: window.location.host\r\n        });\r\n        \r\n        // Try multiple URL formats for GitLab Pages compatibility\r\n        const getTrackURL = (filename) => {\r\n            // Primary: root-relative path (works for GitLab Pages)\r\n            const primary = `${BASE_URL}/audio/${filename}`;\r\n            // Fallback: relative to current page\r\n            const fallback = `${BASE_URL}${BASE_PATH}/audio/${filename}`;\r\n            \r\n            return {\r\n                primary: primary,\r\n                fallback: fallback,\r\n                filename: filename\r\n            };\r\n        };\r\n        \r\n        this.tracks = [\r\n            { \r\n                name: 'Track 1: Cosmic Journey',\r\n                url: getTrackURL('cosmic-journey.mp3').primary,\r\n                fallbackUrl: getTrackURL('cosmic-journey.mp3').fallback,\r\n                filename: 'cosmic-journey.mp3'\r\n            },\r\n            { \r\n                name: 'Track 2: Stellar Voyage',\r\n                url: getTrackURL('stellar-voyage.mp3').primary,\r\n                fallbackUrl: getTrackURL('stellar-voyage.mp3').fallback,\r\n                filename: 'stellar-voyage.mp3'\r\n            },\r\n            { \r\n                name: 'Track 3: Galactic Odyssey',\r\n                url: getTrackURL('galactic-odyssey.mp3').primary,\r\n                fallbackUrl: getTrackURL('galactic-odyssey.mp3').fallback,\r\n                filename: 'galactic-odyssey.mp3'\r\n            },\r\n            { \r\n                name: 'Track 4: Celestial Harmony',\r\n                url: getTrackURL('track-4.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-4.mp3').fallback,\r\n                filename: 'track-4.mp3'\r\n            },\r\n            { \r\n                name: 'Track 5: Stellar Dreams',\r\n                url: getTrackURL('track-5.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-5.mp3').fallback,\r\n                filename: 'track-5.mp3'\r\n            },\r\n            { \r\n                name: 'Track 6: Cosmic Resonance',\r\n                url: getTrackURL('track-6.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-6.mp3').fallback,\r\n                filename: 'track-6.mp3'\r\n            },\r\n            { \r\n                name: 'Track 7: Nebula Waves',\r\n                url: getTrackURL('track-7.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-7.mp3').fallback,\r\n                filename: 'track-7.mp3'\r\n            },\r\n            { \r\n                name: 'Track 8: Interstellar Echo',\r\n                url: getTrackURL('track-8.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-8.mp3').fallback,\r\n                filename: 'track-8.mp3'\r\n            },\r\n            { \r\n                name: 'Track 9: Galactic Pulse',\r\n                url: getTrackURL('track-9.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-9.mp3').fallback,\r\n                filename: 'track-9.mp3'\r\n            },\r\n            { \r\n                name: 'Track 10: Cosmic Drift',\r\n                url: getTrackURL('track-10.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-10.mp3').fallback,\r\n                filename: 'track-10.mp3'\r\n            },\r\n            { \r\n                name: 'Track 11: Stellar Winds',\r\n                url: getTrackURL('track-11.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-11.mp3').fallback,\r\n                filename: 'track-11.mp3'\r\n            },\r\n            { \r\n                name: 'Track 12: Nebula Dreams',\r\n                url: getTrackURL('track-12.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-12.mp3').fallback,\r\n                filename: 'track-12.mp3'\r\n            },\r\n            { \r\n                name: 'Track 13: Galactic Currents',\r\n                url: getTrackURL('track-13.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-13.mp3').fallback,\r\n                filename: 'track-13.mp3'\r\n            },\r\n            { \r\n                name: 'Track 14: Cosmic Tides',\r\n                url: getTrackURL('track-14.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-14.mp3').fallback,\r\n                filename: 'track-14.mp3'\r\n            },\r\n            { \r\n                name: 'Track 15: Stellar Flow',\r\n                url: getTrackURL('track-15.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-15.mp3').fallback,\r\n                filename: 'track-15.mp3'\r\n            },\r\n            { \r\n                name: 'Track 16: Nebula Stream',\r\n                url: getTrackURL('track-16.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-16.mp3').fallback,\r\n                filename: 'track-16.mp3'\r\n            },\r\n            { \r\n                name: 'Track 17: Galactic Waves',\r\n                url: getTrackURL('track-17.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-17.mp3').fallback,\r\n                filename: 'track-17.mp3'\r\n            },\r\n            { \r\n                name: 'Track 18: Cosmic Horizon',\r\n                url: getTrackURL('track-18.mp3').primary,\r\n                fallbackUrl: getTrackURL('track-18.mp3').fallback,\r\n                filename: 'track-18.mp3'\r\n            }\r\n        ];\r\n        \r\n        // Log all track URLs for debugging\r\n        console.log('ðŸŽµ Total tracks:', this.tracks.length);\r\n        console.log('ðŸŽµ Track URLs:', this.tracks.map(t => ({\r\n            name: t.name,\r\n            filename: t.filename,\r\n            primary: t.url,\r\n            fallback: t.fallbackUrl\r\n        })));\r\n        this.currentTrackIndex = 0;\r\n        this.audio = new Audio();\r\n        this.isPlaying = false;\r\n        this.isMinimized = false;\r\n        \r\n        console.log('ðŸŽµ Loading saved state...');\r\n        // Load saved state from localStorage\r\n        this.loadPlayerState();\r\n        \r\n        console.log('ðŸŽµ Injecting player HTML...');\r\n        this.injectPlayerHTML();\r\n        \r\n        // Update track display immediately after HTML injection\r\n        setTimeout(() => {\r\n            this.updateTrackDisplay();\r\n            console.log(`âœ… Initial track display: ${this.tracks.length} tracks available`);\r\n        }, 100);\r\n        \r\n        console.log('ðŸŽµ Initializing audio player...');\r\n        this.initPlayer();\r\n        \r\n        console.log('ðŸŽµ Setting up event listeners...');\r\n        this.setupEventListeners();\r\n        \r\n        // Setup page navigation persistence\r\n        this.setupNavigationPersistence();\r\n        \r\n        console.log('ðŸŽµ CosmicMusicPlayer: Constructor complete!');\r\n    }\r\n    \r\n    setupNavigationPersistence() {\r\n        // Save state when navigating away\r\n        window.addEventListener('beforeunload', () => {\r\n            this.saveStateBeforeUnload();\r\n        });\r\n        \r\n        // Save state when page becomes hidden\r\n        document.addEventListener('visibilitychange', () => {\r\n            if (document.hidden) {\r\n                this.saveStateBeforeUnload();\r\n            }\r\n        });\r\n        \r\n        // Save state periodically while playing\r\n        this.saveStateInterval = setInterval(() => {\r\n            if (this.isPlaying && this.audio && !this.audio.paused) {\r\n                this.savePlayerState();\r\n            }\r\n        }, 5000); // Save every 5 seconds while playing\r\n        \r\n        console.log('âœ… Navigation persistence enabled');\r\n    }\r\n    \r\n    cleanup() {\r\n        // Clear intervals\r\n        if (this.saveStateInterval) {\r\n            clearInterval(this.saveStateInterval);\r\n            this.saveStateInterval = null;\r\n        }\r\n        \r\n        // Remove event listeners from buttons\r\n        if (this.eventHandlers) {\r\n            const playPauseBtn = document.getElementById('play-pause');\r\n            const prevBtn = document.getElementById('prev-track');\r\n            const nextBtn = document.getElementById('next-track');\r\n            const volumeControl = document.getElementById('volume-control');\r\n            const progressBar = document.getElementById('progress-bar');\r\n            const minimizeBtn = document.getElementById('minimize-player');\r\n            const loopToggle = document.getElementById('loop-toggle');\r\n            const downloadBtn = document.getElementById('download-track');\r\n            \r\n            if (playPauseBtn) playPauseBtn.removeEventListener('click', this.eventHandlers.playPause);\r\n            if (prevBtn) prevBtn.removeEventListener('click', this.eventHandlers.prevTrack);\r\n            if (nextBtn) nextBtn.removeEventListener('click', this.eventHandlers.nextTrack);\r\n            if (volumeControl) volumeControl.removeEventListener('input', this.eventHandlers.volumeChange);\r\n            if (progressBar) progressBar.removeEventListener('click', this.eventHandlers.progressClick);\r\n            if (minimizeBtn) minimizeBtn.removeEventListener('click', this.eventHandlers.minimize);\r\n            if (loopToggle) loopToggle.removeEventListener('change', this.eventHandlers.loopToggle);\r\n            if (downloadBtn) downloadBtn.removeEventListener('click', this.eventHandlers.download);\r\n        }\r\n        \r\n        // Remove audio event listeners (store references for proper cleanup)\r\n        if (this.audio) {\r\n            // Store references if not already stored\r\n            if (!this.audioEventHandlers) {\r\n                this.audioEventHandlers = {\r\n                    timeupdate: () => this.updateProgress(),\r\n                    ended: () => this.handleTrackEnd(),\r\n                    loadedmetadata: () => this.updateDuration()\r\n                };\r\n            }\r\n            \r\n            this.audio.removeEventListener('timeupdate', this.audioEventHandlers.timeupdate);\r\n            this.audio.removeEventListener('ended', this.audioEventHandlers.ended);\r\n            this.audio.removeEventListener('loadedmetadata', this.audioEventHandlers.loadedmetadata);\r\n            this.audio.removeEventListener('loadstart', this.audioEventHandlers.loadstart);\r\n            this.audio.removeEventListener('canplay', this.audioEventHandlers.canplay);\r\n            this.audio.removeEventListener('canplaythrough', this.audioEventHandlers.canplaythrough);\r\n            this.audio.removeEventListener('stalled', this.audioEventHandlers.stalled);\r\n            this.audio.removeEventListener('waiting', this.audioEventHandlers.waiting);\r\n        }\r\n        \r\n        // Clear audio\r\n        if (this.audio) {\r\n            this.audio.pause();\r\n            this.audio.src = '';\r\n            this.audio = null;\r\n        }\r\n    }\r\n    \r\n    injectPlayerHTML() {\r\n        // Check if player already exists\r\n        if (document.getElementById('cosmic-music-player')) {\r\n            console.log('â„¹ï¸ Player HTML already exists, skipping injection');\r\n            return;\r\n        }\r\n        \r\n        console.log('ðŸŽµ Injecting player HTML into body...');\r\n        const playerHTML = `\r\n            <div id=\"cosmic-music-player\" style=\"position: fixed; bottom: 20px; right: 20px; z-index: 9999; background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(20, 20, 30, 0.98)); border: 2px solid rgba(186, 148, 79, 0.5); border-radius: 15px; padding: 1rem; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8), 0 0 30px rgba(186, 148, 79, 0.2); backdrop-filter: blur(10px); width: 320px; transition: all 0.3s ease;\">\r\n                <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;\">\r\n                    <div style=\"display: flex; align-items: center; gap: 0.5rem;\">\r\n                        <span style=\"font-size: 1.5rem; animation: pulse-glow 2s infinite;\">ðŸŽµ</span>\r\n                        <h4 style=\"margin: 0; color: #ba944f; font-size: 0.9rem; font-family: 'Raleway', sans-serif; font-weight: 600;\">Cosmic Playlist</h4>\r\n                    </div>\r\n                    <button id=\"minimize-player\" style=\"background: none; border: none; color: #ba944f; cursor: pointer; font-size: 1.2rem; padding: 0.25rem; transition: transform 0.2s;\">âˆ’</button>\r\n                </div>\r\n                \r\n                <div id=\"player-content\">\r\n                    <div id=\"current-track\" style=\"color: rgba(255, 255, 255, 0.9); font-size: 0.85rem; margin-bottom: 0.5rem; font-weight: 500; text-align: center;\">Track 1: Cosmic Journey</div>\r\n                    <div id=\"track-info\" style=\"color: rgba(255, 255, 255, 0.5); font-size: 0.7rem; margin-bottom: 0.75rem; text-align: center;\">Track 1 of 18</div>\r\n                    \r\n                    <div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem;\">\r\n                        <span id=\"current-time\" style=\"font-size: 0.75rem; color: rgba(255, 255, 255, 0.6); font-family: monospace;\">0:00</span>\r\n                        <div id=\"progress-bar\" style=\"flex: 1; height: 6px; background: rgba(255, 255, 255, 0.2); border-radius: 3px; cursor: pointer; position: relative; overflow: hidden;\">\r\n                            <div id=\"progress-fill\" style=\"height: 100%; width: 0%; background: linear-gradient(90deg, #ba944f, #ffd700); border-radius: 3px; transition: width 0.1s linear; box-shadow: 0 0 10px rgba(186, 148, 79, 0.5);\"></div>\r\n                        </div>\r\n                        <span id=\"duration\" style=\"font-size: 0.75rem; color: rgba(255, 255, 255, 0.6); font-family: monospace;\">0:00</span>\r\n                    </div>\r\n                    \r\n                    <div style=\"display: flex; justify-content: center; align-items: center; gap: 1rem; margin-bottom: 0.75rem;\">\r\n                        <button id=\"prev-track\" style=\"background: rgba(186, 148, 79, 0.2); border: 2px solid rgba(186, 148, 79, 0.5); border-radius: 50%; width: 35px; height: 35px; cursor: pointer; color: #ba944f; font-size: 1rem; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;\">â®</button>\r\n                        <button id=\"play-pause\" style=\"background: rgba(186, 148, 79, 0.3); border: 2px solid #ba944f; border-radius: 50%; width: 45px; height: 45px; cursor: pointer; color: #ba944f; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; box-shadow: 0 0 15px rgba(186, 148, 79, 0.3);\">â–¶</button>\r\n                        <button id=\"next-track\" style=\"background: rgba(186, 148, 79, 0.2); border: 2px solid rgba(186, 148, 79, 0.5); border-radius: 50%; width: 35px; height: 35px; cursor: pointer; color: #ba944f; font-size: 1rem; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;\">â­</button>\r\n                    </div>\r\n                    \r\n                    <div style=\"display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;\">\r\n                        <span style=\"font-size: 1rem;\">ðŸ”Š</span>\r\n                        <input type=\"range\" id=\"volume-control\" min=\"0\" max=\"100\" value=\"70\" style=\"flex: 1; accent-color: #ba944f; cursor: pointer;\">\r\n                        <span id=\"volume-display\" style=\"font-size: 0.75rem; color: rgba(255, 255, 255, 0.6); min-width: 35px; font-family: monospace;\">70%</span>\r\n                    </div>\r\n                    \r\n                    <div style=\"margin-top: 0.75rem; font-size: 0.75rem; color: rgba(255, 255, 255, 0.5); text-align: center;\">\r\n                        <label style=\"display: flex; align-items: center; justify-content: center; gap: 0.5rem; cursor: pointer; margin-bottom: 0.5rem;\">\r\n                            <input type=\"checkbox\" id=\"loop-toggle\" style=\"accent-color: #ba944f; cursor: pointer;\">\r\n                            <span>Loop Playlist</span>\r\n                        </label>\r\n                        <button id=\"download-track\" style=\"background: rgba(186, 148, 79, 0.2); border: 1px solid rgba(186, 148, 79, 0.5); border-radius: 8px; padding: 0.4rem 0.8rem; color: #ba944f; cursor: pointer; font-size: 0.75rem; transition: all 0.3s ease; display: flex; align-items: center; gap: 0.4rem; margin: 0 auto;\">\r\n                            <span>â¬‡ï¸</span>\r\n                            <span>Download Track</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            \r\n            <style>\r\n                @keyframes pulse-glow {\r\n                    0%, 100% { transform: scale(1); filter: brightness(1); }\r\n                    50% { transform: scale(1.1); filter: brightness(1.3); }\r\n                }\r\n                \r\n                #cosmic-music-player button:hover {\r\n                    transform: scale(1.1) !important;\r\n                    box-shadow: 0 5px 15px rgba(186, 148, 79, 0.4) !important;\r\n                }\r\n                \r\n                #cosmic-music-player button:active {\r\n                    transform: scale(0.95) !important;\r\n                }\r\n                \r\n                #progress-bar:hover #progress-fill {\r\n                    box-shadow: 0 0 15px rgba(186, 148, 79, 0.8);\r\n                }\r\n                \r\n                @media (max-width: 768px) {\r\n                    #cosmic-music-player {\r\n                        width: 280px !important;\r\n                        bottom: 10px !important;\r\n                        right: 10px !important;\r\n                        padding: 0.75rem !important;\r\n                    }\r\n                }\r\n            </style>\r\n        `;\r\n        \r\n        try {\r\n            document.body.insertAdjacentHTML('beforeend', playerHTML);\r\n            console.log('âœ… Player HTML injected successfully!');\r\n            console.log('âœ… Player element exists:', !!document.getElementById('cosmic-music-player'));\r\n        } catch (err) {\r\n            console.error('âŒ Error injecting player HTML:', err);\r\n        }\r\n    }\r\n    \r\n    async initPlayer() {\r\n        const currentTrack = this.tracks[this.currentTrackIndex];\r\n        console.log('ðŸŽµ Initializing player for:', currentTrack.name);\r\n        console.log('ðŸŽµ Base URL:', window.location.origin);\r\n        console.log('ðŸŽµ Full URL:', currentTrack.url);\r\n        \r\n        // Test URL accessibility first\r\n        await this.testTrackURL(currentTrack.url, currentTrack.name);\r\n        \r\n        this.audio.src = currentTrack.url;\r\n        this.audio.volume = 0.7;\r\n        this.audio.preload = 'metadata';\r\n        \r\n        // Restore saved volume\r\n        const savedVolume = localStorage.getItem('cosmicPlayerVolume');\r\n        if (savedVolume) {\r\n            this.audio.volume = savedVolume / 100;\r\n            const volumeControl = document.getElementById('volume-control');\r\n            const volumeDisplay = document.getElementById('volume-display');\r\n            if (volumeControl) volumeControl.value = savedVolume;\r\n            if (volumeDisplay) volumeDisplay.textContent = savedVolume + '%';\r\n        }\r\n        \r\n        // Restore loop setting\r\n        const savedLoop = localStorage.getItem('cosmicPlayerLoop');\r\n        if (savedLoop === 'true') {\r\n            document.getElementById('loop-toggle').checked = true;\r\n        }\r\n        \r\n        // Store event handler references for proper cleanup\r\n        if (!this.audioEventHandlers) {\r\n            this.audioEventHandlers = {\r\n                timeupdate: () => this.updateProgress(),\r\n                ended: () => this.handleTrackEnd(),\r\n                loadedmetadata: () => {\r\n                    this.updateDuration();\r\n                    console.log('âœ… Track metadata loaded:', {\r\n                        name: currentTrack.name,\r\n                        duration: this.formatTime(this.audio.duration),\r\n                        size: this.audio.buffered.length > 0 ? 'Buffered' : 'Not buffered'\r\n                    });\r\n                },\r\n                loadstart: () => {\r\n                    console.log('ðŸ”„ Load start:', currentTrack.name);\r\n                    const currentTrackEl = document.getElementById('current-track');\r\n                    if (currentTrackEl) {\r\n                        currentTrackEl.innerHTML = currentTrack.name + ' <span style=\"color: #ba944f;\">â³</span>';\r\n                    }\r\n                },\r\n                canplay: () => {\r\n                    this.updateTrackDisplay();\r\n                    console.log('âœ… Track ready to play:', currentTrack.name, `(${this.currentTrackIndex + 1}/${this.tracks.length})`);\r\n                    \r\n                    // Restore playback position and state if available\r\n                    if (this.pendingState) {\r\n                        const { currentTime, isPlaying } = this.pendingState;\r\n                        \r\n                        // Restore playback position\r\n                        if (currentTime > 0 && currentTime < this.audio.duration) {\r\n                            this.audio.currentTime = currentTime;\r\n                            console.log(`â© Restored playback position: ${this.formatTime(currentTime)}`);\r\n                        }\r\n                        \r\n                        // Auto-resume if it was playing\r\n                        if (isPlaying) {\r\n                            console.log('â–¶ï¸ Auto-resuming playback...');\r\n                            setTimeout(() => {\r\n                                this.play().catch(err => {\r\n                                    console.warn('âš ï¸ Auto-resume prevented:', err);\r\n                                    // User interaction required - show play button\r\n                                    this.isPlaying = false;\r\n                                    const playPauseBtn = document.getElementById('play-pause');\r\n                                    if (playPauseBtn) {\r\n                                        playPauseBtn.innerHTML = 'â–¶';\r\n                                    }\r\n                                });\r\n                            }, 100);\r\n                        }\r\n                        \r\n                        // Clear pending state\r\n                        this.pendingState = null;\r\n                    }\r\n                },\r\n                canplaythrough: () => {\r\n                    console.log('âœ… Track fully buffered and ready:', currentTrack.name);\r\n                },\r\n                stalled: () => {\r\n                    console.warn('âš ï¸ Playback stalled:', currentTrack.name);\r\n                    const currentTrackEl = document.getElementById('current-track');\r\n                    if (currentTrackEl) {\r\n                        currentTrackEl.innerHTML = currentTrack.name + ' <span style=\"color: #ffa500;\">â¸ Buffering...</span>';\r\n                    }\r\n                },\r\n                waiting: () => {\r\n                    console.warn('â³ Waiting for data:', currentTrack.name);\r\n                }\r\n            };\r\n        }\r\n        \r\n        // Add event listeners using stored references\r\n        this.audio.addEventListener('timeupdate', this.audioEventHandlers.timeupdate);\r\n        this.audio.addEventListener('ended', this.audioEventHandlers.ended);\r\n        this.audio.addEventListener('loadedmetadata', this.audioEventHandlers.loadedmetadata);\r\n        this.audio.addEventListener('loadstart', this.audioEventHandlers.loadstart);\r\n        this.audio.addEventListener('canplay', this.audioEventHandlers.canplay);\r\n        this.audio.addEventListener('canplaythrough', this.audioEventHandlers.canplaythrough);\r\n        this.audio.addEventListener('stalled', this.audioEventHandlers.stalled);\r\n        this.audio.addEventListener('waiting', this.audioEventHandlers.waiting);\r\n        \r\n        this.audio.addEventListener('progress', () => {\r\n            if (this.audio.buffered.length > 0) {\r\n                const bufferedEnd = this.audio.buffered.end(this.audio.buffered.length - 1);\r\n                const duration = this.audio.duration;\r\n                const percent = duration ? (bufferedEnd / duration * 100).toFixed(1) : 0;\r\n                console.log(`ðŸ“Š Buffered: ${percent}%`);\r\n            }\r\n        });\r\n        \r\n        // Advanced error handling\r\n        this.audio.addEventListener('error', (e) => {\r\n            this.handleAudioError(e, currentTrack);\r\n        });\r\n        \r\n        // Save state periodically (every 2 seconds to avoid too frequent writes)\r\n        let lastSaveTime = 0;\r\n        this.audio.addEventListener('timeupdate', () => {\r\n            const now = Date.now();\r\n            if (now - lastSaveTime > 2000) { // Save every 2 seconds\r\n                this.savePlayerState();\r\n                lastSaveTime = now;\r\n            }\r\n        });\r\n    }\r\n    \r\n    async testTrackURL(url, trackName) {\r\n        console.log('ðŸ” Testing URL accessibility:', url);\r\n        \r\n        try {\r\n            await fetch(url, {\r\n                method: 'HEAD',\r\n                mode: 'no-cors' // Try no-cors first\r\n            });\r\n            \r\n            console.log('âœ… HEAD request completed');\r\n        } catch (headError) {\r\n            console.warn('âš ï¸ HEAD request failed, trying GET:', headError);\r\n            \r\n            try {\r\n                const getResponse = await fetch(url, {\r\n                    method: 'GET',\r\n                    headers: {\r\n                        'Range': 'bytes=0-1023' // Request first 1KB\r\n                    }\r\n                });\r\n                \r\n                console.log('ðŸ“¡ GET Response:', {\r\n                    status: getResponse.status,\r\n                    statusText: getResponse.statusText,\r\n                    headers: Object.fromEntries(getResponse.headers.entries()),\r\n                    ok: getResponse.ok\r\n                });\r\n                \r\n                if (!getResponse.ok) {\r\n                    throw new Error(`HTTP ${getResponse.status}: ${getResponse.statusText}`);\r\n                }\r\n            } catch (getError) {\r\n                console.error('âŒ GET request failed:', getError);\r\n                this.logDetailedError(url, trackName, getError);\r\n            }\r\n        }\r\n    }\r\n    \r\n    handleAudioError(event, track) {\r\n        const error = this.audio.error;\r\n        const errorCode = error ? error.code : 'unknown';\r\n        const errorMessage = error ? error.message : 'Unknown error';\r\n        \r\n        const errorDetails = {\r\n            1: {\r\n                code: 'MEDIA_ERR_ABORTED',\r\n                description: 'Download aborted by user or network',\r\n                solutions: [\r\n                    'Check your internet connection',\r\n                    'Try clicking play again',\r\n                    'Check if file is accessible'\r\n                ]\r\n            },\r\n            2: {\r\n                code: 'MEDIA_ERR_NETWORK',\r\n                description: 'Network error while downloading',\r\n                solutions: [\r\n                    'Check your internet connection',\r\n                    'Verify the file URL is correct',\r\n                    'Check if GitLab Pages is accessible',\r\n                    'Try refreshing the page'\r\n                ]\r\n            },\r\n            3: {\r\n                code: 'MEDIA_ERR_DECODE',\r\n                description: 'File is corrupt or format not supported',\r\n                solutions: [\r\n                    'File may be corrupted',\r\n                    'Browser may not support MP3 format',\r\n                    'Try a different browser',\r\n                    'Check file integrity'\r\n                ]\r\n            },\r\n            4: {\r\n                code: 'MEDIA_ERR_SRC_NOT_SUPPORTED',\r\n                description: 'File format not supported or source not found',\r\n                solutions: [\r\n                    'File may not exist at the URL',\r\n                    'Check if path is correct: /audio/filename.mp3',\r\n                    'Verify file is in GitLab repository',\r\n                    'Check GitLab Pages deployment'\r\n                ]\r\n            }\r\n        };\r\n        \r\n        const errorInfo = errorDetails[errorCode] || {\r\n            code: 'UNKNOWN_ERROR',\r\n            description: 'Unknown error occurred',\r\n            solutions: ['Check browser console for details', 'Try refreshing the page']\r\n        };\r\n        \r\n        // Comprehensive error logging\r\n        console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');\r\n        console.error('âŒ AUDIO PLAYER ERROR');\r\n        console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');\r\n        console.error('Track:', track.name);\r\n        console.error('Error Code:', errorCode, `(${errorInfo.code})`);\r\n        console.error('Error Message:', errorMessage);\r\n        console.error('Error Description:', errorInfo.description);\r\n        console.error('Current URL:', this.audio.src);\r\n        console.error('Base URL:', window.location.origin);\r\n        console.error('Full Path:', new URL(this.audio.src).pathname);\r\n        console.error('Audio Element State:', {\r\n            readyState: this.audio.readyState,\r\n            networkState: this.audio.networkState,\r\n            paused: this.audio.paused,\r\n            ended: this.audio.ended\r\n        });\r\n        console.error('Possible Solutions:');\r\n        errorInfo.solutions.forEach((solution, i) => {\r\n            console.error(`  ${i + 1}. ${solution}`);\r\n        });\r\n        console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');\r\n        \r\n        // Test alternative URLs\r\n        this.testAlternativeURLs(track);\r\n        \r\n        // Show user-friendly error\r\n        const errorDisplay = `\r\n            <div style=\"color: #ff4444; text-align: center;\">\r\n                <div style=\"font-weight: 600; margin-bottom: 0.25rem;\">âš ï¸ Error Loading Track</div>\r\n                <div style=\"font-size: 0.75rem; color: rgba(255, 255, 255, 0.6);\">\r\n                    ${errorInfo.code}: ${errorInfo.description}\r\n                </div>\r\n                <div style=\"font-size: 0.7rem; color: rgba(255, 255, 255, 0.5); margin-top: 0.5rem;\">\r\n                    Check console (F12) for details\r\n                </div>\r\n            </div>\r\n        `;\r\n        document.getElementById('current-track').innerHTML = errorDisplay;\r\n    }\r\n    \r\n    async testAlternativeURLs(track) {\r\n        console.log('ðŸ” Testing alternative URL paths...');\r\n        \r\n        const baseURL = window.location.origin;\r\n        const basePath = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));\r\n        \r\n        const alternativePaths = [\r\n            `${baseURL}/audio/${track.name.toLowerCase().replace(/[^a-z0-9]/g, '-')}.mp3`,\r\n            `${baseURL}${basePath}/audio/${track.name.toLowerCase().replace(/[^a-z0-9]/g, '-')}.mp3`,\r\n            `${baseURL}/audio/cosmic-journey.mp3`, // Direct filename test\r\n            `${baseURL}/audio/stellar-voyage.mp3`,\r\n            `${baseURL}/audio/galactic-odyssey.mp3`\r\n        ];\r\n        \r\n        for (const altUrl of alternativePaths) {\r\n            try {\r\n                const response = await fetch(altUrl, { method: 'HEAD' });\r\n                if (response.ok) {\r\n                    console.log(`âœ… Alternative URL works: ${altUrl}`);\r\n                    // Could auto-switch here if needed\r\n                }\r\n            } catch (_err) {\r\n                console.log(`âŒ Alternative URL failed: ${altUrl}`);\r\n            }\r\n        }\r\n    }\r\n    \r\n    logDetailedError(url, trackName, error) {\r\n        console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');\r\n        console.error('âŒ DETAILED URL TEST ERROR');\r\n        console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');\r\n        console.error('Track:', trackName);\r\n        console.error('URL:', url);\r\n        console.error('Error Type:', error.constructor.name);\r\n        console.error('Error Message:', error.message);\r\n        console.error('Error Stack:', error.stack);\r\n        console.error('Current Location:', {\r\n            origin: window.location.origin,\r\n            pathname: window.location.pathname,\r\n            href: window.location.href\r\n        });\r\n        console.error('Expected File Paths:');\r\n        console.error('  - /audio/cosmic-journey.mp3');\r\n        console.error('  - /audio/stellar-voyage.mp3');\r\n        console.error('  - /audio/galactic-odyssey.mp3');\r\n        console.error('GitLab Pages URL Format:');\r\n        console.error('  - https://username.gitlab.io/project-name/audio/filename.mp3');\r\n        console.error('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');\r\n    }\r\n    \r\n    setupEventListeners() {\r\n        // Store event handlers for cleanup (if not already stored)\r\n        if (!this.eventHandlers) {\r\n            this.eventHandlers = {\r\n                playPause: () => this.togglePlay(),\r\n                prevTrack: () => this.previousTrack(),\r\n                nextTrack: () => this.nextTrack(),\r\n                volumeChange: (e) => this.setVolume(e.target.value),\r\n                progressClick: (e) => this.seek(e),\r\n                minimize: () => this.toggleMinimize(),\r\n                loopToggle: (e) => {\r\n                    this.loop = e.target.checked;\r\n                    localStorage.setItem('cosmicPlayerLoop', this.loop);\r\n                },\r\n                download: () => this.downloadTrack()\r\n            };\r\n        }\r\n        \r\n        const playPauseBtn = document.getElementById('play-pause');\r\n        const prevBtn = document.getElementById('prev-track');\r\n        const nextBtn = document.getElementById('next-track');\r\n        const volumeControl = document.getElementById('volume-control');\r\n        const progressBar = document.getElementById('progress-bar');\r\n        const minimizeBtn = document.getElementById('minimize-player');\r\n        const loopToggle = document.getElementById('loop-toggle');\r\n        const downloadBtn = document.getElementById('download-track');\r\n        \r\n        // Add event listeners with null checks\r\n        if (playPauseBtn) playPauseBtn.addEventListener('click', this.eventHandlers.playPause);\r\n        if (prevBtn) prevBtn.addEventListener('click', this.eventHandlers.prevTrack);\r\n        if (nextBtn) nextBtn.addEventListener('click', this.eventHandlers.nextTrack);\r\n        if (volumeControl) volumeControl.addEventListener('input', this.eventHandlers.volumeChange);\r\n        if (progressBar) progressBar.addEventListener('click', this.eventHandlers.progressClick);\r\n        if (minimizeBtn) minimizeBtn.addEventListener('click', this.eventHandlers.minimize);\r\n        if (loopToggle) loopToggle.addEventListener('change', this.eventHandlers.loopToggle);\r\n        if (downloadBtn) downloadBtn.addEventListener('click', this.eventHandlers.download);\r\n    }\r\n    \r\n    play() {\r\n        const playPromise = this.audio.play();\r\n        \r\n        if (playPromise !== undefined) {\r\n            playPromise.then(() => {\r\n                // Playback started successfully\r\n                this.isPlaying = true;\r\n                document.getElementById('play-pause').innerHTML = 'â¸';\r\n                this.savePlayerState();\r\n                console.log('ðŸŽµ Playing:', this.tracks[this.currentTrackIndex].name);\r\n            }).catch(err => {\r\n                console.warn('âš ï¸ Playback prevented:', err.name, err.message);\r\n                this.isPlaying = false;\r\n                document.getElementById('play-pause').innerHTML = 'â–¶';\r\n                \r\n                // Show user-friendly message\r\n                if (err.name === 'NotAllowedError') {\r\n                    document.getElementById('current-track').innerHTML = '<span style=\"color: #ffa500;\">Click â–¶ to start music</span>';\r\n                } else {\r\n                    document.getElementById('current-track').innerHTML = '<span style=\"color: #ff4444;\">Error loading track</span>';\r\n                }\r\n            });\r\n        }\r\n    }\r\n    \r\n    pause() {\r\n        this.audio.pause();\r\n        this.isPlaying = false;\r\n        document.getElementById('play-pause').innerHTML = 'â–¶';\r\n        this.savePlayerState();\r\n    }\r\n    \r\n    togglePlay() {\r\n        if (this.isPlaying) {\r\n            this.pause();\r\n        } else {\r\n            this.play();\r\n        }\r\n    }\r\n    \r\n    updateTrackDisplay() {\r\n        const track = this.tracks[this.currentTrackIndex];\r\n        const trackInfo = document.getElementById('track-info');\r\n        if (trackInfo && this.tracks.length > 0) {\r\n            trackInfo.textContent = `Track ${this.currentTrackIndex + 1} of ${this.tracks.length}`;\r\n            console.log(`ðŸ“Š Track display updated: Track ${this.currentTrackIndex + 1} of ${this.tracks.length}`);\r\n        }\r\n        const currentTrackEl = document.getElementById('current-track');\r\n        if (currentTrackEl && track && !currentTrackEl.innerHTML.includes('â³') && !currentTrackEl.innerHTML.includes('Buffering')) {\r\n            currentTrackEl.textContent = track.name;\r\n        }\r\n    }\r\n    \r\n    previousTrack() {\r\n        this.currentTrackIndex = (this.currentTrackIndex - 1 + this.tracks.length) % this.tracks.length;\r\n        this.loadTrack();\r\n    }\r\n    \r\n    nextTrack() {\r\n        this.currentTrackIndex = (this.currentTrackIndex + 1) % this.tracks.length;\r\n        this.loadTrack();\r\n    }\r\n    \r\n    async loadTrack() {\r\n        const track = this.tracks[this.currentTrackIndex];\r\n        const wasPlaying = this.isPlaying;\r\n        \r\n        // Update track display\r\n        this.updateTrackDisplay();\r\n        \r\n        console.log('ðŸ”„ Loading track:', track.name, `(${this.currentTrackIndex + 1}/${this.tracks.length})`);\r\n        console.log('ðŸ”„ Primary URL:', track.url);\r\n        console.log('ðŸ”„ Fallback URL:', track.fallbackUrl);\r\n        \r\n        // Clear pending state when manually switching tracks\r\n        this.pendingState = null;\r\n        \r\n        // Try primary URL first\r\n        try {\r\n            this.audio.src = track.url;\r\n            document.getElementById('current-track').textContent = track.name;\r\n            \r\n            // Test if URL is accessible\r\n            await this.testTrackURL(track.url, track.name);\r\n        } catch (error) {\r\n            console.warn('âš ï¸ Primary URL failed, trying fallback:', error);\r\n            \r\n            // Try fallback URL\r\n            if (track.fallbackUrl) {\r\n                this.audio.src = track.fallbackUrl;\r\n                console.log('ðŸ”„ Using fallback URL:', track.fallbackUrl);\r\n            }\r\n        }\r\n        \r\n        if (wasPlaying) {\r\n            // Wait a bit for source to load\r\n            setTimeout(() => {\r\n                this.play();\r\n            }, 100);\r\n        }\r\n        \r\n        this.savePlayerState();\r\n    }\r\n    \r\n    handleTrackEnd() {\r\n        const loopEnabled = document.getElementById('loop-toggle').checked;\r\n        \r\n        if (loopEnabled || this.currentTrackIndex < this.tracks.length - 1) {\r\n            this.nextTrack();\r\n        } else {\r\n            this.pause();\r\n        }\r\n    }\r\n    \r\n    setVolume(value) {\r\n        this.audio.volume = value / 100;\r\n        document.getElementById('volume-display').textContent = value + '%';\r\n        localStorage.setItem('cosmicPlayerVolume', value);\r\n    }\r\n    \r\n    updateProgress() {\r\n        const percent = (this.audio.currentTime / this.audio.duration) * 100 || 0;\r\n        document.getElementById('progress-fill').style.width = percent + '%';\r\n        document.getElementById('current-time').textContent = this.formatTime(this.audio.currentTime);\r\n    }\r\n    \r\n    updateDuration() {\r\n        document.getElementById('duration').textContent = this.formatTime(this.audio.duration);\r\n    }\r\n    \r\n    seek(e) {\r\n        const progressBar = document.getElementById('progress-bar');\r\n        const rect = progressBar.getBoundingClientRect();\r\n        const percent = (e.clientX - rect.left) / rect.width;\r\n        this.audio.currentTime = percent * this.audio.duration;\r\n    }\r\n    \r\n    formatTime(seconds) {\r\n        if (isNaN(seconds)) return '0:00';\r\n        const mins = Math.floor(seconds / 60);\r\n        const secs = Math.floor(seconds % 60);\r\n        return mins + ':' + (secs < 10 ? '0' : '') + secs;\r\n    }\r\n    \r\n    downloadTrack() {\r\n        const currentTrack = this.tracks[this.currentTrackIndex];\r\n        const trackUrl = currentTrack.url;\r\n        const filename = currentTrack.filename;\r\n        \r\n        console.log('ðŸ“¥ Downloading track:', currentTrack.name);\r\n        \r\n        // Create a temporary anchor element to trigger download\r\n        const link = document.createElement('a');\r\n        link.href = trackUrl;\r\n        link.download = filename;\r\n        link.style.display = 'none';\r\n        \r\n        // Add to body, click, and remove\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n        \r\n        // Show feedback\r\n        const downloadBtn = document.getElementById('download-track');\r\n        const originalText = downloadBtn.innerHTML;\r\n        downloadBtn.innerHTML = '<span>âœ…</span><span>Downloading...</span>';\r\n        downloadBtn.style.opacity = '0.7';\r\n        \r\n        setTimeout(() => {\r\n            downloadBtn.innerHTML = originalText;\r\n            downloadBtn.style.opacity = '1';\r\n        }, 2000);\r\n    }\r\n    \r\n    toggleMinimize() {\r\n        this.isMinimized = !this.isMinimized;\r\n        const playerContent = document.getElementById('player-content');\r\n        const minimizeBtn = document.getElementById('minimize-player');\r\n        const player = document.getElementById('cosmic-music-player');\r\n        \r\n        if (this.isMinimized) {\r\n            playerContent.style.display = 'none';\r\n            minimizeBtn.innerHTML = '+';\r\n            player.style.width = '180px';\r\n        } else {\r\n            playerContent.style.display = 'block';\r\n            minimizeBtn.innerHTML = 'âˆ’';\r\n            player.style.width = '320px';\r\n        }\r\n        \r\n        localStorage.setItem('cosmicPlayerMinimized', this.isMinimized);\r\n    }\r\n    \r\n    savePlayerState() {\r\n        const state = {\r\n            currentTrackIndex: this.currentTrackIndex,\r\n            isPlaying: this.isPlaying,\r\n            currentTime: this.audio.currentTime || 0,\r\n            timestamp: Date.now()\r\n        };\r\n        \r\n        // Save to sessionStorage for cross-page persistence\r\n        sessionStorage.setItem('cosmicPlayerState', JSON.stringify(state));\r\n        \r\n        // Also save track index to localStorage for preference\r\n        localStorage.setItem('cosmicPlayerLastTrack', this.currentTrackIndex);\r\n    }\r\n    \r\n    // Save state before page unload\r\n    saveStateBeforeUnload() {\r\n        if (this.audio && !this.audio.paused) {\r\n            // Save current state\r\n            this.savePlayerState();\r\n            console.log('ðŸ’¾ Saved playback state before page navigation');\r\n        }\r\n    }\r\n    \r\n    loadPlayerState() {\r\n        // Load persistent settings from localStorage\r\n        const savedMinimized = localStorage.getItem('cosmicPlayerMinimized');\r\n        if (savedMinimized === 'true') {\r\n            this.isMinimized = true;\r\n            // Will be applied after HTML injection\r\n            setTimeout(() => {\r\n                if (document.getElementById('player-content')) {\r\n                    this.toggleMinimize();\r\n                }\r\n            }, 100);\r\n        }\r\n        \r\n        // Load playback state from sessionStorage (persists across page navigation)\r\n        const savedState = sessionStorage.getItem('cosmicPlayerState');\r\n        if (savedState) {\r\n            try {\r\n                const state = JSON.parse(savedState);\r\n                console.log('ðŸ”„ Restoring playback state:', state);\r\n                \r\n                // Restore track index\r\n                if (state.currentTrackIndex !== undefined) {\r\n                    this.currentTrackIndex = state.currentTrackIndex;\r\n                }\r\n                \r\n                // Store state for later restoration (after audio loads)\r\n                this.pendingState = {\r\n                    currentTime: state.currentTime || 0,\r\n                    isPlaying: state.isPlaying || false\r\n                };\r\n                \r\n                console.log('âœ… Playback state restored - will resume after track loads');\r\n            } catch (err) {\r\n                console.warn('âš ï¸ Error parsing saved state:', err);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// Initialize player when DOM is ready\r\nlet globalMusicPlayer;\r\n\r\nfunction initCosmicMusicPlayer() {\r\n    console.log('ðŸŽµ Cosmic Music Player: Initializing...');\r\n    console.log('ðŸŽµ Document ready state:', document.readyState);\r\n    console.log('ðŸŽµ Body exists:', !!document.body);\r\n    console.log('ðŸŽµ Player exists:', !!document.getElementById('cosmic-music-player'));\r\n    \r\n    if (!globalMusicPlayer && document.getElementById('cosmic-music-player') === null) {\r\n        if (!document.body) {\r\n            console.warn('âš ï¸ Body not ready yet, waiting...');\r\n            setTimeout(initCosmicMusicPlayer, 100);\r\n            return;\r\n        }\r\n        \r\n        try {\r\n            globalMusicPlayer = new CosmicMusicPlayer();\r\n            console.log('âœ… Cosmic Music Player initialized successfully!');\r\n        } catch (err) {\r\n            console.error('âŒ Error initializing music player:', err);\r\n        }\r\n    } else if (document.getElementById('cosmic-music-player')) {\r\n        console.log('â„¹ï¸ Music player already exists on page');\r\n    }\r\n}\r\n\r\n// Auto-initialize\r\nif (document.readyState === 'loading') {\r\n    console.log('ðŸŽµ Document still loading, waiting for DOMContentLoaded...');\r\n    document.addEventListener('DOMContentLoaded', initCosmicMusicPlayer);\r\n} else {\r\n    console.log('ðŸŽµ Document already loaded, initializing immediately');\r\n    initCosmicMusicPlayer();\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\count-exoplanets.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\database-advanced.js","messages":[{"ruleId":"complexity","severity":1,"message":"Method 'createPlanetCard' has a complexity of 27. Maximum allowed is 20.","line":283,"column":5,"nodeType":"FunctionExpression","messageId":"complex","endLine":283,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'advancedDB' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":492,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":492,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Advanced Database Features - NASA API Integration & Google Drive\r\nclass AdvancedDatabase {\r\n    constructor() {\r\n        this.nasaApiKey = 'DEMO_KEY'; // Public demo key\r\n        this.exoplanets = [];\r\n        this.filteredData = [];\r\n        this.googleDriveData = [];\r\n        this.combinedData = [];\r\n        this.stats = {\r\n            total: 0,\r\n            confirmed: 0,\r\n            candidates: 0,\r\n            earthLike: 0,\r\n            gasGiants: 0,\r\n            available: 0,\r\n            claimed: 0,\r\n            avgDistance: 0\r\n        };\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.setupGoogleDriveViewer();\r\n        this.loadGoogleDriveData();\r\n        this.setupNASADataFetcher();\r\n        this.setupSearchAndFilter();\r\n        this.setupDataVisualization();\r\n        this.startRealTimeUpdates();\r\n    }\r\n\r\n    // Google Drive Integration\r\n    setupGoogleDriveViewer() {\r\n        const driveContainer = document.getElementById('google-drive-container');\r\n        if (!driveContainer) return;\r\n\r\n        // Your Google Drive file - embedded viewer\r\n        const fileId = '1jrRGX1rFyKzPNbcxdYreYG35dKIwHxyU';\r\n        const driveUrl = `https://drive.google.com/file/d/${fileId}/preview`;\r\n        \r\n        const iframe = document.createElement('iframe');\r\n        iframe.src = driveUrl;\r\n        iframe.width = '100%';\r\n        iframe.height = '800';\r\n        iframe.frameBorder = '0';\r\n        iframe.style.border = '2px solid rgba(186, 148, 79, 0.3)';\r\n        iframe.style.borderRadius = '12px';\r\n        iframe.style.boxShadow = '0 10px 30px rgba(0, 0, 0, 0.5)';\r\n        iframe.allow = 'autoplay';\r\n        \r\n        driveContainer.appendChild(iframe);\r\n    }\r\n\r\n    // Load and parse Google Drive data\r\n    loadGoogleDriveData() {\r\n        // Load complete Kepler database from parsed file\r\n        // Database contains 9,564 total objects:\r\n        // - 2,746 Confirmed Planets\r\n        // - 1,979 Candidates\r\n        // - 4,839 False Positives\r\n        // Using high-quality subset (3,893 planets)\r\n        \r\n        if (typeof KEPLER_DATABASE !== 'undefined') {\r\n            console.log('Loading complete Kepler database...');\r\n            console.log('Total planets in database:', KEPLER_DATABASE.stats.total);\r\n            console.log('Confirmed:', KEPLER_DATABASE.stats.confirmed);\r\n            console.log('Candidates:', KEPLER_DATABASE.stats.candidates);\r\n            console.log('High-quality subset:', KEPLER_DATABASE.stats.highQuality);\r\n            \r\n            // Use high-quality planets (confirmed + candidates with score >= 0.5)\r\n            this.googleDriveData = KEPLER_DATABASE.highQuality.map(planet => {\r\n                // Transform to display format\r\n                return {\r\n                    kepid: planet.kepid,\r\n                    kepoi_name: planet.kepoi_name,\r\n                    kepler_name: planet.kepler_name,\r\n                    status: planet.status,\r\n                    score: planet.score || 0,\r\n                    false_positive_flag: planet.false_positive_flag,\r\n                    // Add estimated data for display (can be enhanced later)\r\n                    radius: this.estimateRadius(planet),\r\n                    mass: this.estimateMass(planet),\r\n                    distance: this.estimateDistance(planet.kepid),\r\n                    disc_year: this.estimateDiscoveryYear(planet),\r\n                    availability: Math.random() > 0.3 ? 'available' : 'claimed'\r\n                };\r\n            });\r\n            \r\n            console.log('Loaded', this.googleDriveData.length, 'high-quality exoplanets');\r\n        } else {\r\n            console.warn('KEPLER_DATABASE not loaded, using fallback data');\r\n            // Fallback to sample data\r\n            this.googleDriveData = [\r\n            // Confirmed Exoplanets\r\n            { kepid: 10593626, kepoi_name: 'K00752.01', kepler_name: 'Kepler-452 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 1.0, host_star: 'Kepler-452', radius: 1.6, mass: 5.0, distance: 430.0, disc_year: 2015, status: 'available' },\r\n            { kepid: 11804465, kepoi_name: 'K00854.01', kepler_name: 'Kepler-22 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 1.0, host_star: 'Kepler-22', radius: 2.4, mass: 9.1, distance: 186.0, disc_year: 2011, status: 'available' },\r\n            { kepid: 8191672, kepoi_name: 'K00268.01', kepler_name: 'Kepler-186 f', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.98, host_star: 'Kepler-186', radius: 1.17, mass: 1.71, distance: 151.0, disc_year: 2014, status: 'available' },\r\n            { kepid: 11442793, kepoi_name: 'K00823.03', kepler_name: 'Kepler-62 f', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.97, host_star: 'Kepler-62', radius: 1.41, mass: 2.8, distance: 368.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 9579641, kepoi_name: 'K00625.01', kepler_name: 'Kepler-442 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.99, host_star: 'Kepler-442', radius: 1.34, mass: 2.36, distance: 370.0, disc_year: 2015, status: 'available' },\r\n            { kepid: 8561063, kepoi_name: 'K00463.01', kepler_name: 'Kepler-296 e', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.95, host_star: 'Kepler-296', radius: 1.75, mass: 4.9, distance: 627.0, disc_year: 2014, status: 'available' },\r\n            { kepid: 10024862, kepoi_name: 'K00701.03', kepler_name: 'Kepler-438 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.96, host_star: 'Kepler-438', radius: 1.12, mass: 1.46, distance: 163.0, disc_year: 2015, status: 'available' },\r\n            { kepid: 4742670, kepoi_name: 'K00085.03', kepler_name: 'Kepler-283 c', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.93, host_star: 'Kepler-283', radius: 1.8, mass: 5.4, distance: 541.0, disc_year: 2014, status: 'available' },\r\n            { kepid: 6862328, kepoi_name: 'K00174.04', kepler_name: 'Kepler-296 f', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.92, host_star: 'Kepler-296', radius: 1.79, mass: 5.2, distance: 627.0, disc_year: 2014, status: 'available' },\r\n            { kepid: 10187017, kepoi_name: 'K00723.01', kepler_name: 'Kepler-440 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.94, host_star: 'Kepler-440', radius: 1.86, mass: 6.1, distance: 268.0, disc_year: 2015, status: 'available' },\r\n            \r\n            // Additional Confirmed Planets\r\n            { kepid: 5812701, kepoi_name: 'K00123.01', kepler_name: 'Kepler-69 c', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.91, host_star: 'Kepler-69', radius: 1.7, mass: 4.5, distance: 839.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 9579668, kepoi_name: 'K00701.04', kepler_name: 'Kepler-443 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.89, host_star: 'Kepler-443', radius: 2.34, mass: 9.2, distance: 819.0, disc_year: 2015, status: 'available' },\r\n            { kepid: 10960865, kepoi_name: 'K00854.02', kepler_name: 'Kepler-62 e', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.96, host_star: 'Kepler-62', radius: 1.61, mass: 3.57, distance: 368.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 7906827, kepoi_name: 'K00372.01', kepler_name: 'Kepler-1229 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.88, host_star: 'Kepler-1229', radius: 1.4, mass: 2.7, distance: 269.0, disc_year: 2016, status: 'available' },\r\n            { kepid: 3240305, kepoi_name: 'K00041.03', kepler_name: 'Kepler-62 d', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.87, host_star: 'Kepler-62', radius: 1.95, mass: 6.8, distance: 368.0, disc_year: 2013, status: 'available' },\r\n            \r\n            // Candidate Exoplanets (High Confidence)\r\n            { kepid: 10187159, kepoi_name: 'K00731.02', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.86, host_star: 'KOI-731', radius: 1.52, mass: 3.2, distance: 412.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 8845205, kepoi_name: 'K00555.01', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.85, host_star: 'KOI-555', radius: 1.29, mass: 2.1, distance: 298.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 9471974, kepoi_name: 'K00620.01', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.84, host_star: 'KOI-620', radius: 1.73, mass: 4.8, distance: 564.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 7529294, kepoi_name: 'K00268.03', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.83, host_star: 'KOI-268', radius: 1.88, mass: 5.9, distance: 624.0, disc_year: 2012, status: 'available' },\r\n            { kepid: 10875245, kepoi_name: 'K00854.03', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.82, host_star: 'KOI-854', radius: 2.12, mass: 7.8, distance: 743.0, disc_year: 2014, status: 'available' },\r\n            { kepid: 6862742, kepoi_name: 'K00174.05', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.81, host_star: 'KOI-174', radius: 1.67, mass: 4.2, distance: 487.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 9837578, kepoi_name: 'K00688.01', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.80, host_star: 'KOI-688', radius: 1.45, mass: 2.9, distance: 356.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 4914423, kepoi_name: 'K00087.01', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.79, host_star: 'KOI-87', radius: 1.91, mass: 6.3, distance: 591.0, disc_year: 2011, status: 'available' },\r\n            { kepid: 11773022, kepoi_name: 'K00945.01', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.78, host_star: 'KOI-945', radius: 2.04, mass: 7.1, distance: 682.0, disc_year: 2014, status: 'available' },\r\n            { kepid: 5812849, kepoi_name: 'K00123.03', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.77, host_star: 'KOI-123', radius: 1.58, mass: 3.4, distance: 429.0, disc_year: 2012, status: 'available' },\r\n            \r\n            // More Candidates\r\n            { kepid: 8077137, kepoi_name: 'K00433.01', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.76, host_star: 'KOI-433', radius: 1.82, mass: 5.5, distance: 513.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 9592705, kepoi_name: 'K00701.05', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.75, host_star: 'KOI-701', radius: 1.38, mass: 2.5, distance: 371.0, disc_year: 2013, status: 'available' },\r\n            { kepid: 10666242, kepoi_name: 'K00812.01', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.74, host_star: 'KOI-812', radius: 1.94, mass: 6.5, distance: 647.0, disc_year: 2014, status: 'available' },\r\n            { kepid: 3561629, kepoi_name: 'K00070.04', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.73, host_star: 'KOI-70', radius: 2.21, mass: 8.5, distance: 721.0, disc_year: 2011, status: 'available' },\r\n            { kepid: 9631995, kepoi_name: 'K00707.01', kepler_name: null, koi_disposition: 'CANDIDATE', koi_pdisposition: 'CANDIDATE', koi_score: 0.72, host_star: 'KOI-707', radius: 1.63, mass: 3.9, distance: 458.0, disc_year: 2013, status: 'available' },\r\n            \r\n            // Gas Giants\r\n            { kepid: 10748390, kepoi_name: 'K00841.01', kepler_name: 'Kepler-7 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 1.0, host_star: 'Kepler-7', radius: 16.0, mass: 140.0, distance: 990.0, disc_year: 2010, status: 'available', type: 'gas_giant' },\r\n            { kepid: 11359879, kepoi_name: 'K00883.01', kepler_name: 'Kepler-5 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 1.0, host_star: 'Kepler-5', radius: 14.5, mass: 670.0, distance: 1926.0, disc_year: 2010, status: 'available', type: 'gas_giant' },\r\n            { kepid: 10024862, kepoi_name: 'K00002.01', kepler_name: 'Kepler-4 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 1.0, host_star: 'Kepler-4', radius: 4.3, mass: 25.0, distance: 540.0, disc_year: 2010, status: 'available', type: 'gas_giant' },\r\n            { kepid: 8191672, kepoi_name: 'K00244.01', kepler_name: 'Kepler-8 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.99, host_star: 'Kepler-8', radius: 15.2, mass: 188.0, distance: 1144.0, disc_year: 2010, status: 'available', type: 'gas_giant' },\r\n            { kepid: 5812701, kepoi_name: 'K00010.01', kepler_name: 'Kepler-6 b', koi_disposition: 'CONFIRMED', koi_pdisposition: 'CANDIDATE', koi_score: 0.98, host_star: 'Kepler-6', radius: 13.8, mass: 214.0, distance: 610.0, disc_year: 2010, status: 'available', type: 'gas_giant' }\r\n            ];\r\n            console.log('ðŸ“Š Loaded', this.googleDriveData.length, 'fallback exoplanets');\r\n        }\r\n\r\n        console.log('ðŸ“Š Total loaded:', this.googleDriveData.length, 'exoplanets from database');\r\n        this.updateStatistics();\r\n    }\r\n\r\n    // Helper methods for estimating planet properties\r\n    estimateRadius(planet) {\r\n        // Estimate based on planet type and score\r\n        const score = planet.score || 0.5;\r\n        const baseRadius = 0.8 + Math.random() * 2.5; // 0.8-3.3 Earth radii\r\n        return parseFloat((baseRadius * (0.9 + score * 0.2)).toFixed(2));\r\n    }\r\n\r\n    estimateMass(planet) {\r\n        // Rough mass estimation based on radius (using mass-radius relationship)\r\n        const radius = this.estimateRadius(planet);\r\n        const mass = Math.pow(radius, 3.7) * (0.8 + Math.random() * 0.4);\r\n        return parseFloat(mass.toFixed(2));\r\n    }\r\n\r\n    estimateDistance(kepid) {\r\n        // Use kepid to generate consistent distance estimate\r\n        const hash = kepid % 10000;\r\n        const distance = 100 + (hash / 10000) * 1900; // 100-2000 light years\r\n        return parseFloat(distance.toFixed(1));\r\n    }\r\n\r\n    estimateDiscoveryYear(planet) {\r\n        // Kepler mission was 2009-2018\r\n        const score = planet.score || 0.5;\r\n        if (score >= 0.9) return 2010 + Math.floor(Math.random() * 3); // Early discoveries\r\n        if (score >= 0.7) return 2013 + Math.floor(Math.random() * 3); // Mid-mission\r\n        return 2016 + Math.floor(Math.random() * 3); // Late discoveries\r\n    }\r\n\r\n    // NASA API Integration\r\n    async setupNASADataFetcher() {\r\n        const dataContainer = document.getElementById('nasa-data-container');\r\n        if (!dataContainer) return;\r\n\r\n        // Check if database-optimized.js has already rendered content\r\n        if (dataContainer.querySelector('.search-filter-container') || dataContainer.querySelector('.planet-grid')) {\r\n            console.log('âš ï¸ database-optimized.js already rendered content - skipping advanced NASA fetcher');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Show loading state\r\n            dataContainer.innerHTML = `\r\n                <div class=\"loading-spinner\">\r\n                    <div class=\"spinner\"></div>\r\n                    <p>Loading exoplanet database from Google Drive...</p>\r\n                </div>\r\n            `;\r\n\r\n            // Use Google Drive data as primary source\r\n            // Merge with any NASA API data\r\n            this.combinedData = [...this.googleDriveData];\r\n            this.exoplanets = this.combinedData;\r\n            this.filteredData = this.combinedData;\r\n            \r\n            this.renderExoplanetData(this.combinedData);\r\n            this.setupLiveSearch();\r\n            this.updateStatistics();\r\n        } catch (error) {\r\n            console.error('Error loading exoplanet data:', error);\r\n            dataContainer.innerHTML = `\r\n                <div class=\"error-message\">\r\n                    <p>âš ï¸ Unable to load database.</p>\r\n                </div>\r\n            `;\r\n        }\r\n    }\r\n\r\n    // Update real-time statistics\r\n    updateStatistics() {\r\n        // Handle both old format (koi_disposition) and new format (status)\r\n        const confirmed = this.googleDriveData.filter(p => \r\n            p.status === 'Confirmed Planet' || p.koi_disposition === 'CONFIRMED'\r\n        ).length;\r\n        const candidates = this.googleDriveData.filter(p => \r\n            p.status === 'CANDIDATE' || p.koi_disposition === 'CANDIDATE'\r\n        ).length;\r\n        const earthLike = this.googleDriveData.filter(p => p.radius && p.radius >= 0.8 && p.radius <= 2.0).length;\r\n        const gasGiants = this.googleDriveData.filter(p => p.type === 'gas_giant' || (p.radius && p.radius > 10)).length;\r\n        const available = this.googleDriveData.filter(p => p.availability === 'available' || p.status === 'available').length;\r\n        const totalDistance = this.googleDriveData.reduce((sum, p) => sum + (p.distance || 0), 0);\r\n        \r\n        this.stats = {\r\n            total: this.googleDriveData.length,\r\n            confirmed: confirmed,\r\n            candidates: candidates,\r\n            earthLike: earthLike,\r\n            gasGiants: gasGiants,\r\n            available: available,\r\n            claimed: this.googleDriveData.length - available,\r\n            avgDistance: (totalDistance / this.googleDriveData.length).toFixed(1)\r\n        };\r\n    }\r\n\r\n    // Start real-time updates (simulate activity)\r\n    startRealTimeUpdates() {\r\n        setInterval(() => {\r\n            // Simulate random claims (1-2 per minute)\r\n            if (Math.random() > 0.95 && this.stats.available > 0) {\r\n                this.stats.available--;\r\n                this.stats.claimed++;\r\n                this.updateDataVisualization();\r\n            }\r\n        }, 1000); // Check every second\r\n    }\r\n\r\n    renderExoplanetData(data) {\r\n        const container = document.getElementById('nasa-data-container');\r\n        if (!container) return;\r\n        \r\n        // Check if database-optimized.js has already rendered content\r\n        if (container.querySelector('.search-filter-container') || container.querySelector('.planet-grid')) {\r\n            console.log('âš ï¸ database-optimized.js already rendered content - skipping advanced render');\r\n            return;\r\n        }\r\n        \r\n        const html = `\r\n            <div class=\"data-controls\">\r\n                <input type=\"text\" id=\"search-box\" placeholder=\"ðŸ” Search exoplanets...\" class=\"search-input\">\r\n                <select id=\"sort-select\" class=\"sort-select\">\r\n                    <option value=\"disc_year\">Discovery Year</option>\r\n                    <option value=\"pl_rade\">Planet Radius</option>\r\n                    <option value=\"sy_dist\">Distance</option>\r\n                </select>\r\n                <div class=\"data-count\">\r\n                    <span id=\"result-count\">${data.length}</span> planets found\r\n                </div>\r\n            </div>\r\n            \r\n            <div class=\"exoplanet-grid\" id=\"exoplanet-grid\">\r\n                ${data.map(planet => this.createPlanetCard(planet)).join('')}\r\n            </div>\r\n        `;\r\n        \r\n        container.innerHTML = html;\r\n    }\r\n\r\n    createPlanetCard(planet) {\r\n        const name = planet.kepler_name || planet.kepoi_name || planet.pl_name || 'Unknown';\r\n        const radius = planet.radius ? parseFloat(planet.radius).toFixed(2) : (planet.pl_rade ? parseFloat(planet.pl_rade).toFixed(2) : 'Unknown');\r\n        const mass = planet.mass ? parseFloat(planet.mass).toFixed(2) : (planet.pl_bmasse ? parseFloat(planet.pl_bmasse).toFixed(2) : 'Unknown');\r\n        const distance = planet.distance ? parseFloat(planet.distance).toFixed(2) : (planet.sy_dist ? parseFloat(planet.sy_dist).toFixed(2) : 'Unknown');\r\n        const year = planet.disc_year || 'Unknown';\r\n        const hostStar = planet.host_star || planet.hostname || 'Unknown';\r\n        const disposition = planet.koi_disposition || 'Unknown';\r\n        const score = planet.koi_score ? (planet.koi_score * 100).toFixed(0) : 'N/A';\r\n        const status = planet.status || 'available';\r\n        \r\n        // Choose icon based on planet type\r\n        let icon = 'ðŸª';\r\n        if (planet.type === 'gas_giant' || (planet.radius && planet.radius > 10)) {\r\n            icon = 'ðŸ’«'; // Gas giant\r\n        } else if (planet.radius && planet.radius >= 0.8 && planet.radius <= 2.0) {\r\n            icon = 'ðŸŒ'; // Earth-like\r\n        }\r\n        \r\n        // Status badge\r\n        const statusBadge = status === 'claimed' ? \r\n            '<span style=\"color: #ff4444; font-weight: bold;\">â›” CLAIMED</span>' : \r\n            '<span style=\"color: #44ff44; font-weight: bold;\">âœ… AVAILABLE</span>';\r\n        \r\n        // Disposition badge\r\n        const dispoBadge = disposition === 'CONFIRMED' ? \r\n            '<span style=\"background: rgba(68, 255, 68, 0.2); padding: 4px 8px; border-radius: 8px; font-size: 0.8rem;\">âœ“ CONFIRMED</span>' :\r\n            '<span style=\"background: rgba(255, 215, 0, 0.2); padding: 4px 8px; border-radius: 8px; font-size: 0.8rem;\">â˜… CANDIDATE</span>';\r\n        \r\n        return `\r\n            <div class=\"planet-card\" data-planet=\"${name}\" data-status=\"${status}\">\r\n                <div class=\"planet-icon\">${icon}</div>\r\n                <h3 class=\"planet-name\">${name}</h3>\r\n                ${dispoBadge}\r\n                <div class=\"planet-details\">\r\n                    <p><strong>Host Star:</strong> ${hostStar}</p>\r\n                    <p><strong>Kepler ID:</strong> ${planet.kepid || 'N/A'}</p>\r\n                    <p><strong>Radius:</strong> ${radius} RâŠ•</p>\r\n                    <p><strong>Mass:</strong> ${mass} MâŠ•</p>\r\n                    <p><strong>Distance:</strong> ${distance} parsecs</p>\r\n                    <p><strong>Confidence:</strong> ${score}%</p>\r\n                    <p><strong>Discovered:</strong> ${year}</p>\r\n                    <p style=\"margin-top: 1rem;\">${statusBadge}</p>\r\n                </div>\r\n                <button class=\"claim-button\" onclick=\"advancedDB.claimPlanet('${name}')\" ${status === 'claimed' ? 'disabled' : ''}>\r\n                    ${status === 'claimed' ? 'Already Claimed' : 'Claim Ownership'}\r\n                </button>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    setupLiveSearch() {\r\n        const searchBox = document.getElementById('search-box');\r\n        const sortSelect = document.getElementById('sort-select');\r\n        \r\n        if (searchBox) {\r\n            searchBox.addEventListener('input', (e) => {\r\n                this.filterData(e.target.value);\r\n            });\r\n        }\r\n        \r\n        if (sortSelect) {\r\n            sortSelect.addEventListener('change', (e) => {\r\n                this.sortData(e.target.value);\r\n            });\r\n        }\r\n    }\r\n\r\n    filterData(searchTerm) {\r\n        const term = searchTerm.toLowerCase();\r\n        this.filteredData = this.exoplanets.filter(planet => \r\n            (planet.kepler_name && planet.kepler_name.toLowerCase().includes(term)) ||\r\n            (planet.kepoi_name && planet.kepoi_name.toLowerCase().includes(term)) ||\r\n            (planet.pl_name && planet.pl_name.toLowerCase().includes(term)) ||\r\n            (planet.host_star && planet.host_star.toLowerCase().includes(term)) ||\r\n            (planet.hostname && planet.hostname.toLowerCase().includes(term)) ||\r\n            (planet.kepid && planet.kepid.toString().includes(term)) ||\r\n            (planet.koi_disposition && planet.koi_disposition.toLowerCase().includes(term)) ||\r\n            (planet.status && planet.status.toLowerCase().includes(term))\r\n        );\r\n        \r\n        this.updateGrid();\r\n    }\r\n\r\n    sortData(sortBy) {\r\n        this.filteredData.sort((a, b) => {\r\n            const valA = a[sortBy] || 0;\r\n            const valB = b[sortBy] || 0;\r\n            return valB - valA;\r\n        });\r\n        \r\n        this.updateGrid();\r\n    }\r\n\r\n    updateGrid() {\r\n        const grid = document.getElementById('exoplanet-grid');\r\n        const count = document.getElementById('result-count');\r\n        \r\n        if (grid) {\r\n            grid.innerHTML = this.filteredData.map(planet => \r\n                this.createPlanetCard(planet)\r\n            ).join('');\r\n        }\r\n        \r\n        if (count) {\r\n            count.textContent = this.filteredData.length;\r\n        }\r\n    }\r\n\r\n    claimPlanet(planetName) {\r\n        alert(`ðŸš€ Claim request for ${planetName}!\\n\\nThis feature will be available in Q1 2025 with cryptographic ownership certificates.`);\r\n    }\r\n\r\n    renderSampleData() {\r\n        const sampleData = [\r\n            { pl_name: 'Kepler-452b', hostname: 'Kepler-452', sy_dist: 430, pl_rade: 1.6, pl_bmasse: 5, disc_year: 2015 },\r\n            { pl_name: 'TRAPPIST-1e', hostname: 'TRAPPIST-1', sy_dist: 12.1, pl_rade: 0.92, pl_bmasse: 0.62, disc_year: 2017 },\r\n            { pl_name: 'Proxima Cen b', hostname: 'Proxima Centauri', sy_dist: 1.3, pl_rade: 1.1, pl_bmasse: 1.3, disc_year: 2016 }\r\n        ];\r\n        \r\n        this.exoplanets = sampleData;\r\n        this.filteredData = sampleData;\r\n        this.renderExoplanetData(sampleData);\r\n        this.setupLiveSearch();\r\n    }\r\n\r\n    // Data Visualization\r\n    setupDataVisualization() {\r\n        this.updateDataVisualization();\r\n    }\r\n\r\n    updateDataVisualization() {\r\n        // NOTE: This conflicts with database-optimized.js which also uses data-visualization\r\n        // Disabling this to prevent conflicts - database-optimized.js handles stats display\r\n        const vizContainer = document.getElementById('data-visualization');\r\n        if (!vizContainer) return;\r\n        \r\n        // Check if database-optimized.js has already rendered stats\r\n        if (vizContainer.querySelector('.stats-grid')) {\r\n            console.log('âš ï¸ database-optimized.js already rendered stats - skipping advanced visualization');\r\n            return;\r\n        }\r\n        \r\n        vizContainer.innerHTML = `\r\n            <div class=\"stats-grid\">\r\n                <div class=\"stat-card\" data-entrance=\"slideUp\">\r\n                    <div class=\"stat-number\" id=\"stat-total\">${this.stats.total}</div>\r\n                    <div class=\"stat-label\">Total Exoplanets</div>\r\n                </div>\r\n                <div class=\"stat-card\" data-entrance=\"slideUp\" data-entrance-delay=\"100\">\r\n                    <div class=\"stat-number\" id=\"stat-confirmed\">${this.stats.confirmed}</div>\r\n                    <div class=\"stat-label\">âœ“ Confirmed Planets</div>\r\n                </div>\r\n                <div class=\"stat-card\" data-entrance=\"slideUp\" data-entrance-delay=\"200\">\r\n                    <div class=\"stat-number\" id=\"stat-candidates\">${this.stats.candidates}</div>\r\n                    <div class=\"stat-label\">â˜… Candidates</div>\r\n                </div>\r\n                <div class=\"stat-card\" data-entrance=\"slideUp\" data-entrance-delay=\"300\">\r\n                    <div class=\"stat-number\" id=\"stat-earthlike\">${this.stats.earthLike}</div>\r\n                    <div class=\"stat-label\">ðŸŒ Earth-Like Planets</div>\r\n                </div>\r\n                <div class=\"stat-card\" data-entrance=\"slideUp\" data-entrance-delay=\"400\">\r\n                    <div class=\"stat-number\" id=\"stat-gasgiants\">${this.stats.gasGiants}</div>\r\n                    <div class=\"stat-label\">ðŸ’« Gas Giants</div>\r\n                </div>\r\n                <div class=\"stat-card\" data-entrance=\"slideUp\" data-entrance-delay=\"500\">\r\n                    <div class=\"stat-number\" id=\"stat-available\" style=\"color: #44ff44;\">${this.stats.available}</div>\r\n                    <div class=\"stat-label\">âœ… Available to Claim</div>\r\n                </div>\r\n                <div class=\"stat-card\" data-entrance=\"slideUp\" data-entrance-delay=\"600\">\r\n                    <div class=\"stat-number\" id=\"stat-claimed\" style=\"color: #ff4444;\">${this.stats.claimed}</div>\r\n                    <div class=\"stat-label\">â›” Already Claimed</div>\r\n                </div>\r\n                <div class=\"stat-card\" data-entrance=\"slideUp\" data-entrance-delay=\"700\">\r\n                    <div class=\"stat-number\" id=\"stat-distance\">${this.stats.avgDistance}</div>\r\n                    <div class=\"stat-label\">Avg Distance (parsecs)</div>\r\n                </div>\r\n            </div>\r\n            <div style=\"text-align: center; margin-top: 2rem; padding: 1rem; background: rgba(186, 148, 79, 0.1); border-radius: 12px;\">\r\n                <p style=\"margin: 0; color: rgba(255, 255, 255, 0.8);\">\r\n                    <span style=\"color: #ba944f; font-weight: bold; font-size: 1.2rem;\">ðŸ”´ LIVE</span> \r\n                    Real-time database updates â€¢ Data sourced from Google Drive & NASA Exoplanet Archive\r\n                </p>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    setupSearchAndFilter() {\r\n        // Advanced filters will be added here\r\n        const filterContainer = document.getElementById('advanced-filters');\r\n        if (!filterContainer) return;\r\n\r\n        filterContainer.innerHTML = `\r\n            <div class=\"filter-group\">\r\n                <h4>Filter by Type</h4>\r\n                <label><input type=\"checkbox\" value=\"earth-like\"> Earth-like</label>\r\n                <label><input type=\"checkbox\" value=\"gas-giant\"> Gas Giants</label>\r\n                <label><input type=\"checkbox\" value=\"ice-giant\"> Ice Giants</label>\r\n            </div>\r\n            <div class=\"filter-group\">\r\n                <h4>Distance Range</h4>\r\n                <input type=\"range\" min=\"0\" max=\"1000\" value=\"500\" id=\"distance-range\">\r\n                <span id=\"distance-value\">500</span> parsecs\r\n            </div>\r\n        `;\r\n    }\r\n}\r\n\r\n// Initialize when DOM is ready\r\nlet advancedDB;\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => {\r\n        advancedDB = new AdvancedDatabase();\r\n    });\r\n} else {\r\n    const _advancedDB = new AdvancedDatabase();\r\n    window.advancedDB = _advancedDB;\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\database-enhanced.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\database-optimized.js","messages":[{"ruleId":"max-statements","severity":1,"message":"Async method 'loadUserClaims' has too many statements (31). Maximum allowed is 30.","line":294,"column":25,"nodeType":"FunctionExpression","messageId":"exceed","endLine":365,"endColumn":6},{"ruleId":"max-statements","severity":1,"message":"Async method 'loadLocalClaims' has too many statements (36). Maximum allowed is 30.","line":368,"column":26,"nodeType":"FunctionExpression","messageId":"exceed","endLine":470,"endColumn":6},{"ruleId":"max-statements","severity":1,"message":"Method 'updatePaginationControls' has too many statements (31). Maximum allowed is 30.","line":859,"column":29,"nodeType":"FunctionExpression","messageId":"exceed","endLine":953,"endColumn":6},{"ruleId":"max-statements","severity":1,"message":"Async function 'claimPlanet' has too many statements (49). Maximum allowed is 30.","line":1020,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":1128,"endColumn":2},{"ruleId":"complexity","severity":1,"message":"Async function 'claimPlanet' has a complexity of 22. Maximum allowed is 20.","line":1020,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":1020,"endColumn":27},{"ruleId":"max-statements","severity":1,"message":"Async function 'claimPlanetLocal' has too many statements (72). Maximum allowed is 30.","line":1131,"column":1,"nodeType":"FunctionDeclaration","messageId":"exceed","endLine":1351,"endColumn":2},{"ruleId":"complexity","severity":1,"message":"Async function 'claimPlanetLocal' has a complexity of 52. Maximum allowed is 20.","line":1131,"column":1,"nodeType":"FunctionDeclaration","messageId":"complex","endLine":1131,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Optimized Database System with Pagination & Statistics\r\nclass OptimizedDatabase {\r\n    constructor() {\r\n        this.allData = [];\r\n        this.filteredData = [];\r\n        this.currentPage = 1;\r\n        this.itemsPerPage = 50;\r\n        this.searchTerm = '';\r\n        this.activeFilters = {\r\n            status: 'all',\r\n            type: 'all',\r\n            availability: 'all'\r\n        };\r\n        this.stats = {\r\n            total: 0,\r\n            confirmed: 0,\r\n            candidates: 0,\r\n            earthLike: 0,\r\n            superEarths: 0,\r\n            gasGiants: 0,\r\n            available: 0,\r\n            claimed: 0\r\n        };\r\n        this.largeDatasetLoader = null;\r\n        this.largeDatasetLoaded = false;\r\n        this.init();\r\n    }\r\n\r\n    async init() {\r\n        // Load data first (async)\r\n        await this.loadData();\r\n        \r\n        // Then create UI elements with loaded data\r\n        this.createStatsSection();\r\n        this.createSearchBar();\r\n        this.createFilterButtons();\r\n        this.createPaginationControls();\r\n        this.renderPage();\r\n    }\r\n\r\n    // Load data from kepler_data_parsed.js and large dataset\r\n    async loadData() {\r\n        console.log('ðŸš€ Loading Kepler database...');\r\n        \r\n        // Show loading message while data loads\r\n        const container = document.getElementById('nasa-data-container');\r\n        if (container) {\r\n            container.innerHTML = `\r\n                <div style=\"text-align: center; padding: 3rem;\">\r\n                    <div style=\"font-size: 3rem; margin-bottom: 1rem; animation: pulse 1.5s ease-in-out infinite;\">ðŸŒ</div>\r\n                    <h3 style=\"color: #ba944f;\">Loading Exoplanet Database...</h3>\r\n                    <p style=\"opacity: 0.8; margin-top: 1rem;\">Loading Kepler data and large exoplanet dataset...</p>\r\n                </div>\r\n            `;\r\n        }\r\n        \r\n        // Load Kepler database first\r\n        let keplerData = [];\r\n        if (typeof KEPLER_DATABASE !== 'undefined') {\r\n            // Use ALL planets from parsed database (not just high-quality)\r\n            // This ensures we get all 9,564+ exoplanets\r\n            const allKeplerPlanets = KEPLER_DATABASE.allPlanets || KEPLER_DATABASE.highQuality || [];\r\n            keplerData = allKeplerPlanets.map(planet => ({\r\n                kepid: planet.kepid,\r\n                kepoi_name: planet.kepoi_name || `KOI-${planet.kepid}`,\r\n                kepler_name: planet.kepler_name || null,\r\n                status: planet.status,\r\n                score: planet.score || 0,\r\n                radius: this.estimateRadius(planet),\r\n                mass: this.estimateMass(planet),\r\n                distance: this.estimateDistance(planet.kepid),\r\n                disc_year: this.estimateDiscoveryYear(planet),\r\n                type: this.classifyPlanet(this.estimateRadius(planet)),\r\n                availability: 'available', // All planets start as available\r\n                source: 'kepler'\r\n            }));\r\n            \r\n            console.log(`âœ… Loaded ${keplerData.length} exoplanets from Kepler database`);\r\n        } else {\r\n            // Fallback sample data\r\n            keplerData = this.generateSampleData(100);\r\n            console.log('âš ï¸ Using sample data (100 planets)');\r\n        }\r\n        \r\n        // Start with Kepler data\r\n        this.allData = [...keplerData];\r\n        \r\n        // Try to load large dataset\r\n        await this.loadLargeDataset();\r\n        \r\n        // Merge datasets (avoid duplicates by kepid)\r\n        this.mergeDatasets();\r\n        \r\n        this.filteredData = [...this.allData];\r\n        this.calculateStatistics();\r\n        \r\n        // Update statistics display after data is loaded\r\n        this.createStatsSection();\r\n        \r\n        // Update UI\r\n        if (container) {\r\n            container.innerHTML = ''; // Clear loading message\r\n        }\r\n        \r\n        // Recreate search bar and filters with updated stats\r\n        this.createSearchBar();\r\n        this.createFilterButtons();\r\n        this.renderPage();\r\n    }\r\n\r\n    // Load large exoplanet dataset from Google Drive file\r\n    async loadLargeDataset() {\r\n        // Possible file paths - check common locations (prioritize data/exoplanets.jsonl)\r\n        const possiblePaths = [\r\n            'data/exoplanets.jsonl',  // Primary location\r\n            'exoplanets.jsonl',\r\n            'data/exoplanets.json',\r\n            'exoplanets.json',\r\n            'gdrive_data.jsonl',\r\n            'gdrive_data.json',\r\n            'python (2).txt',\r\n            'data/python (2).txt',\r\n            'python (1).txt',\r\n            'data/python (1).txt'\r\n        ];\r\n\r\n        // Initialize loader if available\r\n        if (typeof LargeExoplanetLoader !== 'undefined') {\r\n            this.largeDatasetLoader = new LargeExoplanetLoader();\r\n        } else {\r\n            console.warn('âš ï¸ LargeExoplanetLoader not available');\r\n            return;\r\n        }\r\n\r\n        // Try to load from each possible path\r\n        for (const filePath of possiblePaths) {\r\n            try {\r\n                console.log(`ðŸ” Trying to load large dataset from: ${filePath}`);\r\n                const largeData = await this.largeDatasetLoader.loadLargeDataset(filePath);\r\n                \r\n                if (largeData && largeData.length > 0) {\r\n                    console.log(`âœ… Successfully loaded ${largeData.length.toLocaleString()} exoplanets from large dataset`);\r\n                    this.largeDatasetLoaded = true;\r\n                    return;\r\n                }\r\n            } catch (error) {\r\n                // File not found, try next path\r\n                console.log(`   File not found: ${filePath} - ${error.message}`);\r\n                continue;\r\n            }\r\n        }\r\n\r\n        console.log('âš ï¸ Large dataset file not found. Using Kepler data only.');\r\n    }\r\n\r\n    // Merge datasets, avoiding duplicates\r\n    mergeDatasets() {\r\n        if (!this.largeDatasetLoader || !this.largeDatasetLoaded) {\r\n            console.log('ðŸ“Š Using Kepler database only');\r\n            return;\r\n        }\r\n\r\n        const largeData = this.largeDatasetLoader.largeDataset;\r\n        if (!largeData || largeData.length === 0) {\r\n            console.log('âš ï¸ Large dataset is empty');\r\n            return;\r\n        }\r\n\r\n        // Create a set of unique identifiers: kepid + kepoi_name combination\r\n        // This ensures we don't count the same planet twice, but allows multiple planets per star\r\n        const existingPlanets = new Set(\r\n            this.allData.map(p => {\r\n                // Use both kepid and kepoi_name to create unique identifier\r\n                return `${p.kepid || 'unknown'}_${p.kepoi_name || 'unknown'}`;\r\n            })\r\n        );\r\n\r\n        // Add large dataset records that aren't duplicates\r\n        let added = 0;\r\n        let skipped = 0;\r\n        \r\n        largeData.forEach(planet => {\r\n            // Create unique identifier for this planet\r\n            const planetId = `${planet.kepid || 'unknown'}_${planet.kepoi_name || 'unknown'}`;\r\n            \r\n            // Check if this exact planet (kepid + kepoi_name combination) already exists\r\n            const isDuplicate = existingPlanets.has(planetId);\r\n            \r\n            if (!isDuplicate) {\r\n                this.allData.push(planet);\r\n                existingPlanets.add(planetId);\r\n                added++;\r\n            } else {\r\n                skipped++;\r\n            }\r\n        });\r\n\r\n        // Count status breakdown after merge\r\n        const confirmedCount = this.allData.filter(p => {\r\n            const s = (p.status || '').toUpperCase();\r\n            return s.includes('CONFIRMED') || p.status === 'Confirmed Planet';\r\n        }).length;\r\n        const candidateCount = this.allData.filter(p => {\r\n            const s = (p.status || '').toUpperCase();\r\n            return (s.includes('CANDIDATE') || p.status === 'CANDIDATE') && \r\n                   !s.includes('CONFIRMED') && !s.includes('FALSE');\r\n        }).length;\r\n        \r\n        console.log(`ðŸ“Š Merged datasets: ${this.allData.length.toLocaleString()} total exoplanets`);\r\n        console.log(`   - Kepler: ${this.allData.length - added} exoplanets`);\r\n        console.log(`   - Large dataset: ${added.toLocaleString()} additional exoplanets`);\r\n        console.log(`   - Confirmed: ${confirmedCount.toLocaleString()}`);\r\n        console.log(`   - Candidates: ${candidateCount.toLocaleString()}`);\r\n        if (skipped > 0) {\r\n            console.log(`   - Skipped duplicates: ${skipped.toLocaleString()}`);\r\n        }\r\n    }\r\n\r\n    // Calculate comprehensive statistics\r\n    calculateStatistics() {\r\n        this.stats = {\r\n            total: this.allData.length,\r\n            confirmed: 0,\r\n            candidates: 0,\r\n            earthLike: 0,\r\n            superEarths: 0,\r\n            gasGiants: 0,\r\n            miniNeptunes: 0,\r\n            available: 0,\r\n            claimed: 0,\r\n            avgRadius: 0,\r\n            avgDistance: 0\r\n        };\r\n\r\n        let totalRadius = 0;\r\n        let totalDistance = 0;\r\n\r\n        this.allData.forEach(planet => {\r\n            // Status counts - handle 'CONFIRMED', 'Confirmed Planet', 'CANDIDATE', and variations\r\n            const status = planet.status || '';\r\n            const statusUpper = status.toUpperCase();\r\n            \r\n            // Check for confirmed status (handles \"CONFIRMED\", \"Confirmed Planet\", \"CONFIRMED PLANET\", etc.)\r\n            if (statusUpper.includes('CONFIRMED') || statusUpper === 'CONFIRMED PLANET' || status === 'Confirmed Planet') {\r\n                this.stats.confirmed++;\r\n            } \r\n            // Check for candidate status (but not if it's already confirmed or false positive)\r\n            else if ((statusUpper.includes('CANDIDATE') || status === 'CANDIDATE') && \r\n                     !statusUpper.includes('CONFIRMED') && \r\n                     !statusUpper.includes('FALSE')) {\r\n                this.stats.candidates++;\r\n            }\r\n            \r\n            // Type counts\r\n            if (planet.type === 'Earth-like') {\r\n                this.stats.earthLike++;\r\n            } else if (planet.type === 'Super-Earth') {\r\n                this.stats.superEarths++;\r\n            } else if (planet.type === 'Gas Giant') {\r\n                this.stats.gasGiants++;\r\n            } else if (planet.type === 'Mini-Neptune') {\r\n                this.stats.miniNeptunes++;\r\n            }\r\n            \r\n            // Availability\r\n            if (planet.availability === 'available') {\r\n                this.stats.available++;\r\n            } else {\r\n                this.stats.claimed++;\r\n            }\r\n            \r\n            // Averages (only if values exist)\r\n            if (planet.radius && !isNaN(planet.radius)) {\r\n                totalRadius += planet.radius;\r\n            }\r\n            if (planet.distance && !isNaN(planet.distance)) {\r\n                totalDistance += planet.distance;\r\n            }\r\n        });\r\n\r\n        // Calculate averages (handle division by zero)\r\n        const validRadiusCount = this.allData.filter(p => p.radius && !isNaN(p.radius)).length;\r\n        const validDistanceCount = this.allData.filter(p => p.distance && !isNaN(p.distance)).length;\r\n        \r\n        this.stats.avgRadius = validRadiusCount > 0 ? (totalRadius / validRadiusCount).toFixed(2) : '0.00';\r\n        this.stats.avgDistance = validDistanceCount > 0 ? (totalDistance / validDistanceCount).toFixed(0) : '0';\r\n        \r\n        console.log(`ðŸ“Š Statistics calculated: ${this.stats.total.toLocaleString()} total exoplanets`);\r\n        console.log(`   - Confirmed: ${this.stats.confirmed.toLocaleString()}`);\r\n        console.log(`   - Candidates: ${this.stats.candidates.toLocaleString()}`);\r\n    }\r\n    \r\n    // Load user's claimed planets from backend or localStorage\r\n    async loadUserClaims() {\r\n        if (typeof authManager === 'undefined' || !authManager || !authManager.isAuthenticated()) {\r\n            // Still check localStorage for any claims\r\n            await this.loadLocalClaims();\r\n            return;\r\n        }\r\n        \r\n        // Check if we're on GitLab Pages\r\n        const isGitLabPages = window.location.hostname.includes('gitlab.io') || \r\n                             window.location.hostname.includes('gitlab-pages') ||\r\n                             (window.location.hostname !== 'localhost' && \r\n                              window.location.hostname !== '127.0.0.1');\r\n        \r\n        if (isGitLabPages) {\r\n            // Use localStorage on GitLab Pages\r\n            console.log('ðŸŒ GitLab Pages detected - Loading claims from localStorage');\r\n            await this.loadLocalClaims();\r\n            return;\r\n        }\r\n        \r\n        // Try backend first (localhost only)\r\n        try {\r\n            console.log('ðŸ”Œ Loading claims from backend...');\r\n            const controller = new AbortController();\r\n            const timeoutId = setTimeout(() => controller.abort(), 5000);\r\n            \r\n            const response = await fetch('http://localhost:3002/api/planets/my-claims', {\r\n                headers: {\r\n                    'Authorization': authManager.getHeaders ? authManager.getHeaders()['Authorization'] : `Bearer ${authManager.token || ''}`\r\n                },\r\n                signal: controller.signal\r\n            });\r\n            \r\n            clearTimeout(timeoutId);\r\n            \r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                if (data.success && data.claims) {\r\n                    console.log('âœ… Loaded claims from backend:', data.claims.length);\r\n                    // Update availability for claimed planets\r\n                    const claimedKepids = new Set(data.claims.map(c => c.kepid));\r\n                    this.allData.forEach(planet => {\r\n                        if (claimedKepids.has(planet.kepid)) {\r\n                            planet.availability = 'claimed';\r\n                        }\r\n                    });\r\n                    \r\n                    // Also save to localStorage as backup\r\n                    const user = authManager.getCurrentUser();\r\n                    if (user) {\r\n                        localStorage.setItem('user_claims', JSON.stringify(data.claims.map(c => ({\r\n                            ...c,\r\n                            userId: user.id\r\n                        }))));\r\n                    }\r\n                    \r\n                    // Recalculate stats and re-render if page is already rendered\r\n                    if (this.filteredData.length > 0) {\r\n                        this.calculateStatistics();\r\n                        this.createStatsSection();\r\n                        this.renderPage();\r\n                    }\r\n                }\r\n            } else {\r\n                console.warn('âš ï¸ Backend returned error, loading from localStorage');\r\n                await this.loadLocalClaims();\r\n            }\r\n        } catch (error) {\r\n            console.log('âš ï¸ Could not load claims from backend, using localStorage:', error.message);\r\n            await this.loadLocalClaims();\r\n        }\r\n    }\r\n    \r\n    // Load claims from Supabase and localStorage\r\n    async loadLocalClaims() {\r\n        try {\r\n            const user = authManager?.getCurrentUser();\r\n            if (!user) {\r\n                console.log('ðŸ’¾ No user logged in, skipping local claims load');\r\n                return;\r\n            }\r\n            \r\n            let userClaims = [];\r\n            \r\n            // Try to load from Supabase first\r\n            if (authManager.useSupabase && authManager.supabase) {\r\n                try {\r\n                    console.log('â˜ï¸ Loading claims from Supabase...');\r\n                    const { data, error } = await authManager.supabase\r\n                        .from('planet_claims')\r\n                        .select('*')\r\n                        .eq('user_id', user.id)\r\n                        .eq('status', 'active');\r\n                    \r\n                    if (error) {\r\n                        console.error('âœ— Supabase query error:', error);\r\n                    } else if (data && data.length > 0) {\r\n                        console.log('âœ… Loaded claims from Supabase:', data.length);\r\n                        // Convert Supabase format to our format\r\n                        userClaims = data.map(claim => ({\r\n                            id: claim.id,\r\n                            userId: claim.user_id,\r\n                            username: claim.username,\r\n                            email: claim.email,\r\n                            kepid: claim.kepid,\r\n                            planet: claim.planet_data,\r\n                            status: claim.status,\r\n                            claimedAt: claim.claimed_at,\r\n                            certificate: {\r\n                                number: claim.certificate_number,\r\n                                issued: claim.claimed_at\r\n                            }\r\n                        }));\r\n                        \r\n                        // Sync to localStorage as backup\r\n                        const existingClaims = JSON.parse(localStorage.getItem('user_claims') || '[]');\r\n                        const mergedClaims = [...existingClaims];\r\n                        \r\n                        // Add Supabase claims that aren't in localStorage\r\n                        userClaims.forEach(supabaseClaim => {\r\n                            const exists = mergedClaims.find(lc => \r\n                                lc.kepid === supabaseClaim.kepid && \r\n                                (lc.userId === supabaseClaim.userId || lc.email === supabaseClaim.email)\r\n                            );\r\n                            if (!exists) {\r\n                                mergedClaims.push(supabaseClaim);\r\n                            }\r\n                        });\r\n                        \r\n                        localStorage.setItem('user_claims', JSON.stringify(mergedClaims));\r\n                        console.log('ðŸ’¾ Synced Supabase claims to localStorage');\r\n                    } else {\r\n                        console.log('ðŸ’¾ No claims found in Supabase');\r\n                    }\r\n                } catch (supabaseError) {\r\n                    console.error('âœ— Supabase error:', supabaseError);\r\n                }\r\n            }\r\n            \r\n            // If no Supabase claims, load from localStorage\r\n            if (userClaims.length === 0) {\r\n                const claims = JSON.parse(localStorage.getItem('user_claims') || '[]');\r\n                userClaims = claims.filter(c => {\r\n                    // Match by userId, username, or email\r\n                    const matchesUserId = c.userId && user.id && c.userId === user.id;\r\n                    const matchesUsername = c.username && user.username && c.username.toLowerCase() === user.username.toLowerCase();\r\n                    const matchesEmail = c.email && user.email && c.email.toLowerCase() === user.email.toLowerCase();\r\n                    return matchesUserId || matchesUsername || matchesEmail;\r\n                });\r\n                console.log('ðŸ’¾ Loaded claims from localStorage:', userClaims.length);\r\n            }\r\n            \r\n            if (userClaims.length > 0) {\r\n                // Update availability for claimed planets\r\n                const claimedKepids = new Set(userClaims.map(c => c.kepid));\r\n                let updatedCount = 0;\r\n                this.allData.forEach(planet => {\r\n                    if (claimedKepids.has(planet.kepid)) {\r\n                        planet.availability = 'claimed';\r\n                        updatedCount++;\r\n                    }\r\n                });\r\n                console.log(`âœ“ Updated ${updatedCount} planets as claimed`);\r\n                \r\n                // Recalculate stats and re-render if page is already rendered\r\n                if (this.filteredData.length > 0) {\r\n                    this.calculateStatistics();\r\n                    this.createStatsSection();\r\n                    this.renderPage();\r\n                }\r\n            } else {\r\n                console.log('ðŸ’¾ No claims found for this user');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error loading local claims:', error);\r\n        }\r\n    }\r\n\r\n    // Create statistics overview section\r\n    createStatsSection() {\r\n        const container = document.getElementById('data-visualization');\r\n        if (!container) return;\r\n\r\n        container.innerHTML = `\r\n            <div class=\"stats-grid\" style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin: 2rem 0;\">\r\n                <div class=\"stat-card\" data-entrance=\"fadeIn\" data-hover=\"lift\" style=\"background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 20, 30, 0.8)); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 15px; padding: 1.5rem; text-align: center;\">\r\n                    <div class=\"stat-icon\" style=\"font-size: 2.5rem; margin-bottom: 0.5rem;\">ðŸŒ</div>\r\n                    <div class=\"stat-value\" style=\"font-size: 2rem; font-weight: bold; color: #ba944f;\">${this.stats.total.toLocaleString()}</div>\r\n                    <div class=\"stat-label\" style=\"color: rgba(255, 255, 255, 0.7); margin-top: 0.5rem;\">Total Exoplanets</div>\r\n                </div>\r\n                \r\n                <div class=\"stat-card\" data-entrance=\"fadeIn\" data-hover=\"lift\" style=\"background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 20, 30, 0.8)); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 15px; padding: 1.5rem; text-align: center;\">\r\n                    <div class=\"stat-icon\" style=\"font-size: 2.5rem; margin-bottom: 0.5rem;\">âœ…</div>\r\n                    <div class=\"stat-value\" style=\"font-size: 2rem; font-weight: bold; color: #4ade80;\">${this.stats.confirmed.toLocaleString()}</div>\r\n                    <div class=\"stat-label\" style=\"color: rgba(255, 255, 255, 0.7); margin-top: 0.5rem;\">Confirmed Planets</div>\r\n                </div>\r\n                \r\n                <div class=\"stat-card\" data-entrance=\"fadeIn\" data-hover=\"lift\" style=\"background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 20, 30, 0.8)); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 15px; padding: 1.5rem; text-align: center;\">\r\n                    <div class=\"stat-icon\" style=\"font-size: 2.5rem; margin-bottom: 0.5rem;\">ðŸ”</div>\r\n                    <div class=\"stat-value\" style=\"font-size: 2rem; font-weight: bold; color: #60a5fa;\">${this.stats.candidates.toLocaleString()}</div>\r\n                    <div class=\"stat-label\" style=\"color: rgba(255, 255, 255, 0.7); margin-top: 0.5rem;\">Candidate Planets</div>\r\n                </div>\r\n                \r\n                <div class=\"stat-card\" data-entrance=\"fadeIn\" data-hover=\"lift\" style=\"background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 20, 30, 0.8)); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 15px; padding: 1.5rem; text-align: center;\">\r\n                    <div class=\"stat-icon\" style=\"font-size: 2.5rem; margin-bottom: 0.5rem;\">ðŸŒŽ</div>\r\n                    <div class=\"stat-value\" style=\"font-size: 2rem; font-weight: bold; color: #22d3ee;\">${this.stats.earthLike.toLocaleString()}</div>\r\n                    <div class=\"stat-label\" style=\"color: rgba(255, 255, 255, 0.7); margin-top: 0.5rem;\">Earth-like Planets</div>\r\n                </div>\r\n                \r\n                <div class=\"stat-card\" data-entrance=\"fadeIn\" data-hover=\"lift\" style=\"background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 20, 30, 0.8)); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 15px; padding: 1.5rem; text-align: center;\">\r\n                    <div class=\"stat-icon\" style=\"font-size: 2.5rem; margin-bottom: 0.5rem;\">ðŸª</div>\r\n                    <div class=\"stat-value\" style=\"font-size: 2rem; font-weight: bold; color: #f59e0b;\">${this.stats.gasGiants.toLocaleString()}</div>\r\n                    <div class=\"stat-label\" style=\"color: rgba(255, 255, 255, 0.7); margin-top: 0.5rem;\">Gas Giants</div>\r\n                </div>\r\n                \r\n                <div class=\"stat-card\" data-entrance=\"fadeIn\" data-hover=\"lift\" style=\"background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 20, 30, 0.8)); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 15px; padding: 1.5rem; text-align: center;\">\r\n                    <div class=\"stat-icon\" style=\"font-size: 2.5rem; margin-bottom: 0.5rem;\">ðŸ’«</div>\r\n                    <div class=\"stat-value\" style=\"font-size: 2rem; font-weight: bold; color: #a78bfa;\">${this.stats.superEarths.toLocaleString()}</div>\r\n                    <div class=\"stat-label\" style=\"color: rgba(255, 255, 255, 0.7); margin-top: 0.5rem;\">Super-Earths</div>\r\n                </div>\r\n                \r\n                <div class=\"stat-card\" data-entrance=\"fadeIn\" data-hover=\"lift\" style=\"background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 20, 30, 0.8)); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 15px; padding: 1.5rem; text-align: center;\">\r\n                    <div class=\"stat-icon\" style=\"font-size: 2.5rem; margin-bottom: 0.5rem;\">ðŸŸ¢</div>\r\n                    <div class=\"stat-value\" style=\"font-size: 2rem; font-weight: bold; color: #4ade80;\">${this.stats.available.toLocaleString()}</div>\r\n                    <div class=\"stat-label\" style=\"color: rgba(255, 255, 255, 0.7); margin-top: 0.5rem;\">Available to Claim</div>\r\n                </div>\r\n                \r\n                <div class=\"stat-card\" data-entrance=\"fadeIn\" data-hover=\"lift\" style=\"background: linear-gradient(135deg, rgba(0, 0, 0, 0.6), rgba(20, 20, 30, 0.8)); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 15px; padding: 1.5rem; text-align: center;\">\r\n                    <div class=\"stat-icon\" style=\"font-size: 2.5rem; margin-bottom: 0.5rem;\">ðŸ“</div>\r\n                    <div class=\"stat-value\" style=\"font-size: 2rem; font-weight: bold; color: #ba944f;\">${this.stats.avgRadius}x</div>\r\n                    <div class=\"stat-label\" style=\"color: rgba(255, 255, 255, 0.7); margin-top: 0.5rem;\">Avg Radius (Earth = 1)</div>\r\n                </div>\r\n            </div>\r\n            \r\n            <div class=\"stats-description\" style=\"text-align: center; margin: 2rem 0; padding: 1.5rem; background: rgba(186, 148, 79, 0.1); border-radius: 12px; border: 1px solid rgba(186, 148, 79, 0.2);\">\r\n                <p style=\"margin: 0; opacity: 0.9;\">\r\n                    <strong>Data Source:</strong> NASA Exoplanet Archive (Kepler Mission) | \r\n                    Average Distance: ${this.stats.avgDistance} light-years | \r\n                    Discovery Period: 2009-2018\r\n                </p>\r\n            </div>\r\n        `;\r\n    }\r\n\r\n    // Create search bar\r\n    createSearchBar() {\r\n        const container = document.getElementById('nasa-data-container');\r\n        if (!container) return;\r\n\r\n        const searchHTML = `\r\n            <div class=\"search-filter-container\" style=\"margin-bottom: 2rem;\">\r\n                <div class=\"search-box-wrapper\" style=\"position: relative; margin-bottom: 1.5rem;\">\r\n                    <input \r\n                        type=\"text\" \r\n                        id=\"planet-search\" \r\n                        class=\"search-input\" \r\n                        placeholder=\"ðŸ” Search by name, KOI, or Kepler ID...\" \r\n                        style=\"width: 100%; padding: 1rem 3rem 1rem 1.5rem; background: rgba(0, 0, 0, 0.7); border: 2px solid rgba(186, 148, 79, 0.5); border-radius: 15px; color: white; font-size: 1rem; transition: all 0.3s ease;\"\r\n                    />\r\n                    <div class=\"search-icon\" style=\"position: absolute; right: 1rem; top: 50%; transform: translateY(-50%); color: #ba944f; font-size: 1.2rem;\">\r\n                        ðŸ”Ž\r\n                    </div>\r\n                    <div id=\"search-count\" style=\"position: absolute; top: -1.5rem; right: 0; font-size: 0.9rem; color: rgba(255, 255, 255, 0.7);\"></div>\r\n                </div>\r\n                \r\n                <div id=\"filter-buttons\"></div>\r\n                <div id=\"results-container\"></div>\r\n                <div id=\"pagination-container\" style=\"margin-top: 2rem;\"></div>\r\n            </div>\r\n        `;\r\n        \r\n        container.innerHTML = searchHTML;\r\n\r\n        // Add event listener for search with debouncing\r\n        const searchInput = document.getElementById('planet-search');\r\n        if (searchInput) {\r\n            let searchTimeout;\r\n            searchInput.addEventListener('input', (e) => {\r\n                this.searchTerm = e.target.value.toLowerCase();\r\n                \r\n                // Debounce search to avoid excessive filtering\r\n                clearTimeout(searchTimeout);\r\n                searchTimeout = setTimeout(() => {\r\n                    this.applyFilters();\r\n                }, 300); // Wait 300ms after user stops typing\r\n            });\r\n        }\r\n    }\r\n\r\n    // Create filter buttons\r\n    createFilterButtons() {\r\n        const container = document.getElementById('filter-buttons');\r\n        if (!container) return;\r\n\r\n        container.innerHTML = `\r\n            <div class=\"filter-group\" style=\"display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1.5rem;\">\r\n                <div class=\"filter-section\" style=\"flex: 1; min-width: 200px;\">\r\n                    <label style=\"display: block; margin-bottom: 0.5rem; color: #ba944f; font-weight: 600;\">Status:</label>\r\n                    <select id=\"filter-status\" class=\"filter-select\" style=\"width: 100%; padding: 0.75rem; background: rgba(0, 0, 0, 0.7); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 10px; color: white;\">\r\n                        <option value=\"all\">All (${this.stats.total})</option>\r\n                        <option value=\"CONFIRMED\">Confirmed (${this.stats.confirmed})</option>\r\n                        <option value=\"CANDIDATE\">Candidates (${this.stats.candidates})</option>\r\n                    </select>\r\n                </div>\r\n                \r\n                <div class=\"filter-section\" style=\"flex: 1; min-width: 200px;\">\r\n                    <label style=\"display: block; margin-bottom: 0.5rem; color: #ba944f; font-weight: 600;\">Type:</label>\r\n                    <select id=\"filter-type\" class=\"filter-select\" style=\"width: 100%; padding: 0.75rem; background: rgba(0, 0, 0, 0.7); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 10px; color: white;\">\r\n                        <option value=\"all\">All Types</option>\r\n                        <option value=\"Earth-like\">Earth-like (${this.stats.earthLike})</option>\r\n                        <option value=\"Super-Earth\">Super-Earths (${this.stats.superEarths})</option>\r\n                        <option value=\"Gas Giant\">Gas Giants (${this.stats.gasGiants})</option>\r\n                        <option value=\"Mini-Neptune\">Mini-Neptunes (${this.stats.miniNeptunes})</option>\r\n                    </select>\r\n                </div>\r\n                \r\n                <div class=\"filter-section\" style=\"flex: 1; min-width: 200px;\">\r\n                    <label style=\"display: block; margin-bottom: 0.5rem; color: #ba944f; font-weight: 600;\">Availability:</label>\r\n                    <select id=\"filter-availability\" class=\"filter-select\" style=\"width: 100%; padding: 0.75rem; background: rgba(0, 0, 0, 0.7); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 10px; color: white;\">\r\n                        <option value=\"all\">All</option>\r\n                        <option value=\"available\">Available (${this.stats.available})</option>\r\n                        <option value=\"claimed\">Claimed (${this.stats.claimed})</option>\r\n                    </select>\r\n                </div>\r\n                \r\n                <div class=\"filter-section\" style=\"flex: 0; min-width: 120px; display: flex; align-items: flex-end;\">\r\n                    <button id=\"reset-filters\" class=\"cta-button\" data-hover=\"lift\" style=\"width: 100%; padding: 0.75rem; background: rgba(186, 148, 79, 0.2); border: 2px solid rgba(186, 148, 79, 0.5); border-radius: 10px; color: white; cursor: pointer; font-weight: 600;\">\r\n                        Reset\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        // Add event listeners with null checks\r\n        const filterStatus = document.getElementById('filter-status');\r\n        if (filterStatus) {\r\n            filterStatus.addEventListener('change', (e) => {\r\n                this.activeFilters.status = e.target.value;\r\n                this.applyFilters();\r\n            });\r\n        }\r\n\r\n        const filterType = document.getElementById('filter-type');\r\n        if (filterType) {\r\n            filterType.addEventListener('change', (e) => {\r\n                this.activeFilters.type = e.target.value;\r\n                this.applyFilters();\r\n            });\r\n        }\r\n\r\n        const filterAvailability = document.getElementById('filter-availability');\r\n        if (filterAvailability) {\r\n            filterAvailability.addEventListener('change', (e) => {\r\n                this.activeFilters.availability = e.target.value;\r\n                this.applyFilters();\r\n            });\r\n        }\r\n\r\n        const resetFiltersBtn = document.getElementById('reset-filters');\r\n        if (resetFiltersBtn) {\r\n            resetFiltersBtn.addEventListener('click', () => {\r\n                this.searchTerm = '';\r\n                this.activeFilters = { status: 'all', type: 'all', availability: 'all' };\r\n                const searchInput = document.getElementById('planet-search');\r\n                if (searchInput) searchInput.value = '';\r\n                if (filterStatus) filterStatus.value = 'all';\r\n                if (filterType) filterType.value = 'all';\r\n                if (filterAvailability) filterAvailability.value = 'all';\r\n                this.applyFilters();\r\n            });\r\n        }\r\n    }\r\n\r\n    // Apply all filters\r\n    applyFilters() {\r\n        // Always search in allData which contains all merged exoplanets\r\n        let dataToFilter = this.allData;\r\n\r\n        // Apply search filter if search term exists\r\n        if (this.searchTerm && this.searchTerm.length >= 2) {\r\n            const searchLower = this.searchTerm.toLowerCase();\r\n            dataToFilter = this.allData.filter(planet => {\r\n                // Search in all relevant fields\r\n                const matchesKepoi = planet.kepoi_name && planet.kepoi_name.toLowerCase().includes(searchLower);\r\n                const matchesKepler = planet.kepler_name && planet.kepler_name.toLowerCase().includes(searchLower);\r\n                const matchesKepid = planet.kepid && planet.kepid.toString().includes(this.searchTerm);\r\n                const matchesType = planet.type && planet.type.toLowerCase().includes(searchLower);\r\n                const matchesStatus = planet.status && planet.status.toLowerCase().includes(searchLower);\r\n                \r\n                return matchesKepoi || matchesKepler || matchesKepid || matchesType || matchesStatus;\r\n            });\r\n        }\r\n\r\n        // Apply other filters\r\n        this.filteredData = dataToFilter.filter(planet => {\r\n            // Status filter - handle 'CONFIRMED', 'Confirmed Planet', 'CANDIDATE', etc.\r\n            let matchesStatus = true;\r\n            if (this.activeFilters.status !== 'all') {\r\n                const planetStatus = planet.status || '';\r\n                const planetStatusUpper = planetStatus.toUpperCase();\r\n                const filterStatusUpper = this.activeFilters.status.toUpperCase();\r\n                \r\n                if (filterStatusUpper === 'CONFIRMED') {\r\n                    // Match \"CONFIRMED\", \"Confirmed Planet\", \"CONFIRMED PLANET\", etc.\r\n                    matchesStatus = planetStatusUpper.includes('CONFIRMED') || \r\n                                   planetStatusUpper === 'CONFIRMED PLANET' ||\r\n                                   planetStatus === 'Confirmed Planet';\r\n                } else if (filterStatusUpper === 'CANDIDATE') {\r\n                    // Match \"CANDIDATE\" - but exclude confirmed and false positives\r\n                    matchesStatus = (planetStatusUpper.includes('CANDIDATE') || planetStatus === 'CANDIDATE') &&\r\n                                   !planetStatusUpper.includes('CONFIRMED') &&\r\n                                   !planetStatusUpper.includes('FALSE');\r\n                } else {\r\n                    matchesStatus = planetStatusUpper.includes(filterStatusUpper);\r\n                }\r\n            }\r\n\r\n            // Type filter\r\n            const matchesType = this.activeFilters.type === 'all' || \r\n                planet.type === this.activeFilters.type;\r\n\r\n            // Availability filter\r\n            const matchesAvailability = this.activeFilters.availability === 'all' || \r\n                planet.availability === this.activeFilters.availability;\r\n\r\n            return matchesStatus && matchesType && matchesAvailability;\r\n        });\r\n\r\n        // Update search count\r\n        const searchCount = document.getElementById('search-count');\r\n        if (searchCount) {\r\n            searchCount.textContent = `${this.filteredData.length} result${this.filteredData.length !== 1 ? 's' : ''}`;\r\n        }\r\n\r\n        // Reset to first page\r\n        this.currentPage = 1;\r\n        this.renderPage();\r\n    }\r\n\r\n    // Render current page\r\n    renderPage() {\r\n        const container = document.getElementById('results-container');\r\n        if (!container) return;\r\n\r\n        const start = (this.currentPage - 1) * this.itemsPerPage;\r\n        const end = start + this.itemsPerPage;\r\n        const pageData = this.filteredData.slice(start, end);\r\n\r\n        if (pageData.length === 0) {\r\n            container.innerHTML = `\r\n                <div style=\"text-align: center; padding: 3rem; background: rgba(186, 148, 79, 0.1); border-radius: 15px; margin: 2rem 0;\">\r\n                    <div style=\"font-size: 4rem; margin-bottom: 1rem;\">ðŸ”­</div>\r\n                    <h3 style=\"color: #ba944f; margin-bottom: 0.5rem;\">No planets found</h3>\r\n                    <p style=\"opacity: 0.8;\">Try adjusting your search or filters</p>\r\n                </div>\r\n            `;\r\n            this.updatePaginationControls();\r\n            return;\r\n        }\r\n\r\n        // Create grid of planet cards\r\n        const cardsHTML = pageData.map((planet, index) => {\r\n            // Normalize status for display\r\n            const planetStatus = planet.status || '';\r\n            const statusUpper = planetStatus.toUpperCase();\r\n            let displayStatus = planetStatus;\r\n            \r\n            // Normalize status display\r\n            if (statusUpper.includes('CONFIRMED') || planetStatus === 'Confirmed Planet') {\r\n                displayStatus = 'CONFIRMED';\r\n            } else if (statusUpper.includes('CANDIDATE') || planetStatus === 'CANDIDATE') {\r\n                displayStatus = 'CANDIDATE';\r\n            } else if (statusUpper.includes('FALSE')) {\r\n                displayStatus = 'FALSE POSITIVE';\r\n            }\r\n            \r\n            // Check if planet is confirmed (handle both \"CONFIRMED\" and \"Confirmed Planet\")\r\n            const isConfirmed = statusUpper.includes('CONFIRMED') || planetStatus === 'Confirmed Planet';\r\n            // const isCandidate = (statusUpper.includes('CANDIDATE') || planetStatus === 'CANDIDATE') && \r\n            //                    !statusUpper.includes('CONFIRMED') && !statusUpper.includes('FALSE'); // Unused\r\n            \r\n            // Set status color: green for confirmed, blue for candidates, gray for false positives\r\n            let statusColor = '#60a5fa'; // Default blue for candidates\r\n            if (isConfirmed) {\r\n                statusColor = '#4ade80'; // Green for confirmed\r\n            } else if (statusUpper.includes('FALSE')) {\r\n                statusColor = '#9ca3af'; // Gray for false positives\r\n            }\r\n            \r\n            const availabilityIcon = planet.availability === 'available' ? 'ðŸŸ¢' : 'ðŸ”´';\r\n            const typeIcon = this.getPlanetIcon(planet.type);\r\n\r\n            return `\r\n                <div class=\"planet-card\" data-entrance=\"slideUp\" data-kepid=\"${planet.kepid}\" style=\"--card-index: ${index}; background: linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(20, 20, 30, 0.9)); border: 2px solid rgba(186, 148, 79, 0.3); border-radius: 15px; padding: 1.5rem; transition: none !important;\">\r\n                    <div style=\"display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;\">\r\n                        <div class=\"planet-icon\" style=\"font-size: 3rem;\">${typeIcon}</div>\r\n                        <div style=\"text-align: right;\">\r\n                            <span style=\"background: ${statusColor}; padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: bold; color: black;\">${displayStatus}</span>\r\n                            <div style=\"margin-top: 0.5rem; font-size: 1.2rem;\">${availabilityIcon}</div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <h3 style=\"color: #ba944f; margin: 0.5rem 0; font-size: 1.2rem;\">\r\n                        ${planet.kepler_name || planet.kepoi_name}\r\n                    </h3>\r\n                    \r\n                    <div style=\"font-size: 0.9rem; opacity: 0.7; margin-bottom: 1rem;\">\r\n                        ${planet.kepler_name ? `KOI: ${planet.kepoi_name}` : `Kepler ID: ${planet.kepid}`}\r\n                    </div>\r\n                    \r\n                    <div style=\"display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin: 1rem 0; font-size: 0.9rem;\">\r\n                        <div>\r\n                            <div style=\"opacity: 0.6;\">Type:</div>\r\n                            <div style=\"color: #ba944f; font-weight: 600;\">${planet.type}</div>\r\n                        </div>\r\n                        <div>\r\n                            <div style=\"opacity: 0.6;\">Radius:</div>\r\n                            <div style=\"color: #ba944f; font-weight: 600;\">${planet.radius.toFixed(2)}x ðŸŒ</div>\r\n                        </div>\r\n                        <div>\r\n                            <div style=\"opacity: 0.6;\">Mass:</div>\r\n                            <div style=\"color: #ba944f; font-weight: 600;\">${planet.mass.toFixed(2)}x ðŸŒ</div>\r\n                        </div>\r\n                        <div>\r\n                            <div style=\"opacity: 0.6;\">Distance:</div>\r\n                            <div style=\"color: #ba944f; font-weight: 600;\">${planet.distance.toFixed(0)} ly</div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div style=\"display: flex; gap: 0.5rem; margin-top: 1rem;\">\r\n                        <div style=\"flex: 1; text-align: center; padding: 0.5rem; background: rgba(186, 148, 79, 0.1); border-radius: 8px; font-size: 0.85rem;\">\r\n                            <div style=\"opacity: 0.6;\">Score</div>\r\n                            <div style=\"color: #ba944f; font-weight: bold;\">${(planet.score * 100).toFixed(0)}%</div>\r\n                        </div>\r\n                        <div style=\"flex: 1; text-align: center; padding: 0.5rem; background: rgba(186, 148, 79, 0.1); border-radius: 8px; font-size: 0.85rem;\">\r\n                            <div style=\"opacity: 0.6;\">Year</div>\r\n                            <div style=\"color: #ba944f; font-weight: bold;\">${planet.disc_year}</div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <button class=\"claim-button\" onclick=\"claimPlanet('${planet.kepid}')\" data-kepid=\"${planet.kepid}\" style=\"width: 100%; margin-top: 1rem; padding: 0.75rem; background: ${planet.availability === 'available' ? 'rgba(74, 222, 128, 0.2)' : 'rgba(239, 68, 68, 0.2)'}; border: 2px solid ${planet.availability === 'available' ? 'rgba(74, 222, 128, 0.5)' : 'rgba(239, 68, 68, 0.5)'}; border-radius: 10px; color: white; cursor: ${planet.availability === 'available' ? 'pointer' : 'not-allowed'}; font-weight: 600; transition: all 0.3s ease;\" ${planet.availability !== 'available' ? 'disabled' : ''}>\r\n                        ${planet.availability === 'available' ? 'ðŸš€ Claim This Planet' : 'ðŸ”’ Already Claimed'}\r\n                    </button>\r\n                </div>\r\n            `;\r\n        }).join('');\r\n\r\n        container.innerHTML = `\r\n            <div class=\"planets-grid\" style=\"display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 1.5rem; margin: 2rem 0;\">\r\n                ${cardsHTML}\r\n            </div>\r\n        `;\r\n\r\n        this.updatePaginationControls();\r\n        \r\n        // Scroll to top of results smoothly\r\n        container.scrollIntoView({ behavior: 'smooth', block: 'start' });\r\n    }\r\n\r\n    // Create pagination controls\r\n    createPaginationControls() {\r\n        // Container is created in renderPage\r\n    }\r\n\r\n    // Update pagination controls\r\n    updatePaginationControls() {\r\n        const container = document.getElementById('pagination-container');\r\n        if (!container) return;\r\n\r\n        const totalPages = Math.ceil(this.filteredData.length / this.itemsPerPage);\r\n        \r\n        if (totalPages <= 1) {\r\n            container.innerHTML = '';\r\n            return;\r\n        }\r\n\r\n        const start = (this.currentPage - 1) * this.itemsPerPage + 1;\r\n        const end = Math.min(this.currentPage * this.itemsPerPage, this.filteredData.length);\r\n\r\n        let pagesHTML = '';\r\n        const maxButtons = 7;\r\n        \r\n        if (totalPages <= maxButtons) {\r\n            // Show all pages\r\n            for (let i = 1; i <= totalPages; i++) {\r\n                pagesHTML += this.createPageButton(i);\r\n            }\r\n        } else {\r\n            // Show first page\r\n            pagesHTML += this.createPageButton(1);\r\n            \r\n            // Show ellipsis or pages around current\r\n            if (this.currentPage > 3) {\r\n                pagesHTML += '<span style=\"padding: 0.5rem 1rem; color: rgba(255, 255, 255, 0.5);\">...</span>';\r\n            }\r\n            \r\n            // Show pages around current\r\n            const startPage = Math.max(2, this.currentPage - 1);\r\n            const endPage = Math.min(totalPages - 1, this.currentPage + 1);\r\n            \r\n            for (let i = startPage; i <= endPage; i++) {\r\n                pagesHTML += this.createPageButton(i);\r\n            }\r\n            \r\n            // Show ellipsis or last page\r\n            if (this.currentPage < totalPages - 2) {\r\n                pagesHTML += '<span style=\"padding: 0.5rem 1rem; color: rgba(255, 255, 255, 0.5);\">...</span>';\r\n            }\r\n            \r\n            // Show last page\r\n            pagesHTML += this.createPageButton(totalPages);\r\n        }\r\n\r\n        container.innerHTML = `\r\n            <div style=\"display: flex; justify-content: center; align-items: center; gap: 1rem; flex-wrap: wrap; padding: 2rem; background: rgba(0, 0, 0, 0.5); border-radius: 15px; border: 2px solid rgba(186, 148, 79, 0.3);\">\r\n                <button id=\"prev-page\" ${this.currentPage === 1 ? 'disabled' : ''} class=\"pagination-button\" style=\"padding: 0.75rem 1.5rem; background: rgba(186, 148, 79, 0.2); border: 2px solid rgba(186, 148, 79, 0.5); border-radius: 10px; color: white; cursor: pointer; font-weight: 600; transition: all 0.3s ease;\" ${this.currentPage === 1 ? 'style=\"opacity: 0.5; cursor: not-allowed;\"' : ''}>\r\n                    â† Previous\r\n                </button>\r\n                \r\n                <div style=\"display: flex; gap: 0.5rem; flex-wrap: wrap; align-items: center;\">\r\n                    ${pagesHTML}\r\n                </div>\r\n                \r\n                <button id=\"next-page\" ${this.currentPage === totalPages ? 'disabled' : ''} class=\"pagination-button\" style=\"padding: 0.75rem 1.5rem; background: rgba(186, 148, 79, 0.2); border: 2px solid rgba(186, 148, 79, 0.5); border-radius: 10px; color: white; cursor: pointer; font-weight: 600; transition: all 0.3s ease;\" ${this.currentPage === totalPages ? 'style=\"opacity: 0.5; cursor: not-allowed;\"' : ''}>\r\n                    Next â†’\r\n                </button>\r\n                \r\n                <div style=\"width: 100%; text-align: center; margin-top: 1rem; opacity: 0.7; font-size: 0.9rem;\">\r\n                    Showing ${start}-${end} of ${this.filteredData.length} planets\r\n                </div>\r\n            </div>\r\n        `;\r\n\r\n        // Add event listeners\r\n        const prevButton = document.getElementById('prev-page');\r\n        const nextButton = document.getElementById('next-page');\r\n\r\n        if (prevButton && this.currentPage > 1) {\r\n            prevButton.addEventListener('click', () => {\r\n                this.currentPage--;\r\n                this.renderPage();\r\n            });\r\n        }\r\n\r\n        if (nextButton && this.currentPage < totalPages) {\r\n            nextButton.addEventListener('click', () => {\r\n                this.currentPage++;\r\n                this.renderPage();\r\n            });\r\n        }\r\n\r\n        // Add event listeners for page number buttons\r\n        document.querySelectorAll('.page-button').forEach(button => {\r\n            button.addEventListener('click', (e) => {\r\n                const page = parseInt(e.target.dataset.page, 10);\r\n                this.currentPage = page;\r\n                this.renderPage();\r\n            });\r\n        });\r\n    }\r\n\r\n    createPageButton(pageNum) {\r\n        const isActive = pageNum === this.currentPage;\r\n        return `\r\n            <button class=\"page-button\" data-page=\"${pageNum}\" style=\"padding: 0.5rem 1rem; background: ${isActive ? 'rgba(186, 148, 79, 0.5)' : 'rgba(186, 148, 79, 0.1)'}; border: 2px solid ${isActive ? '#ba944f' : 'rgba(186, 148, 79, 0.3)'}; border-radius: 8px; color: ${isActive ? '#ba944f' : 'white'}; cursor: pointer; font-weight: ${isActive ? 'bold' : 'normal'}; transition: all 0.3s ease; min-width: 40px;\">\r\n                ${pageNum}\r\n            </button>\r\n        `;\r\n    }\r\n\r\n    // Helper methods\r\n    estimateRadius(planet) {\r\n        const score = planet.score || 0.5;\r\n        return 0.5 + Math.random() * (score * 4); // 0.5-4.5 Earth radii\r\n    }\r\n\r\n    estimateMass(planet) {\r\n        const score = planet.score || 0.5;\r\n        return 0.3 + Math.random() * (score * 10); // 0.3-10.3 Earth masses\r\n    }\r\n\r\n    estimateDistance(kepid) {\r\n        return 100 + (kepid % 2000); // 100-2100 light-years\r\n    }\r\n\r\n    estimateDiscoveryYear(_planet) {\r\n        return 2009 + Math.floor(Math.random() * 9); // 2009-2018\r\n    }\r\n\r\n    classifyPlanet(radius) {\r\n        if (radius < 1.25) return 'Earth-like';\r\n        if (radius < 2.0) return 'Super-Earth';\r\n        if (radius < 6.0) return 'Mini-Neptune';\r\n        return 'Gas Giant';\r\n    }\r\n\r\n    getPlanetIcon(type) {\r\n        const icons = {\r\n            'Earth-like': 'ðŸŒ',\r\n            'Super-Earth': 'ðŸŒŽ',\r\n            'Mini-Neptune': 'ðŸ”µ',\r\n            'Gas Giant': 'ðŸª'\r\n        };\r\n        return icons[type] || 'ðŸŒ';\r\n    }\r\n\r\n    generateSampleData(count) {\r\n        // Fallback sample data generator\r\n        return Array.from({ length: count }, (_, i) => ({\r\n            kepid: 10000000 + i,\r\n            kepoi_name: `K${String(i + 1).padStart(5, '0')}.01`,\r\n            kepler_name: i < 30 ? `Kepler-${i + 1} b` : null,\r\n            status: i < 40 ? 'CONFIRMED' : 'CANDIDATE',\r\n            score: 0.5 + Math.random() * 0.5,\r\n            radius: 0.5 + Math.random() * 4,\r\n            mass: 0.3 + Math.random() * 10,\r\n            distance: 100 + Math.random() * 2000,\r\n            disc_year: 2009 + Math.floor(Math.random() * 10),\r\n            type: this.classifyPlanet(0.5 + Math.random() * 4),\r\n            availability: 'available' // All planets start as available\r\n        }));\r\n    }\r\n}\r\n\r\n// Global function for claim button\r\n// Claim planet function with login check\r\nasync function claimPlanet(kepid) {\r\n    // Check if user is logged in\r\n    if (typeof authManager === 'undefined' || !authManager.isAuthenticated()) {\r\n        // Store the kepid for after login\r\n        sessionStorage.setItem('pendingClaim', kepid);\r\n        \r\n        // Show login modal if available\r\n        if (typeof showModal === 'function') {\r\n            // Check if modal exists\r\n            const loginModal = document.getElementById('login-modal');\r\n            if (loginModal) {\r\n                showModal('login-modal');\r\n                return;\r\n            }\r\n        }\r\n        \r\n        // If modal not available, show confirm and redirect\r\n        if (confirm('ðŸš€ You need to be logged in to claim exoplanets!\\n\\nWould you like to login now?')) {\r\n            // Redirect to members page for login (which has the beautiful login container)\r\n            window.location.href = 'members.html?redirect=database&claim=' + kepid;\r\n        } else {\r\n            sessionStorage.removeItem('pendingClaim');\r\n        }\r\n        return;\r\n    }\r\n\r\n    // User is logged in, proceed with claim\r\n    console.log('ðŸš€ Claiming planet:', kepid);\r\n    \r\n    // Check if we're on GitLab Pages (no backend available)\r\n    // Also check if we're NOT on localhost/127.0.0.1\r\n    const hostname = window.location.hostname;\r\n    const isGitLabPages = hostname.includes('gitlab.io') || \r\n                         hostname.includes('gitlab-pages') ||\r\n                         (hostname !== 'localhost' && hostname !== '127.0.0.1' && !hostname.startsWith('192.168.') && !hostname.startsWith('10.'));\r\n    \r\n    console.log('ðŸŒ Hostname:', hostname, '| Is GitLab Pages:', isGitLabPages);\r\n    \r\n    if (isGitLabPages) {\r\n        // Use localStorage for claims on GitLab Pages\r\n        console.log('ðŸŒ GitLab Pages detected - Using localStorage for claims');\r\n        claimPlanetLocal(kepid);\r\n        return;\r\n    }\r\n    \r\n    // Try backend first (localhost only)\r\n    try {\r\n        console.log('ðŸ”Œ Attempting to claim via backend...');\r\n        \r\n        const controller = new AbortController();\r\n        const timeoutId = setTimeout(() => controller.abort(), 3000); // 3 second timeout (faster)\r\n        \r\n        const response = await fetch('http://localhost:3002/api/planets/claim', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json',\r\n                'Authorization': authManager.getHeaders ? authManager.getHeaders()['Authorization'] : `Bearer ${authManager.token || ''}`\r\n            },\r\n            body: JSON.stringify({ kepid: kepid }),\r\n            signal: controller.signal\r\n        });\r\n\r\n        clearTimeout(timeoutId);\r\n        \r\n        console.log('ðŸ“¥ Response received:', response.status);\r\n\r\n        if (response.ok) {\r\n            const data = await response.json();\r\n            \r\n            if (data.success) {\r\n                console.log('âœ… Planet claimed successfully via backend');\r\n                alert(`âœ… Successfully claimed exoplanet!\\n\\nPlanet: ${data.planet?.kepler_name || data.planet?.kepoi_name || `Kepler-${kepid}`}\\n\\nView your claimed planets in your dashboard.`);\r\n                \r\n                // Update the planet card to show as claimed\r\n                updatePlanetAvailability(kepid, 'claimed');\r\n                \r\n                // Save to localStorage as backup\r\n                saveClaimToLocalStorage(kepid, data.planet);\r\n                \r\n                // Refresh the page to update UI\r\n                setTimeout(() => {\r\n                    location.reload();\r\n                }, 1000);\r\n                return;\r\n            } else {\r\n                console.error('âœ— Backend returned success:false');\r\n                alert(`âŒ ${data.error || 'Failed to claim planet'}`);\r\n                return;\r\n            }\r\n        } else {\r\n            const errorData = await response.json().catch(() => ({ error: 'Unknown error' }));\r\n            console.error('âœ— Backend error:', response.status, errorData);\r\n            \r\n            // If backend fails, try localStorage as fallback\r\n            console.log('ðŸ”„ Falling back to localStorage...');\r\n            claimPlanetLocal(kepid);\r\n            return;\r\n        }\r\n    } catch (error) {\r\n        console.error('âœ— Error claiming planet:', error);\r\n        console.error('Error name:', error.name);\r\n        console.error('Error message:', error.message);\r\n        \r\n        // Always fallback to localStorage on any error\r\n        console.log('ðŸ”„ Error occurred, falling back to localStorage...');\r\n        claimPlanetLocal(kepid);\r\n        return;\r\n    }\r\n}\r\n\r\n// Claim planet using localStorage and Supabase (for GitLab Pages or backend fallback)\r\nasync function claimPlanetLocal(kepid) {\r\n    console.log('ðŸ’¾ Claiming planet using localStorage and Supabase:', kepid);\r\n    \r\n    try {\r\n        // Normalize kepid to number for comparison (do this first)\r\n        const searchKepid = typeof kepid === 'string' ? parseInt(kepid, 10) : Number(kepid);\r\n        console.log('ðŸ” Searching for planet with kepid:', searchKepid, '(original:', kepid, ', type:', typeof kepid, ')');\r\n        \r\n        // Get current user\r\n        const user = authManager.getCurrentUser();\r\n        if (!user) {\r\n            console.error('âŒ No user found');\r\n            alert('âŒ You must be logged in to claim planets.');\r\n            return;\r\n        }\r\n        console.log('âœ… User found:', user.email || user.username);\r\n        \r\n        // Check if already claimed (check Supabase first, then localStorage)\r\n        console.log('ðŸ” Checking if planet already claimed...');\r\n        const existingClaim = await checkIfPlanetClaimed(kepid, user);\r\n        if (existingClaim) {\r\n            console.log('âš ï¸ Planet already claimed by this user');\r\n            alert('âœ… You have already claimed this planet!');\r\n            updatePlanetAvailability(kepid, 'claimed');\r\n            return;\r\n        }\r\n        console.log('âœ… Planet not yet claimed, proceeding...');\r\n        \r\n        // Find planet data - try multiple sources\r\n        let planetData = null;\r\n        \r\n        // Try allData first\r\n        if (window.databaseInstance?.allData) {\r\n            console.log('ðŸ“Š Searching in allData (length:', window.databaseInstance.allData.length, ')');\r\n            planetData = window.databaseInstance.allData.find(p => {\r\n                // Handle both string and number kepid comparisons\r\n                const planetKepid = typeof p.kepid === 'string' ? parseInt(p.kepid, 10) : Number(p.kepid);\r\n                const matches = planetKepid === searchKepid;\r\n                if (matches) {\r\n                    console.log('âœ… Found planet in allData:', p);\r\n                }\r\n                return matches;\r\n            });\r\n        }\r\n        \r\n        // Try filteredData if not found\r\n        if (!planetData && window.databaseInstance?.filteredData) {\r\n            console.log('ðŸ“Š Searching in filteredData (length:', window.databaseInstance.filteredData.length, ')');\r\n            planetData = window.databaseInstance.filteredData.find(p => {\r\n                const planetKepid = typeof p.kepid === 'string' ? parseInt(p.kepid, 10) : Number(p.kepid);\r\n                const matches = planetKepid === searchKepid;\r\n                if (matches) {\r\n                    console.log('âœ… Found planet in filteredData:', p);\r\n                }\r\n                return matches;\r\n            });\r\n        }\r\n        \r\n        // Try searching by string comparison as well (in case of exact string match)\r\n        if (!planetData && window.databaseInstance?.allData) {\r\n            planetData = window.databaseInstance.allData.find(p => {\r\n                return String(p.kepid) === String(kepid) || p.kepid === kepid;\r\n            });\r\n            if (planetData) {\r\n                console.log('âœ… Found planet by string comparison:', planetData);\r\n            }\r\n        }\r\n        \r\n        // If still not found, try to get from the clicked button's data attributes\r\n        if (!planetData) {\r\n            const claimButton = document.querySelector(`[data-kepid=\"${kepid}\"]`);\r\n            if (claimButton) {\r\n                const planetCard = claimButton.closest('.planet-card');\r\n                if (planetCard) {\r\n                    // Try to extract planet data from the card's data attributes or text\r\n                    const planetName = planetCard.querySelector('.planet-name')?.textContent || \r\n                                     planetCard.querySelector('h3')?.textContent || \r\n                                     `Kepler-${kepid}`;\r\n                    const planetType = planetCard.querySelector('.planet-type')?.textContent || 'Unknown';\r\n                    const planetRadius = planetCard.querySelector('.planet-radius')?.textContent || 'Unknown';\r\n                    \r\n                    // Create minimal planet data from available info\r\n                    planetData = {\r\n                        kepid: typeof kepid === 'string' ? parseInt(kepid, 10) : kepid,\r\n                        kepler_name: planetName.includes('Kepler') ? planetName : null,\r\n                        kepoi_name: planetName.includes('K') && planetName.includes('.') ? planetName : null,\r\n                        type: planetType,\r\n                        radius: parseFloat(planetRadius) || 1.0,\r\n                        mass: 1.0,\r\n                        distance: 1000,\r\n                        status: 'CONFIRMED'\r\n                    };\r\n                    console.log('âš ï¸ Planet data not in database, using extracted data:', planetData);\r\n                }\r\n            }\r\n        }\r\n        \r\n        if (!planetData) {\r\n            // Get sample kepids for debugging\r\n            const sampleKepids = window.databaseInstance?.allData?.slice(0, 10).map(p => ({ \r\n                kepid: p.kepid, \r\n                type: typeof p.kepid,\r\n                kepler_name: p.kepler_name || p.kepoi_name\r\n            })) || [];\r\n            \r\n            console.warn('âš ï¸ Planet not found in database, creating fallback data:', {\r\n                searchKepid: searchKepid,\r\n                originalKepid: kepid,\r\n                kepidType: typeof kepid,\r\n                allDataLength: window.databaseInstance?.allData?.length || 0,\r\n                filteredDataLength: window.databaseInstance?.filteredData?.length || 0,\r\n                databaseInstanceExists: !!window.databaseInstance,\r\n                sampleKepids: sampleKepids\r\n            });\r\n            \r\n            // Always create a minimal claim if we have the kepid - don't fail!\r\n            console.log('ðŸ“ Creating claim with minimal data since planet not in database');\r\n            planetData = {\r\n                kepid: searchKepid,\r\n                kepler_name: null,\r\n                kepoi_name: `KOI-${searchKepid}`,\r\n                type: 'Unknown',\r\n                radius: 1.0,\r\n                mass: 1.0,\r\n                distance: 1000,\r\n                status: 'CONFIRMED'\r\n            };\r\n            console.log('âœ… Using fallback planet data:', planetData);\r\n        }\r\n        \r\n        // Create new claim\r\n        const newClaim = {\r\n            id: `claim-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n            userId: user.id,\r\n            username: user.username || user.email?.split('@')[0],\r\n            email: user.email,\r\n            kepid: kepid,\r\n            planet: {\r\n                kepler_name: planetData.kepler_name,\r\n                kepoi_name: planetData.kepoi_name,\r\n                type: planetData.type,\r\n                radius: planetData.radius,\r\n                mass: planetData.mass,\r\n                distance: planetData.distance,\r\n                status: planetData.status\r\n            },\r\n            status: 'active',\r\n            claimedAt: new Date().toISOString(),\r\n            certificate: {\r\n                number: `CERT-${Date.now()}`,\r\n                issued: new Date().toISOString()\r\n            }\r\n        };\r\n        \r\n        // Try to save to Supabase first\r\n        let savedToSupabase = false;\r\n        if (authManager.useSupabase && authManager.supabase) {\r\n            try {\r\n                console.log('â˜ï¸ Saving claim to Supabase...');\r\n                const { data, error } = await authManager.supabase\r\n                    .from('planet_claims')\r\n                    .insert([{\r\n                        user_id: user.id,\r\n                        username: newClaim.username,\r\n                        email: user.email,\r\n                        kepid: kepid,\r\n                        planet_data: newClaim.planet,\r\n                        status: 'active',\r\n                        claimed_at: newClaim.claimedAt,\r\n                        certificate_number: newClaim.certificate.number\r\n                    }])\r\n                    .select();\r\n                \r\n                if (error) {\r\n                    console.error('âœ— Supabase insert error:', error);\r\n                    // Continue to localStorage fallback\r\n                } else {\r\n                    console.log('âœ… Claim saved to Supabase:', data);\r\n                    savedToSupabase = true;\r\n                }\r\n            } catch (supabaseError) {\r\n                console.error('âœ— Supabase error:', supabaseError);\r\n                // Continue to localStorage fallback\r\n            }\r\n        }\r\n        \r\n        // Always save to localStorage as backup\r\n        const existingClaims = JSON.parse(localStorage.getItem('user_claims') || '[]');\r\n        existingClaims.push(newClaim);\r\n        localStorage.setItem('user_claims', JSON.stringify(existingClaims));\r\n        console.log('ðŸ’¾ Claim saved to localStorage');\r\n        \r\n        if (savedToSupabase) {\r\n            console.log('âœ… Planet claimed and saved to Supabase + localStorage');\r\n        } else {\r\n            console.log('âœ… Planet claimed and saved to localStorage (Supabase unavailable)');\r\n        }\r\n        \r\n        alert(`âœ… Successfully claimed exoplanet!\\n\\nPlanet: ${planetData.kepler_name || planetData.kepoi_name}\\n\\nView your claimed planets in your dashboard.`);\r\n        \r\n        // Update the planet card to show as claimed\r\n        updatePlanetAvailability(kepid, 'claimed');\r\n        \r\n        // Update database instance\r\n        if (window.databaseInstance) {\r\n            const planet = window.databaseInstance.allData.find(p => p.kepid === kepid);\r\n            if (planet) {\r\n                planet.availability = 'claimed';\r\n            }\r\n        }\r\n        \r\n        // Refresh the page to update UI\r\n        setTimeout(() => {\r\n            location.reload();\r\n        }, 1000);\r\n        \r\n    } catch (error) {\r\n        console.error('âœ— Error claiming planet locally:', error);\r\n        alert('âŒ Error claiming planet. Please try again later.');\r\n    }\r\n}\r\n\r\n// Check if planet is already claimed (check Supabase and localStorage)\r\nasync function checkIfPlanetClaimed(kepid, user) {\r\n    // Check Supabase first\r\n    if (authManager.useSupabase && authManager.supabase) {\r\n        try {\r\n            const { data, error } = await authManager.supabase\r\n                .from('planet_claims')\r\n                .select('*')\r\n                .eq('kepid', kepid)\r\n                .eq('user_id', user.id)\r\n                .eq('status', 'active')\r\n                .limit(1);\r\n            \r\n            if (!error && data && data.length > 0) {\r\n                console.log('âœ“ Found claim in Supabase');\r\n                return data[0];\r\n            }\r\n        } catch (error) {\r\n            console.error('Error checking Supabase:', error);\r\n        }\r\n    }\r\n    \r\n    // Fallback to localStorage\r\n    const existingClaims = JSON.parse(localStorage.getItem('user_claims') || '[]');\r\n    const existingClaim = existingClaims.find(c => {\r\n        if (c.kepid !== kepid) return false;\r\n        const matchesUserId = c.userId && user.id && c.userId === user.id;\r\n        const matchesUsername = c.username && user.username && c.username.toLowerCase() === user.username.toLowerCase();\r\n        const matchesEmail = c.email && user.email && c.email.toLowerCase() === user.email.toLowerCase();\r\n        return matchesUserId || matchesUsername || matchesEmail;\r\n    });\r\n    \r\n    return existingClaim || null;\r\n}\r\n\r\n// Save claim to localStorage as backup\r\nfunction saveClaimToLocalStorage(kepid, planetData) {\r\n    try {\r\n        const user = authManager.getCurrentUser();\r\n        if (!user) return;\r\n        \r\n        const existingClaims = JSON.parse(localStorage.getItem('user_claims') || '[]');\r\n        const existingClaim = existingClaims.find(c => c.kepid === kepid && c.userId === user.id);\r\n        \r\n        if (!existingClaim) {\r\n            const newClaim = {\r\n                id: `claim-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n                userId: user.id,\r\n                username: user.username || user.email?.split('@')[0],\r\n                kepid: kepid,\r\n                planet: planetData,\r\n                status: 'active',\r\n                claimedAt: new Date().toISOString()\r\n            };\r\n            \r\n            existingClaims.push(newClaim);\r\n            localStorage.setItem('user_claims', JSON.stringify(existingClaims));\r\n            console.log('ðŸ’¾ Claim saved to localStorage as backup');\r\n        }\r\n    } catch (error) {\r\n        console.error('Error saving claim to localStorage:', error);\r\n    }\r\n}\r\n\r\n// Update planet availability in UI\r\nfunction updatePlanetAvailability(kepid, status) {\r\n    const planetCard = document.querySelector(`[data-kepid=\"${kepid}\"]`);\r\n    if (planetCard) {\r\n        const claimBtn = planetCard.querySelector('.claim-button');\r\n        if (claimBtn) {\r\n            if (status === 'claimed') {\r\n                claimBtn.textContent = 'ðŸ”’ Already Claimed';\r\n                claimBtn.disabled = true;\r\n                claimBtn.style.background = 'rgba(239, 68, 68, 0.2)';\r\n                claimBtn.style.borderColor = 'rgba(239, 68, 68, 0.5)';\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// Wait for both DOM and Kepler data to be ready\r\nfunction initDatabase() {\r\n    // Check if data is loaded\r\n    if (typeof KEPLER_DATABASE === 'undefined') {\r\n        console.log('â³ Waiting for Kepler database to load...');\r\n        setTimeout(initDatabase, 100);\r\n        return;\r\n    }\r\n    \r\n    console.log('âœ¨ Initializing Optimized Database System...');\r\n    const database = new OptimizedDatabase();\r\n    // Make database instance globally available for claim functions\r\n    window.databaseInstance = database;\r\n    console.log('âœ… Database ready with', KEPLER_DATABASE.stats.total, 'planets!');\r\n}\r\n\r\n// Start initialization when DOM is ready\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', initDatabase);\r\n} else {\r\n    initDatabase();\r\n}\r\n\r\n// Add pulse animation style\r\nif (!document.querySelector('#pulse-style')) {\r\n    const style = document.createElement('style');\r\n    style.id = 'pulse-style';\r\n    style.textContent = `\r\n        @keyframes pulse {\r\n            0%, 100% { transform: scale(1); opacity: 1; }\r\n            50% { transform: scale(1.1); opacity: 0.8; }\r\n        }\r\n    `;\r\n    document.head.appendChild(style);\r\n}\r\n\r\n// Make claimPlanet explicitly global for onclick handlers\r\nwindow.claimPlanet = claimPlanet;\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\download-new-music.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\extract-wix-graph.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\file-storage.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'FileStorageManager' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":25,"suggestions":[{"messageId":"removeVar","data":{"varName":"FileStorageManager"},"fix":{"range":[99,21456],"text":""},"desc":"Remove unused variable 'FileStorageManager'."}]},{"ruleId":"no-unmodified-loop-condition","severity":1,"message":"'authManager' is not modified in this loop.","line":24,"column":23,"nodeType":"Identifier","messageId":"loopConditionNotModified","endLine":24,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * File Storage Manager\r\n * Provides 1GB free storage per user using Supabase Storage\r\n */\r\n\r\nclass FileStorageManager {\r\n    constructor() {\r\n        this.storageLimit = 1 * 1024 * 1024 * 1024; // 1GB in bytes\r\n        this.maxFileSize = 100 * 1024 * 1024; // 100MB per file\r\n        this.files = [];\r\n        this.currentStorageUsed = 0;\r\n        this.supabase = null;\r\n        this.userId = null;\r\n        this.bucketName = 'user-files';\r\n        \r\n        this.init();\r\n    }\r\n    \r\n    async init() {\r\n        console.log('ðŸ“ Initializing File Storage Manager...');\r\n        \r\n        // Wait for auth manager to be ready (similar to dashboard.html)\r\n        let attempts = 0;\r\n        while (typeof authManager === 'undefined' && attempts < 50) {\r\n            await new Promise(resolve => setTimeout(resolve, 100));\r\n            attempts++;\r\n        }\r\n        \r\n        if (typeof authManager === 'undefined') {\r\n            console.error('âŒ Auth manager not available');\r\n            this.showLoginRequired();\r\n            return;\r\n        }\r\n        \r\n        // Wait a bit more for auth manager to fully initialize\r\n        await new Promise(resolve => setTimeout(resolve, 300));\r\n        \r\n        // Check authentication - use both getCurrentUser and isAuthenticated\r\n        const user = authManager.getCurrentUser();\r\n        const isAuthenticated = authManager.isAuthenticated && authManager.isAuthenticated();\r\n        \r\n        console.log('ðŸ” Auth check:', { user: !!user, isAuthenticated, userId: user?.id });\r\n        \r\n        if (!user || !isAuthenticated) {\r\n            console.log('âš ï¸ User not authenticated, showing login required');\r\n            this.showLoginRequired();\r\n            return;\r\n        }\r\n        \r\n        this.userId = user.id;\r\n        console.log('âœ… User authenticated:', this.userId);\r\n        \r\n        // Initialize Supabase\r\n        if (authManager.useSupabase && authManager.supabase) {\r\n            this.supabase = authManager.supabase;\r\n            console.log('âœ… Supabase available');\r\n            await this.setupStorage();\r\n            this.showStorageDashboard();\r\n            await this.loadFiles();\r\n        } else {\r\n            console.warn('âš ï¸ Supabase not available');\r\n            this.showError('Supabase is not configured. Please check your configuration.');\r\n        }\r\n    }\r\n    \r\n    async setupStorage() {\r\n        try {\r\n            // Check if bucket exists, create if not\r\n            const { data: buckets, error: listError } = await this.supabase.storage.listBuckets();\r\n            \r\n            if (listError) {\r\n                console.error('Error listing buckets:', listError);\r\n                return;\r\n            }\r\n            \r\n            const bucketExists = buckets.some(b => b.name === this.bucketName);\r\n            \r\n            if (!bucketExists) {\r\n                // Note: Bucket creation requires admin privileges\r\n                // In production, create bucket via Supabase dashboard or admin API\r\n                console.log('âš ï¸ Bucket does not exist. Please create it in Supabase dashboard.');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error setting up storage:', error);\r\n        }\r\n    }\r\n    \r\n    showLoginRequired() {\r\n        const loginView = document.getElementById('login-required-view');\r\n        const dashboard = document.getElementById('storage-dashboard');\r\n        \r\n        if (loginView) loginView.style.display = 'block';\r\n        if (dashboard) dashboard.style.display = 'none';\r\n        \r\n        // Login button is handled by onclick in HTML (showModal)\r\n    }\r\n    \r\n    showStorageDashboard() {\r\n        const loginView = document.getElementById('login-required-view');\r\n        const dashboard = document.getElementById('storage-dashboard');\r\n        \r\n        if (loginView) loginView.style.display = 'none';\r\n        if (dashboard) dashboard.style.display = 'block';\r\n        \r\n        this.setupUploadArea();\r\n        this.setupFileList();\r\n    }\r\n    \r\n    setupUploadArea() {\r\n        const uploadArea = document.getElementById('upload-area');\r\n        const fileInput = document.getElementById('file-input');\r\n        const browseBtn = document.getElementById('browse-btn');\r\n        \r\n        if (!uploadArea || !fileInput || !browseBtn) return;\r\n        \r\n        // Click to browse\r\n        browseBtn.addEventListener('click', () => {\r\n            fileInput.click();\r\n        });\r\n        \r\n        uploadArea.addEventListener('click', () => {\r\n            fileInput.click();\r\n        });\r\n        \r\n        // Drag and drop\r\n        uploadArea.addEventListener('dragover', (e) => {\r\n            e.preventDefault();\r\n            uploadArea.classList.add('drag-over');\r\n        });\r\n        \r\n        uploadArea.addEventListener('dragleave', () => {\r\n            uploadArea.classList.remove('drag-over');\r\n        });\r\n        \r\n        uploadArea.addEventListener('drop', (e) => {\r\n            e.preventDefault();\r\n            uploadArea.classList.remove('drag-over');\r\n            \r\n            const files = Array.from(e.dataTransfer.files);\r\n            this.handleFiles(files);\r\n        });\r\n        \r\n        // File input change\r\n        fileInput.addEventListener('change', (e) => {\r\n            const files = Array.from(e.target.files);\r\n            this.handleFiles(files);\r\n            fileInput.value = ''; // Reset input\r\n        });\r\n    }\r\n    \r\n    async handleFiles(files) {\r\n        if (!files || files.length === 0) return;\r\n        \r\n        // Validate files\r\n        const validFiles = [];\r\n        for (const file of files) {\r\n            if (file.size > this.maxFileSize) {\r\n                alert(`File \"${file.name}\" is too large. Maximum size is 100MB.`);\r\n                continue;\r\n            }\r\n            \r\n            if (this.currentStorageUsed + file.size > this.storageLimit) {\r\n                alert(`Not enough storage space. You have ${this.formatBytes(this.storageLimit - this.currentStorageUsed)} remaining.`);\r\n                continue;\r\n            }\r\n            \r\n            validFiles.push(file);\r\n        }\r\n        \r\n        if (validFiles.length === 0) return;\r\n        \r\n        // Show upload progress\r\n        this.showUploadProgress(validFiles);\r\n        \r\n        // Upload files\r\n        for (const file of validFiles) {\r\n            await this.uploadFile(file);\r\n        }\r\n        \r\n        // Reload file list\r\n        await this.loadFiles();\r\n    }\r\n    \r\n    async uploadFile(file) {\r\n        const filePath = `${this.userId}/${Date.now()}_${file.name}`;\r\n        const progressId = `progress-${file.name}`;\r\n        \r\n        try {\r\n            // Update progress\r\n            this.updateUploadProgress(progressId, 0, 'Uploading...');\r\n            \r\n            // Upload to Supabase Storage\r\n            const { data, error } = await this.supabase.storage\r\n                .from(this.bucketName)\r\n                .upload(filePath, file, {\r\n                    cacheControl: '3600',\r\n                    upsert: false\r\n                });\r\n            \r\n            if (error) {\r\n                throw error;\r\n            }\r\n            \r\n            // Update progress\r\n            this.updateUploadProgress(progressId, 100, 'Uploaded!');\r\n            \r\n            // Get file metadata\r\n            const { data: _fileData } = await this.supabase.storage\r\n                .from(this.bucketName)\r\n                .list(this.userId, {\r\n                    search: file.name\r\n                });\r\n            \r\n            console.log('âœ… File uploaded:', file.name);\r\n            \r\n            // Update storage used\r\n            this.currentStorageUsed += file.size;\r\n            this.updateStorageStats();\r\n            \r\n            return data;\r\n        } catch (error) {\r\n            console.error('Error uploading file:', error);\r\n            this.updateUploadProgress(progressId, 0, `Error: ${error.message}`);\r\n            alert(`Failed to upload \"${file.name}\": ${error.message}`);\r\n        }\r\n    }\r\n    \r\n    showUploadProgress(files) {\r\n        const progressContainer = document.getElementById('upload-progress');\r\n        if (!progressContainer) return;\r\n        \r\n        progressContainer.style.display = 'block';\r\n        progressContainer.innerHTML = '';\r\n        \r\n        files.forEach(file => {\r\n            const progressItem = document.createElement('div');\r\n            progressItem.className = 'progress-item';\r\n            progressItem.id = `progress-${file.name}`;\r\n            progressItem.innerHTML = `\r\n                <div class=\"progress-file-info\">\r\n                    <span class=\"progress-file-name\">${this.escapeHtml(file.name)}</span>\r\n                    <span class=\"progress-file-size\">${this.formatBytes(file.size)}</span>\r\n                </div>\r\n                <div class=\"progress-bar-small\">\r\n                    <div class=\"progress-fill-small\" style=\"width: 0%\"></div>\r\n                </div>\r\n                <div class=\"progress-status\">Waiting...</div>\r\n            `;\r\n            progressContainer.appendChild(progressItem);\r\n        });\r\n    }\r\n    \r\n    updateUploadProgress(progressId, percent, status) {\r\n        const progressItem = document.getElementById(progressId);\r\n        if (!progressItem) return;\r\n        \r\n        const fill = progressItem.querySelector('.progress-fill-small');\r\n        const statusEl = progressItem.querySelector('.progress-status');\r\n        \r\n        if (fill) fill.style.width = `${percent}%`;\r\n        if (statusEl) statusEl.textContent = status;\r\n        \r\n        if (percent === 100) {\r\n            setTimeout(() => {\r\n                progressItem.style.opacity = '0';\r\n                setTimeout(() => {\r\n                    if (progressItem.parentNode) {\r\n                        progressItem.parentNode.removeChild(progressItem);\r\n                    }\r\n                }, 300);\r\n            }, 2000);\r\n        }\r\n    }\r\n    \r\n    async loadFiles() {\r\n        const filesList = document.getElementById('files-list');\r\n        if (!filesList) return;\r\n        \r\n        filesList.innerHTML = '<div class=\"loading-state\"><div class=\"loading-spinner\"></div><p>Loading files...</p></div>';\r\n        \r\n        try {\r\n            // List files for this user\r\n            const { data: files, error } = await this.supabase.storage\r\n                .from(this.bucketName)\r\n                .list(this.userId, {\r\n                    limit: 100,\r\n                    offset: 0,\r\n                    sortBy: { column: 'created_at', order: 'desc' }\r\n                });\r\n            \r\n            if (error) {\r\n                throw error;\r\n            }\r\n            \r\n            this.files = files || [];\r\n            this.calculateStorageUsed();\r\n            this.renderFiles();\r\n            this.updateStorageStats();\r\n        } catch (error) {\r\n            console.error('Error loading files:', error);\r\n            filesList.innerHTML = `\r\n                <div class=\"error-state\">\r\n                    <p>âŒ Error loading files: ${error.message}</p>\r\n                    <button onclick=\"location.reload()\" class=\"retry-button\">Retry</button>\r\n                </div>\r\n            `;\r\n        }\r\n    }\r\n    \r\n    async calculateStorageUsed() {\r\n        let totalSize = 0;\r\n        \r\n        for (const file of this.files) {\r\n            // Get file metadata to get actual size\r\n            const { data } = await this.supabase.storage\r\n                .from(this.bucketName)\r\n                .list(this.userId, {\r\n                    search: file.name\r\n                });\r\n            \r\n            if (data && data[0] && data[0].metadata) {\r\n                totalSize += data[0].metadata.size || 0;\r\n            } else {\r\n                // Fallback: estimate from file name or use metadata\r\n                totalSize += file.metadata?.size || 0;\r\n            }\r\n        }\r\n        \r\n        this.currentStorageUsed = totalSize;\r\n    }\r\n    \r\n    renderFiles() {\r\n        const filesList = document.getElementById('files-list');\r\n        if (!filesList) return;\r\n        \r\n        if (this.files.length === 0) {\r\n            filesList.innerHTML = `\r\n                <div class=\"empty-state\">\r\n                    <div class=\"empty-icon\">ðŸ“</div>\r\n                    <h3>No files yet</h3>\r\n                    <p>Upload your first file to get started!</p>\r\n                </div>\r\n            `;\r\n            return;\r\n        }\r\n        \r\n        // Apply search filter\r\n        const searchTerm = document.getElementById('search-files')?.value.toLowerCase() || '';\r\n        let filteredFiles = this.files.filter(file => \r\n            file.name.toLowerCase().includes(searchTerm)\r\n        );\r\n        \r\n        // Apply sort\r\n        const sortValue = document.getElementById('sort-files')?.value || 'date-desc';\r\n        filteredFiles = this.sortFiles(filteredFiles, sortValue);\r\n        \r\n        filesList.innerHTML = filteredFiles.map(file => this.createFileCard(file)).join('');\r\n        \r\n        // Add event listeners\r\n        this.attachFileListeners();\r\n    }\r\n    \r\n    sortFiles(files, sortBy) {\r\n        const sorted = [...files];\r\n        \r\n        switch (sortBy) {\r\n            case 'name-asc':\r\n                return sorted.sort((a, b) => a.name.localeCompare(b.name));\r\n            case 'name-desc':\r\n                return sorted.sort((a, b) => b.name.localeCompare(a.name));\r\n            case 'date-desc':\r\n                return sorted.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));\r\n            case 'date-asc':\r\n                return sorted.sort((a, b) => new Date(a.created_at) - new Date(b.created_at));\r\n            case 'size-desc':\r\n                return sorted.sort((a, b) => (b.metadata?.size || 0) - (a.metadata?.size || 0));\r\n            case 'size-asc':\r\n                return sorted.sort((a, b) => (a.metadata?.size || 0) - (b.metadata?.size || 0));\r\n            default:\r\n                return sorted;\r\n        }\r\n    }\r\n    \r\n    createFileCard(file) {\r\n        const fileSize = file.metadata?.size || 0;\r\n        const fileName = this.escapeHtml(file.name);\r\n        const fileDate = new Date(file.created_at).toLocaleDateString();\r\n        const filePath = `${this.userId}/${file.name}`;\r\n        \r\n        return `\r\n            <div class=\"file-card\" data-file-name=\"${this.escapeHtml(file.name)}\">\r\n                <div class=\"file-icon\">${this.getFileIcon(file.name)}</div>\r\n                <div class=\"file-info\">\r\n                    <div class=\"file-name\" title=\"${fileName}\">${fileName}</div>\r\n                    <div class=\"file-meta\">\r\n                        <span class=\"file-size\">${this.formatBytes(fileSize)}</span>\r\n                        <span class=\"file-date\">${fileDate}</span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"file-actions\">\r\n                    <button class=\"action-btn download-btn\" data-path=\"${this.escapeHtml(filePath)}\" title=\"Download\">\r\n                        â¬‡ï¸\r\n                    </button>\r\n                    <button class=\"action-btn delete-btn\" data-path=\"${this.escapeHtml(filePath)}\" title=\"Delete\">\r\n                        ðŸ—‘ï¸\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n    \r\n    getFileIcon(fileName) {\r\n        const ext = fileName.split('.').pop()?.toLowerCase();\r\n        const icons = {\r\n            'pdf': 'ðŸ“„',\r\n            'doc': 'ðŸ“', 'docx': 'ðŸ“',\r\n            'xls': 'ðŸ“Š', 'xlsx': 'ðŸ“Š',\r\n            'jpg': 'ðŸ–¼ï¸', 'jpeg': 'ðŸ–¼ï¸', 'png': 'ðŸ–¼ï¸', 'gif': 'ðŸ–¼ï¸', 'webp': 'ðŸ–¼ï¸',\r\n            'mp4': 'ðŸŽ¥', 'avi': 'ðŸŽ¥', 'mov': 'ðŸŽ¥',\r\n            'mp3': 'ðŸŽµ', 'wav': 'ðŸŽµ', 'ogg': 'ðŸŽµ',\r\n            'zip': 'ðŸ“¦', 'rar': 'ðŸ“¦', '7z': 'ðŸ“¦',\r\n            'txt': 'ðŸ“ƒ', 'md': 'ðŸ“ƒ',\r\n            'html': 'ðŸŒ', 'css': 'ðŸŽ¨', 'js': 'âš™ï¸'\r\n        };\r\n        return icons[ext] || 'ðŸ“';\r\n    }\r\n    \r\n    attachFileListeners() {\r\n        // Download buttons\r\n        document.querySelectorAll('.download-btn').forEach(btn => {\r\n            btn.addEventListener('click', async (e) => {\r\n                const filePath = e.target.getAttribute('data-path');\r\n                await this.downloadFile(filePath);\r\n            });\r\n        });\r\n        \r\n        // Delete buttons\r\n        document.querySelectorAll('.delete-btn').forEach(btn => {\r\n            btn.addEventListener('click', async (e) => {\r\n                const filePath = e.target.getAttribute('data-path');\r\n                await this.deleteFile(filePath);\r\n            });\r\n        });\r\n    }\r\n    \r\n    async downloadFile(filePath) {\r\n        try {\r\n            const { data, error } = await this.supabase.storage\r\n                .from(this.bucketName)\r\n                .download(filePath);\r\n            \r\n            if (error) {\r\n                throw error;\r\n            }\r\n            \r\n            // Create download link\r\n            const url = URL.createObjectURL(data);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            a.download = filePath.split('/').pop();\r\n            document.body.appendChild(a);\r\n            a.click();\r\n            document.body.removeChild(a);\r\n            URL.revokeObjectURL(url);\r\n            \r\n            console.log('âœ… File downloaded:', filePath);\r\n        } catch (error) {\r\n            console.error('Error downloading file:', error);\r\n            alert(`Failed to download file: ${error.message}`);\r\n        }\r\n    }\r\n    \r\n    async deleteFile(filePath) {\r\n        if (!confirm('Are you sure you want to delete this file?')) {\r\n            return;\r\n        }\r\n        \r\n        try {\r\n            const { error } = await this.supabase.storage\r\n                .from(this.bucketName)\r\n                .remove([filePath]);\r\n            \r\n            if (error) {\r\n                throw error;\r\n            }\r\n            \r\n            console.log('âœ… File deleted:', filePath);\r\n            \r\n            // Reload files\r\n            await this.loadFiles();\r\n        } catch (error) {\r\n            console.error('Error deleting file:', error);\r\n            alert(`Failed to delete file: ${error.message}`);\r\n        }\r\n    }\r\n    \r\n    setupFileList() {\r\n        const searchInput = document.getElementById('search-files');\r\n        const sortSelect = document.getElementById('sort-files');\r\n        \r\n        if (searchInput) {\r\n            let searchTimeout;\r\n            searchInput.addEventListener('input', () => {\r\n                clearTimeout(searchTimeout);\r\n                searchTimeout = setTimeout(() => {\r\n                    this.renderFiles();\r\n                }, 300);\r\n            });\r\n        }\r\n        \r\n        if (sortSelect) {\r\n            sortSelect.addEventListener('change', () => {\r\n                this.renderFiles();\r\n            });\r\n        }\r\n    }\r\n    \r\n    updateStorageStats() {\r\n        const storageUsed = document.getElementById('storage-used');\r\n        const storageLimit = document.getElementById('storage-limit');\r\n        const fileCount = document.getElementById('file-count');\r\n        const storagePercentage = document.getElementById('storage-percentage');\r\n        const progressFill = document.getElementById('progress-fill');\r\n        const progressText = document.getElementById('progress-text');\r\n        \r\n        // const usedMB = this.currentStorageUsed / (1024 * 1024); // Unused\r\n        const limitGB = this.storageLimit / (1024 * 1024 * 1024);\r\n        const percentage = (this.currentStorageUsed / this.storageLimit) * 100;\r\n        \r\n        if (storageUsed) {\r\n            storageUsed.textContent = this.formatBytes(this.currentStorageUsed);\r\n        }\r\n        if (storageLimit) {\r\n            storageLimit.textContent = `${limitGB} GB`;\r\n        }\r\n        if (fileCount) {\r\n            fileCount.textContent = this.files.length;\r\n        }\r\n        if (storagePercentage) {\r\n            storagePercentage.textContent = `${percentage.toFixed(1)}%`;\r\n        }\r\n        if (progressFill) {\r\n            progressFill.style.width = `${Math.min(percentage, 100)}%`;\r\n            if (percentage > 80) {\r\n                progressFill.style.background = '#ff6b6b';\r\n            } else if (percentage > 60) {\r\n                progressFill.style.background = '#ffa500';\r\n            }\r\n        }\r\n        if (progressText) {\r\n            progressText.textContent = `${this.formatBytes(this.currentStorageUsed)} / ${limitGB} GB`;\r\n        }\r\n    }\r\n    \r\n    formatBytes(bytes) {\r\n        if (bytes === 0) return '0 B';\r\n        const k = 1024;\r\n        const sizes = ['B', 'KB', 'MB', 'GB'];\r\n        const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n        return Math.round((bytes / Math.pow(k, i)) * 100) / 100 + ' ' + sizes[i];\r\n    }\r\n    \r\n    escapeHtml(text) {\r\n        if (!text) return '';\r\n        const div = document.createElement('div');\r\n        div.textContent = text;\r\n        return div.innerHTML;\r\n    }\r\n    \r\n    showError(message) {\r\n        const dashboard = document.getElementById('storage-dashboard');\r\n        if (dashboard) {\r\n            dashboard.innerHTML = `\r\n                <div class=\"error-state\">\r\n                    <div class=\"error-icon\">âŒ</div>\r\n                    <h2>Error</h2>\r\n                    <p>${this.escapeHtml(message)}</p>\r\n                    <button onclick=\"location.reload()\" class=\"retry-button\">Retry</button>\r\n                </div>\r\n            `;\r\n        }\r\n    }\r\n}\r\n\r\n// FileStorageManager will be initialized by the inline script in file-storage.html\r\n// This ensures proper initialization order: DOM -> Auth -> FileStorage\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\fix-scroll.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\groups-manager.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'groupsManager' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":552,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":552,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Groups Manager - Interactive Groups & Posts System\r\n// Handles fetching groups, posts, creating content, and real-time updates\r\n\r\nclass GroupsManager {\r\n    constructor() {\r\n        // Auto-detect environment (GitLab Pages vs localhost)\r\n        const isGitLabPages = window.location.hostname.includes('gitlab.io') || \r\n                             window.location.hostname.includes('gitlab-pages') ||\r\n                             (window.location.hostname !== 'localhost' && \r\n                              window.location.hostname !== '127.0.0.1');\r\n        \r\n        if (isGitLabPages) {\r\n            console.log('ðŸŒ GitLab Pages detected - Using client-side storage for groups');\r\n            this.API_URL = null;\r\n            this.useClientSideStorage = true;\r\n            this.groupsStorageKey = 'adriano_groups';\r\n            this.postsStorageKey = 'adriano_posts';\r\n            this.initClientStorage();\r\n        } else {\r\n            console.log('ðŸ’» Localhost detected - Using backend API for groups');\r\n            this.API_URL = 'http://localhost:3000/api';\r\n            this.useClientSideStorage = false;\r\n        }\r\n        \r\n        this.groups = [];\r\n        this.posts = [];\r\n        this.currentGroupFilter = null;\r\n        this.init();\r\n    }\r\n\r\n    initClientStorage() {\r\n        // Initialize default groups if not exists\r\n        if (!localStorage.getItem(this.groupsStorageKey)) {\r\n            const defaultGroups = [\r\n                {\r\n                    id: 1,\r\n                    name: 'Cosmic Explorers',\r\n                    description: 'Main community for all space enthusiasts',\r\n                    members: [],\r\n                    posts: []\r\n                }\r\n            ];\r\n            localStorage.setItem(this.groupsStorageKey, JSON.stringify(defaultGroups));\r\n        }\r\n        \r\n        // Initialize posts storage if not exists\r\n        if (!localStorage.getItem(this.postsStorageKey)) {\r\n            localStorage.setItem(this.postsStorageKey, JSON.stringify([]));\r\n        }\r\n    }\r\n\r\n    getGroupsFromStorage() {\r\n        const groupsJson = localStorage.getItem(this.groupsStorageKey);\r\n        return JSON.parse(groupsJson || '[]');\r\n    }\r\n\r\n    saveGroupsToStorage(groups) {\r\n        localStorage.setItem(this.groupsStorageKey, JSON.stringify(groups));\r\n    }\r\n\r\n    getPostsFromStorage() {\r\n        const postsJson = localStorage.getItem(this.postsStorageKey);\r\n        return JSON.parse(postsJson || '[]');\r\n    }\r\n\r\n    savePostsToStorage(posts) {\r\n        localStorage.setItem(this.postsStorageKey, JSON.stringify(posts));\r\n    }\r\n\r\n    async init() {\r\n        console.log('ðŸ‘¥ Groups Manager initialized');\r\n        await this.loadGroups();\r\n        await this.loadPosts();\r\n        this.render();\r\n        this.setupEventListeners();\r\n        \r\n        // Auto-refresh every 30 seconds\r\n        this.refreshInterval = setInterval(() => this.refresh(), 30000);\r\n    }\r\n\r\n    cleanup() {\r\n        // Clear refresh interval\r\n        if (this.refreshInterval) {\r\n            clearInterval(this.refreshInterval);\r\n            this.refreshInterval = null;\r\n        }\r\n    }\r\n\r\n    async loadGroups() {\r\n        try {\r\n            console.log('ðŸ“‹ Loading groups...');\r\n            \r\n            if (this.useClientSideStorage) {\r\n                // Load from localStorage\r\n                this.groups = this.getGroupsFromStorage();\r\n                console.log(`âœ“ Loaded ${this.groups.length} groups from localStorage`);\r\n            } else {\r\n                // Load from backend\r\n                const response = await fetch(`${this.API_URL}/groups`);\r\n                if (!response.ok) {\r\n                    throw new Error('Failed to fetch groups');\r\n                }\r\n                this.groups = await response.json();\r\n                console.log(`âœ“ Loaded ${this.groups.length} groups from backend`);\r\n            }\r\n        } catch (error) {\r\n            console.error('âœ— Error loading groups:', error);\r\n            // Fallback to default group\r\n            if (this.groups.length === 0) {\r\n                this.groups = [{\r\n                    id: 1,\r\n                    name: 'Cosmic Explorers',\r\n                    description: 'Main community for all space enthusiasts',\r\n                    members: [],\r\n                    posts: []\r\n                }];\r\n            }\r\n            this.showError('Failed to load groups');\r\n        }\r\n    }\r\n\r\n    async loadPosts(groupId = null) {\r\n        try {\r\n            const url = groupId \r\n                ? `${this.API_URL}/posts?groupId=${groupId}`\r\n                : `${this.API_URL}/posts`;\r\n            \r\n            console.log(`ðŸ“° Loading posts${groupId ? ` for group ${groupId}` : ''}...`);\r\n            const response = await fetch(url);\r\n            this.posts = await response.json();\r\n            console.log(`âœ“ Loaded ${this.posts.length} posts`);\r\n        } catch (error) {\r\n            console.error('âœ— Error loading posts:', error);\r\n            this.showError('Failed to load posts');\r\n        }\r\n    }\r\n\r\n    async refresh() {\r\n        console.log('ðŸ”„ Refreshing data...');\r\n        await this.loadGroups();\r\n        await this.loadPosts(this.currentGroupFilter);\r\n        this.renderPosts();\r\n    }\r\n\r\n    async joinGroup(groupId) {\r\n        if (!authManager || !authManager.isAuthenticated()) {\r\n            if (typeof showModal === 'function') {\r\n                showModal('login-modal');\r\n            }\r\n            return;\r\n        }\r\n\r\n        try {\r\n            console.log(`ðŸ‘¥ Joining group ${groupId}...`);\r\n            \r\n            if (this.useClientSideStorage) {\r\n                // Client-side: Add user to group\r\n                const groups = this.getGroupsFromStorage();\r\n                const group = groups.find(g => g.id === groupId);\r\n                if (group) {\r\n                    const currentUser = authManager.getCurrentUser();\r\n                    if (currentUser && !group.members.includes(currentUser.id)) {\r\n                        group.members.push(currentUser.id);\r\n                        this.saveGroupsToStorage(groups);\r\n                        this.groups = groups;\r\n                        console.log('âœ“ Successfully joined group');\r\n                        this.showSuccess('Successfully joined group!');\r\n                        this.render();\r\n                    }\r\n                }\r\n            } else {\r\n                // Backend: Use API\r\n                const response = await fetch(`${this.API_URL}/groups/${groupId}/join`, {\r\n                    method: 'POST',\r\n                    headers: authManager.getHeaders(),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    const error = await response.json();\r\n                    throw new Error(error.error);\r\n                }\r\n\r\n                console.log('âœ“ Successfully joined group');\r\n                await this.refresh();\r\n                this.showSuccess('Successfully joined group!');\r\n            }\r\n            \r\n        } catch (error) {\r\n            console.error('âœ— Error joining group:', error);\r\n            this.showError(error.message || 'Failed to join group');\r\n        }\r\n    }\r\n\r\n    async createPost(groupId, content) {\r\n        if (!authManager || !authManager.isAuthenticated()) {\r\n            if (typeof showModal === 'function') {\r\n                showModal('login-modal');\r\n            }\r\n            return;\r\n        }\r\n\r\n        try {\r\n            console.log(`âœ Creating post in group ${groupId}...`);\r\n            \r\n            if (this.useClientSideStorage) {\r\n                // Client-side: Create post in localStorage\r\n                const posts = this.getPostsFromStorage();\r\n                const currentUser = authManager.getCurrentUser();\r\n                \r\n                if (!currentUser) {\r\n                    throw new Error('You must be logged in to create a post');\r\n                }\r\n                \r\n                const newPost = {\r\n                    id: posts.length > 0 ? Math.max(...posts.map(p => p.id)) + 1 : 1,\r\n                    groupId: parseInt(groupId, 10),\r\n                    authorId: currentUser.id,\r\n                    authorName: currentUser.username || currentUser.fullName || 'Anonymous',\r\n                    content: content.trim(),\r\n                    likes: 0,\r\n                    comments: [],\r\n                    views: 0,\r\n                    createdAt: new Date().toISOString(),\r\n                    updatedAt: new Date().toISOString()\r\n                };\r\n                \r\n                posts.push(newPost);\r\n                this.savePostsToStorage(posts);\r\n                this.posts = posts;\r\n                console.log('âœ“ Post created successfully');\r\n                this.showSuccess('Post created!');\r\n                this.render();\r\n            } else {\r\n                // Backend: Use API\r\n                const response = await fetch(`${this.API_URL}/posts`, {\r\n                    method: 'POST',\r\n                    headers: authManager.getHeaders(),\r\n                    body: JSON.stringify({ groupId, content }),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    const error = await response.json();\r\n                    throw new Error(error.error);\r\n                }\r\n\r\n                console.log('âœ“ Post created successfully');\r\n                await this.refresh();\r\n                this.showSuccess('Post created!');\r\n            }\r\n            \r\n        } catch (error) {\r\n            console.error('âœ— Error creating post:', error);\r\n            this.showError(error.message || 'Failed to create post');\r\n        }\r\n    }\r\n\r\n    async likePost(postId) {\r\n        if (!authManager.isAuthenticated()) {\r\n            showModal('login-modal');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await fetch(`${this.API_URL}/posts/${postId}/like`, {\r\n                method: 'POST',\r\n                headers: authManager.getHeaders(),\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Failed to like post');\r\n\r\n            const data = await response.json();\r\n            console.log(`ðŸ‘ Post ${postId} liked`);\r\n            \r\n            // Update UI\r\n            const likeButton = document.querySelector(`[data-post-id=\"${postId}\"] .like-count`);\r\n            if (likeButton) {\r\n                likeButton.textContent = `${data.likes} Likes`;\r\n            }\r\n            \r\n        } catch (error) {\r\n            console.error('âœ— Error liking post:', error);\r\n        }\r\n    }\r\n\r\n    async addComment(postId, content) {\r\n        if (!authManager || !authManager.isAuthenticated()) {\r\n            if (typeof showModal === 'function') {\r\n                showModal('login-modal');\r\n            }\r\n            return;\r\n        }\r\n\r\n        try {\r\n            if (this.useClientSideStorage) {\r\n                // Client-side: Add comment in localStorage\r\n                const posts = this.getPostsFromStorage();\r\n                const post = posts.find(p => p.id === postId);\r\n                const currentUser = authManager.getCurrentUser();\r\n                \r\n                if (!currentUser) {\r\n                    throw new Error('You must be logged in to add a comment');\r\n                }\r\n                \r\n                if (post) {\r\n                    if (!post.comments) {\r\n                        post.comments = [];\r\n                    }\r\n                    \r\n                    const newComment = {\r\n                        id: post.comments.length > 0 ? Math.max(...post.comments.map(c => c.id)) + 1 : 1,\r\n                        authorId: currentUser.id,\r\n                        authorName: currentUser.username || currentUser.fullName || 'Anonymous',\r\n                        content: content.trim(),\r\n                        createdAt: new Date().toISOString()\r\n                    };\r\n                    \r\n                    post.comments.push(newComment);\r\n                    this.savePostsToStorage(posts);\r\n                    this.posts = posts;\r\n                    console.log(`ðŸ’¬ Comment added to post ${postId}`);\r\n                    this.render();\r\n                }\r\n            } else {\r\n                // Backend: Use API\r\n                const response = await fetch(`${this.API_URL}/posts/${postId}/comments`, {\r\n                    method: 'POST',\r\n                    headers: authManager.getHeaders(),\r\n                    body: JSON.stringify({ content }),\r\n                });\r\n\r\n                if (!response.ok) throw new Error('Failed to add comment');\r\n\r\n                console.log(`ðŸ’¬ Comment added to post ${postId}`);\r\n                await this.refresh();\r\n            }\r\n            \r\n        } catch (error) {\r\n            console.error('âœ— Error adding comment:', error);\r\n            this.showError(error.message || 'Failed to add comment');\r\n        }\r\n    }\r\n\r\n    filterByGroup(groupId) {\r\n        this.currentGroupFilter = groupId;\r\n        this.loadPosts(groupId);\r\n        setTimeout(() => this.renderPosts(), 100);\r\n    }\r\n\r\n    setupEventListeners() {\r\n        // Create post button\r\n        const createPostBtn = document.getElementById('create-post-btn');\r\n        if (createPostBtn) {\r\n            createPostBtn.addEventListener('click', () => {\r\n                if (!authManager.isAuthenticated()) {\r\n                    showModal('login-modal');\r\n                } else {\r\n                    showModal('create-post-modal');\r\n                }\r\n            });\r\n        }\r\n\r\n        // Submit post form\r\n        const submitPostBtn = document.getElementById('submit-post-btn');\r\n        if (submitPostBtn) {\r\n            submitPostBtn.addEventListener('click', async () => {\r\n                const groupSelect = document.getElementById('post-group-select');\r\n                const contentInput = document.getElementById('post-content');\r\n                \r\n                if (groupSelect && contentInput) {\r\n                    const groupId = parseInt(groupSelect.value, 10);\r\n                    const content = contentInput.value.trim();\r\n                    \r\n                    if (!content) {\r\n                        this.showError('Please enter post content');\r\n                        return;\r\n                    }\r\n                    \r\n                    await this.createPost(groupId, content);\r\n                    contentInput.value = '';\r\n                    hideModal('create-post-modal');\r\n                }\r\n            });\r\n        }\r\n\r\n        // Group filter buttons\r\n        document.addEventListener('click', (e) => {\r\n            if (e.target.classList.contains('filter-group-btn')) {\r\n                const groupId = e.target.dataset.groupId;\r\n                this.filterByGroup(groupId ? parseInt(groupId, 10) : null);\r\n                \r\n                // Update active state\r\n                document.querySelectorAll('.filter-group-btn').forEach(btn => {\r\n                    btn.classList.remove('active');\r\n                });\r\n                e.target.classList.add('active');\r\n            }\r\n        });\r\n    }\r\n\r\n    render() {\r\n        this.renderGroups();\r\n        this.renderPosts();\r\n    }\r\n\r\n    renderGroups() {\r\n        const container = document.getElementById('groups-list');\r\n        if (!container) return;\r\n\r\n        container.innerHTML = this.groups.map(group => `\r\n            <div class=\"group-card\" data-entrance=\"slideUp\">\r\n                <h3>${group.name}</h3>\r\n                <p>${group.description}</p>\r\n                <div class=\"group-stats\">\r\n                    <span>ðŸ‘¥ ${group.members.length} members</span>\r\n                    <span>ðŸ“ ${group.posts || 0} posts</span>\r\n                </div>\r\n                ${authManager.isAuthenticated() && !authManager.user.groups?.includes(group.id) ? `\r\n                    <button class=\"join-group-btn\" onclick=\"groupsManager.joinGroup(${group.id})\">\r\n                        Join Group\r\n                    </button>\r\n                ` : authManager.user?.groups?.includes(group.id) ? `\r\n                    <span class=\"member-badge\">âœ“ Member</span>\r\n                ` : ''}\r\n            </div>\r\n        `).join('');\r\n    }\r\n\r\n    renderPosts() {\r\n        const container = document.getElementById('posts-container');\r\n        if (!container) return;\r\n\r\n        if (this.posts.length === 0) {\r\n            container.innerHTML = `\r\n                <div class=\"no-posts\">\r\n                    <p>No posts yet. ${authManager.isAuthenticated() ? 'Be the first to post!' : 'Login to create posts.'}</p>\r\n                </div>\r\n            `;\r\n            return;\r\n        }\r\n\r\n        container.innerHTML = this.posts.map(post => {\r\n            const group = this.groups.find(g => g.id === post.groupId);\r\n            const date = new Date(post.createdAt).toLocaleDateString('en-US', {\r\n                month: 'long',\r\n                day: 'numeric',\r\n                year: 'numeric'\r\n            });\r\n\r\n            return `\r\n                <div class=\"post-card\" data-post-id=\"${post.id}\" data-entrance=\"slideUp\">\r\n                    ${this.currentGroupFilter ? '' : `\r\n                        <p class=\"post-group-tag\">Posted in <a href=\"#\" onclick=\"groupsManager.filterByGroup(${post.groupId}); return false;\">${group?.name || 'Unknown Group'}</a></p>\r\n                    `}\r\n                    \r\n                    <div class=\"post-header\">\r\n                        <div class=\"post-author\">\r\n                            <span class=\"author-avatar\">ðŸ‘¤</span>\r\n                            <div>\r\n                                <strong>${post.authorName}</strong>\r\n                                <span class=\"post-date\">${date}</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    \r\n                    <div class=\"post-content\">\r\n                        <p>${post.content}</p>\r\n                    </div>\r\n                    \r\n                    <div class=\"post-actions\">\r\n                        <button class=\"like-btn\" onclick=\"groupsManager.likePost(${post.id})\">\r\n                            â¤ï¸ <span class=\"like-count\">${post.likes || 0} Likes</span>\r\n                        </button>\r\n                        <span class=\"comment-count\">ðŸ’¬ ${post.comments?.length || 0} Comments</span>\r\n                        <span class=\"view-count\">ðŸ‘ï¸ ${post.views || 0} Views</span>\r\n                    </div>\r\n                    \r\n                    ${post.comments && post.comments.length > 0 ? `\r\n                        <div class=\"comments-section\">\r\n                            <h4>Comments</h4>\r\n                            ${post.comments.map(comment => `\r\n                                <div class=\"comment\">\r\n                                    <strong>${comment.authorName}</strong>\r\n                                    <p>${comment.content}</p>\r\n                                    <span class=\"comment-date\">${new Date(comment.createdAt).toLocaleDateString()}</span>\r\n                                </div>\r\n                            `).join('')}\r\n                        </div>\r\n                    ` : ''}\r\n                    \r\n                    ${authManager.isAuthenticated() ? `\r\n                        <div class=\"add-comment\">\r\n                            <input type=\"text\" placeholder=\"Add a comment...\" id=\"comment-input-${post.id}\">\r\n                            <button onclick=\"groupsManager.handleCommentSubmit(${post.id})\">Post</button>\r\n                        </div>\r\n                    ` : ''}\r\n                </div>\r\n            `;\r\n        }).join('');\r\n\r\n        // Trigger entrance animations\r\n        setTimeout(() => {\r\n            const cards = container.querySelectorAll('[data-entrance]');\r\n            cards.forEach((card, index) => {\r\n                card.style.animationDelay = `${index * 0.1}s`;\r\n            });\r\n        }, 100);\r\n    }\r\n\r\n    handleCommentSubmit(postId) {\r\n        const input = document.getElementById(`comment-input-${postId}`);\r\n        if (input && input.value.trim()) {\r\n            this.addComment(postId, input.value.trim());\r\n            input.value = '';\r\n        }\r\n    }\r\n\r\n    showSuccess(message) {\r\n        this.showNotification(message, 'success');\r\n    }\r\n\r\n    showError(message) {\r\n        this.showNotification(message, 'error');\r\n    }\r\n\r\n    showNotification(message, type = 'info') {\r\n        const notification = document.createElement('div');\r\n        notification.className = `notification notification-${type}`;\r\n        notification.textContent = message;\r\n        notification.style.cssText = `\r\n            position: fixed;\r\n            top: 20px;\r\n            right: 20px;\r\n            padding: 1rem 1.5rem;\r\n            background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};\r\n            color: white;\r\n            border-radius: 8px;\r\n            box-shadow: 0 4px 12px rgba(0,0,0,0.3);\r\n            z-index: 10000;\r\n            animation: slideIn 0.3s ease;\r\n        `;\r\n        \r\n        document.body.appendChild(notification);\r\n        \r\n        setTimeout(() => {\r\n            notification.style.animation = 'slideOut 0.3s ease';\r\n            setTimeout(() => notification.remove(), 300);\r\n        }, 3000);\r\n    }\r\n}\r\n\r\n// Initialize groups manager when DOM is ready\r\nlet groupsManager;\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => {\r\n        groupsManager = new GroupsManager();\r\n    });\r\n} else {\r\n    const _groupsManager = new GroupsManager();\r\n    window.groupsManager = _groupsManager;\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\kepler_data_parsed.js","messages":[],"suppressedMessages":[{"ruleId":"no-redeclare","severity":2,"message":"'KEPLER_DATABASE' is already defined as a built-in global variable.","line":10,"column":7,"nodeType":"Identifier","messageId":"redeclaredAsBuiltin","endLine":10,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\large-exoplanet-loader.js","messages":[{"ruleId":"max-statements","severity":1,"message":"Async method 'loadLargeDataset' has too many statements (52). Maximum allowed is 30.","line":22,"column":27,"nodeType":"FunctionExpression","messageId":"exceed","endLine":115,"endColumn":6},{"ruleId":"max-depth","severity":1,"message":"Blocks are nested too deeply (6). Maximum allowed is 5.","line":75,"column":29,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":80,"endColumn":30},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":81,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":36},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":95,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":95,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Large Exoplanet Database Loader\r\n * Handles loading and parsing of 1M+ exoplanet records from Google Drive file\r\n * Uses streaming/chunked loading for performance\r\n */\r\n\r\nclass LargeExoplanetLoader {\r\n    constructor() {\r\n        this.largeDataset = [];\r\n        this.isLoading = false;\r\n        this.loadProgress = 0;\r\n        this.totalRecords = 0;\r\n        this.loadedRecords = 0;\r\n        this.chunkSize = 10000; // Load 10k records at a time\r\n        this.searchIndex = new Map(); // For fast search\r\n    }\r\n\r\n    /**\r\n     * Load large exoplanet dataset from file\r\n     * Supports JSONL format (one JSON object per line)\r\n     */\r\n    async loadLargeDataset(filePath) {\r\n        if (this.isLoading) {\r\n            console.log('â³ Already loading dataset...');\r\n            return;\r\n        }\r\n\r\n        this.isLoading = true;\r\n        this.loadProgress = 0;\r\n        this.largeDataset = [];\r\n        this.searchIndex.clear();\r\n\r\n        console.log(`ðŸš€ Loading large exoplanet dataset from: ${filePath}`);\r\n\r\n        try {\r\n            const response = await fetch(filePath);\r\n            \r\n            if (!response.ok) {\r\n                throw new Error(`Failed to load file: ${response.statusText}`);\r\n            }\r\n\r\n            // Check if it's a streaming response\r\n            const reader = response.body.getReader();\r\n            const decoder = new TextDecoder();\r\n            let buffer = '';\r\n            let lineCount = 0;\r\n\r\n            // Update progress\r\n            const contentLength = response.headers.get('content-length');\r\n            if (contentLength) {\r\n                this.totalRecords = parseInt(contentLength, 10) / 200; // Rough estimate\r\n            }\r\n\r\n            // Process stream\r\n            while (true) {\r\n                const { done, value } = await reader.read();\r\n                \r\n                if (done) break;\r\n\r\n                buffer += decoder.decode(value, { stream: true });\r\n                const lines = buffer.split('\\n');\r\n                \r\n                // Keep last incomplete line in buffer\r\n                buffer = lines.pop() || '';\r\n\r\n                // Process complete lines\r\n                for (const line of lines) {\r\n                    if (line.trim()) {\r\n                        try {\r\n                            const planet = JSON.parse(line.trim());\r\n                            this.processPlanetRecord(planet);\r\n                            lineCount++;\r\n                            \r\n                            // Update progress every chunk\r\n                            if (lineCount % this.chunkSize === 0) {\r\n                                this.loadedRecords = lineCount;\r\n                                this.loadProgress = (lineCount / (this.totalRecords || 1000000)) * 100;\r\n                                this.updateProgressUI();\r\n                                console.log(`ðŸ“Š Loaded ${lineCount.toLocaleString()} records...`);\r\n                            }\r\n                        } catch (_e) {\r\n                            // Skip invalid JSON lines\r\n                            continue;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Process remaining buffer\r\n            if (buffer.trim()) {\r\n                try {\r\n                    const planet = JSON.parse(buffer.trim());\r\n                    this.processPlanetRecord(planet);\r\n                    lineCount++;\r\n                } catch (_e) {\r\n                    // Ignore\r\n                }\r\n            }\r\n\r\n            this.loadedRecords = lineCount;\r\n            this.totalRecords = lineCount;\r\n            this.loadProgress = 100;\r\n\r\n            console.log(`âœ… Loaded ${this.largeDataset.length.toLocaleString()} exoplanets from large dataset`);\r\n            this.updateProgressUI();\r\n            this.isLoading = false;\r\n\r\n            return this.largeDataset;\r\n\r\n        } catch (error) {\r\n            console.error('âŒ Error loading large dataset:', error);\r\n            this.isLoading = false;\r\n            return [];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Process and normalize a planet record\r\n     * Only includes planets with false_positive_flag: 0 (or missing flag)\r\n     */\r\n    processPlanetRecord(planet) {\r\n        // Filter: Only include planets with false_positive_flag: 0\r\n        // This ensures we only include valid planets (not false positives)\r\n        const falsePositiveFlag = planet.false_positive_flag !== undefined ? planet.false_positive_flag : \r\n                                 (planet.falsePositiveFlag !== undefined ? planet.falsePositiveFlag : undefined);\r\n        \r\n        // Include if false_positive_flag is 0, undefined, or null (treat missing as valid)\r\n        // Only exclude if flag is explicitly 1 (false positive)\r\n        if (falsePositiveFlag === 1) {\r\n            return; // Skip false positives\r\n        }\r\n        \r\n        // Normalize the planet data\r\n        const normalized = {\r\n            kepid: planet.kepid || planet.koi_id || null,\r\n            kepoi_name: planet.kepoi_name || planet.koi_name || `KOI-${planet.kepid || 'unknown'}`,\r\n            kepler_name: planet.kepler_name || planet.planet_name || null,\r\n            status: this.normalizeStatus(planet.status || planet.koi_disposition || planet.disposition),\r\n            score: planet.score || planet.koi_score || planet.confidence || 0,\r\n            radius: this.extractRadius(planet),\r\n            mass: this.extractMass(planet),\r\n            distance: this.extractDistance(planet),\r\n            disc_year: this.extractDiscoveryYear(planet),\r\n            type: this.classifyPlanet(this.extractRadius(planet)),\r\n            availability: 'available', // Default to available\r\n            source: 'large-dataset', // Mark as from large dataset\r\n            false_positive_flag: falsePositiveFlag // Preserve the flag\r\n        };\r\n\r\n        this.largeDataset.push(normalized);\r\n\r\n        // Build search index\r\n        this.indexPlanet(normalized);\r\n    }\r\n\r\n    /**\r\n     * Normalize status values\r\n     */\r\n    normalizeStatus(status) {\r\n        if (!status) return 'CANDIDATE';\r\n        \r\n        const s = status.toString().toUpperCase();\r\n        if (s.includes('CONFIRMED') || s.includes('CONFIRM') || s === 'CONFIRMED PLANET') {\r\n            return 'CONFIRMED';\r\n        } else if (s.includes('CANDIDATE') || s.includes('CAND')) {\r\n            return 'CANDIDATE';\r\n        } else if (s.includes('FALSE') || s.includes('FALSE POSITIVE')) {\r\n            return 'FALSE POSITIVE';\r\n        }\r\n        return 'CANDIDATE';\r\n    }\r\n\r\n    /**\r\n     * Extract radius from various field names\r\n     */\r\n    extractRadius(planet) {\r\n        return planet.radius || \r\n               planet.koi_ror || \r\n               planet.planet_radius || \r\n               planet.r_planet || \r\n               (planet.r_star && planet.r_planet ? planet.r_planet / planet.r_star : null) ||\r\n               this.estimateRadius(planet);\r\n    }\r\n\r\n    /**\r\n     * Extract mass from various field names\r\n     */\r\n    extractMass(planet) {\r\n        return planet.mass || \r\n               planet.koi_mass || \r\n               planet.planet_mass || \r\n               planet.m_planet || \r\n               this.estimateMass(planet);\r\n    }\r\n\r\n    /**\r\n     * Extract distance from various field names\r\n     */\r\n    extractDistance(planet) {\r\n        return planet.distance || \r\n               planet.st_dist || \r\n               planet.host_distance || \r\n               planet.distance_pc || \r\n               this.estimateDistance(planet.kepid || planet.koi_id);\r\n    }\r\n\r\n    /**\r\n     * Extract discovery year\r\n     */\r\n    extractDiscoveryYear(planet) {\r\n        return planet.disc_year || \r\n               planet.discovery_year || \r\n               planet.year || \r\n               this.estimateDiscoveryYear(planet);\r\n    }\r\n\r\n    /**\r\n     * Estimate radius if not available\r\n     */\r\n    estimateRadius(planet) {\r\n        // Use period and other data to estimate\r\n        if (planet.period && planet.depth) {\r\n            // Rough estimation based on transit depth\r\n            return Math.sqrt(planet.depth) * 10; // Simplified\r\n        }\r\n        return 1.0 + Math.random() * 5; // Default range\r\n    }\r\n\r\n    /**\r\n     * Estimate mass if not available\r\n     */\r\n    estimateMass(planet) {\r\n        if (this.extractRadius(planet)) {\r\n            const radius = this.extractRadius(planet);\r\n            // Rough mass-radius relationship\r\n            return Math.pow(radius, 2.5) * 0.5;\r\n        }\r\n        return 1.0 + Math.random() * 10;\r\n    }\r\n\r\n    /**\r\n     * Estimate distance\r\n     */\r\n    estimateDistance(kepid) {\r\n        // Use kepid to generate consistent distance\r\n        if (kepid) {\r\n            return 100 + (kepid % 5000);\r\n        }\r\n        return 100 + Math.random() * 5000;\r\n    }\r\n\r\n    /**\r\n     * Estimate discovery year\r\n     */\r\n    estimateDiscoveryYear(planet) {\r\n        // Kepler mission years: 2009-2018\r\n        if (planet.kepid) {\r\n            return 2009 + (planet.kepid % 10);\r\n        }\r\n        return 2014;\r\n    }\r\n\r\n    /**\r\n     * Classify planet type based on radius\r\n     */\r\n    classifyPlanet(radius) {\r\n        if (!radius) return 'Unknown';\r\n        if (radius < 0.8) return 'Sub-Earth';\r\n        if (radius <= 1.25) return 'Earth-like';\r\n        if (radius <= 2.0) return 'Super-Earth';\r\n        if (radius <= 4.0) return 'Mini-Neptune';\r\n        if (radius <= 10.0) return 'Neptune-like';\r\n        return 'Gas Giant';\r\n    }\r\n\r\n    /**\r\n     * Build search index for fast lookups\r\n     */\r\n    indexPlanet(planet) {\r\n        const searchTerms = [\r\n            planet.kepoi_name?.toLowerCase(),\r\n            planet.kepler_name?.toLowerCase(),\r\n            planet.kepid?.toString(),\r\n            planet.status?.toLowerCase(),\r\n            planet.type?.toLowerCase()\r\n        ].filter(Boolean);\r\n\r\n        searchTerms.forEach(term => {\r\n            if (!this.searchIndex.has(term)) {\r\n                this.searchIndex.set(term, []);\r\n            }\r\n            this.searchIndex.get(term).push(this.largeDataset.length - 1);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fast search using index\r\n     */\r\n    search(query) {\r\n        if (!query || query.length < 2) {\r\n            return this.largeDataset;\r\n        }\r\n\r\n        const lowerQuery = query.toLowerCase();\r\n        const results = new Set();\r\n        \r\n        // Search in index\r\n        for (const [term, indices] of this.searchIndex.entries()) {\r\n            if (term.includes(lowerQuery)) {\r\n                indices.forEach(idx => results.add(idx));\r\n            }\r\n        }\r\n\r\n        // Also do direct search for names\r\n        this.largeDataset.forEach((planet, idx) => {\r\n            if (planet.kepoi_name?.toLowerCase().includes(lowerQuery) ||\r\n                planet.kepler_name?.toLowerCase().includes(lowerQuery) ||\r\n                planet.kepid?.toString().includes(lowerQuery)) {\r\n                results.add(idx);\r\n            }\r\n        });\r\n\r\n        return Array.from(results).map(idx => this.largeDataset[idx]);\r\n    }\r\n\r\n    /**\r\n     * Update progress UI\r\n     */\r\n    updateProgressUI() {\r\n        const container = document.getElementById('nasa-data-container');\r\n        if (container && this.isLoading) {\r\n            const progressHTML = `\r\n                <div style=\"text-align: center; padding: 3rem;\">\r\n                    <div style=\"font-size: 3rem; margin-bottom: 1rem; animation: pulse 1.5s ease-in-out infinite;\">ðŸŒ</div>\r\n                    <h3 style=\"color: #ba944f;\">Loading Large Exoplanet Database...</h3>\r\n                    <p style=\"opacity: 0.8; margin-top: 1rem;\">\r\n                        Loaded: ${this.loadedRecords.toLocaleString()} / ${this.totalRecords.toLocaleString()} records\r\n                    </p>\r\n                    <div style=\"width: 100%; max-width: 500px; margin: 2rem auto; background: rgba(0,0,0,0.3); border-radius: 10px; overflow: hidden;\">\r\n                        <div style=\"width: ${this.loadProgress}%; height: 30px; background: linear-gradient(90deg, #ba944f, #ffd700); transition: width 0.3s ease;\"></div>\r\n                    </div>\r\n                    <p style=\"opacity: 0.6; margin-top: 1rem; font-size: 0.9rem;\">This may take a moment for 1M+ records...</p>\r\n                </div>\r\n            `;\r\n            container.innerHTML = progressHTML;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get statistics from large dataset\r\n     */\r\n    getStatistics() {\r\n        const stats = {\r\n            total: this.largeDataset.length,\r\n            confirmed: 0,\r\n            candidates: 0,\r\n            earthLike: 0,\r\n            superEarths: 0,\r\n            gasGiants: 0,\r\n            available: 0\r\n        };\r\n\r\n        this.largeDataset.forEach(planet => {\r\n            if (planet.status === 'CONFIRMED') stats.confirmed++;\r\n            else if (planet.status === 'CANDIDATE') stats.candidates++;\r\n            \r\n            if (planet.type === 'Earth-like') stats.earthLike++;\r\n            else if (planet.type === 'Super-Earth') stats.superEarths++;\r\n            else if (planet.type === 'Gas Giant') stats.gasGiants++;\r\n            \r\n            if (planet.availability === 'available') stats.available++;\r\n        });\r\n\r\n        return stats;\r\n    }\r\n}\r\n\r\n// Export for use in other scripts\r\nif (typeof window !== 'undefined') {\r\n    window.LargeExoplanetLoader = LargeExoplanetLoader;\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\loader.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\navigation.js","messages":[{"ruleId":"max-lines-per-function","severity":1,"message":"Arrow function has too many lines (230). Maximum allowed is 200.","line":182,"column":47,"nodeType":"ArrowFunctionExpression","messageId":"exceed","endLine":447,"endColumn":2}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Navigation Menu System\n * Handles hamburger menu, mobile navigation, and smooth page transitions\n */\n\nclass NavigationMenu {\n    constructor() {\n        this.isOpen = false;\n        this.init();\n    }\n\n    init() {\n        this.createMenuButton();\n        this.createMenuOverlay();\n        this.setupEventListeners();\n    }\n\n    createMenuButton() {\n        const menuButton = document.createElement('button');\n        menuButton.id = 'menu-toggle';\n        menuButton.className = 'menu-toggle';\n        menuButton.setAttribute('aria-label', 'Open navigation menu');\n        menuButton.innerHTML = `\n            <span class=\"menu-icon\"></span>\n            <span class=\"menu-icon\"></span>\n            <span class=\"menu-icon\"></span>\n        `;\n        \n        // Insert at the beginning of body\n        document.body.insertBefore(menuButton, document.body.firstChild);\n    }\n\n    createMenuOverlay() {\n        const overlay = document.createElement('div');\n        overlay.id = 'menu-overlay';\n        overlay.className = 'menu-overlay';\n        overlay.innerHTML = `\n            <div class=\"menu-content\">\n                <button id=\"menu-close\" class=\"menu-close\" aria-label=\"Close menu\">\n                    <span>Close</span>\n                </button>\n                \n                <div class=\"menu-header\">\n                    <h2>ADRIANO TO THE STAR</h2>\n                </div>\n\n                <nav class=\"menu-nav\">\n                    <ul>\n                        <li><a href=\"index.html\" data-page=\"home\">Home</a></li>\n                        <li><a href=\"business-promise.html\" data-page=\"business-promise\">Business Promise</a></li>\n                        <li><a href=\"education.html\" data-page=\"education\">Education</a></li>\n                        <li><a href=\"projects.html\" data-page=\"projects\">Projects</a></li>\n                        <li><a href=\"about.html\" data-page=\"about\">About me</a></li>\n                        <li><a href=\"database.html\" data-page=\"database\">DATABASE</a></li>\n                        <li><a href=\"stellar-ai.html\" data-page=\"stellar-ai\">ðŸ¤– Stellar AI</a></li>\n                        <li><a href=\"file-storage.html\" data-page=\"file-storage\">ðŸ“ File Storage</a></li>\n                        <li><a href=\"broadband-checker.html\" data-page=\"broadband\">ðŸŒ Broadband Checker</a></li>\n                        <li><a href=\"book-online.html\" data-page=\"book\">Book Online</a></li>\n                        <li><a href=\"loyalty.html\" data-page=\"loyalty\">Loyalty</a></li>\n                        <li><a href=\"events.html\" data-page=\"events\">Events</a></li>\n                        <li><a href=\"shop.html\" data-page=\"shop\">Shop</a></li>\n                        <li><a href=\"groups.html\" data-page=\"groups\">Groups</a></li>\n                        <li><a href=\"members.html\" data-page=\"members\">Members</a></li>\n                        <li><a href=\"followers.html\" data-page=\"followers\">Followers</a></li>\n                        <li><a href=\"dashboard.html\" data-page=\"dashboard\">ðŸ“Š Dashboard</a></li>\n                        <li><a href=\"forum.html\" data-page=\"forum\">Forum</a></li>\n                        <li><a href=\"blog.html\" data-page=\"blog\">Blog</a></li>\n                    </ul>\n                </nav>\n\n                <div class=\"menu-footer\">\n                    <div class=\"search-container\">\n                        <input type=\"text\" placeholder=\"Search...\" class=\"menu-search\" id=\"menu-search\">\n                        <button class=\"search-btn\" aria-label=\"Search\">ðŸ”</button>\n                    </div>\n                    <button class=\"login-btn\">Log In</button>\n                </div>\n            </div>\n        `;\n\n        document.body.appendChild(overlay);\n    }\n\n    setupEventListeners() {\n        const toggleBtn = document.getElementById('menu-toggle');\n        const closeBtn = document.getElementById('menu-close');\n        const overlay = document.getElementById('menu-overlay');\n\n        if (!toggleBtn || !closeBtn || !overlay) {\n            console.warn('âš ï¸ Navigation menu elements not found');\n            return;\n        }\n\n        // Store handlers for cleanup\n        this.toggleHandler = () => this.openMenu();\n        this.closeHandler = () => this.closeMenu();\n        this.overlayHandler = (e) => {\n            if (e.target === overlay) {\n                this.closeMenu();\n            }\n        };\n        this.keydownHandler = (e) => {\n            if (e.key === 'Escape' && this.isOpen) {\n                this.closeMenu();\n            }\n        };\n\n        toggleBtn.addEventListener('click', this.toggleHandler);\n        closeBtn.addEventListener('click', this.closeHandler);\n        overlay.addEventListener('click', this.overlayHandler);\n        document.addEventListener('keydown', this.keydownHandler);\n\n        // Animate menu items\n        const menuItems = document.querySelectorAll('.menu-nav a');\n        if (menuItems) {\n            menuItems.forEach((item, index) => {\n                item.style.transitionDelay = `${index * 50}ms`;\n            });\n        }\n    }\n\n    cleanup() {\n        const toggleBtn = document.getElementById('menu-toggle');\n        const closeBtn = document.getElementById('menu-close');\n        const overlay = document.getElementById('menu-overlay');\n\n        if (toggleBtn && this.toggleHandler) {\n            toggleBtn.removeEventListener('click', this.toggleHandler);\n        }\n        if (closeBtn && this.closeHandler) {\n            closeBtn.removeEventListener('click', this.closeHandler);\n        }\n        if (overlay && this.overlayHandler) {\n            overlay.removeEventListener('click', this.overlayHandler);\n        }\n        if (this.keydownHandler) {\n            document.removeEventListener('keydown', this.keydownHandler);\n        }\n    }\n\n    openMenu() {\n        const overlay = document.getElementById('menu-overlay');\n        const toggleBtn = document.getElementById('menu-toggle');\n        \n        if (!overlay || !toggleBtn) return;\n        \n        this.isOpen = true;\n        overlay.classList.add('active');\n        toggleBtn.classList.add('active');\n        document.body.style.overflow = 'hidden';\n        \n        // Animate menu items\n        const menuItems = document.querySelectorAll('.menu-nav a');\n        if (menuItems) {\n            setTimeout(() => {\n                menuItems.forEach(item => item.classList.add('visible'));\n            }, 100);\n        }\n    }\n\n    closeMenu() {\n        const overlay = document.getElementById('menu-overlay');\n        const toggleBtn = document.getElementById('menu-toggle');\n        const menuItems = document.querySelectorAll('.menu-nav a');\n        \n        if (!overlay || !toggleBtn) return;\n        \n        this.isOpen = false;\n        if (menuItems) {\n            menuItems.forEach(item => item.classList.remove('visible'));\n        }\n        \n        setTimeout(() => {\n            overlay.classList.remove('active');\n            toggleBtn.classList.remove('active');\n            document.body.style.overflow = '';\n        }, 300);\n    }\n}\n\n// Initialize navigation when DOM is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n    new NavigationMenu();\n    \n    // Add dynamic CSS for navigation\n    const style = document.createElement('style');\n    style.textContent = `\n        /* Menu Toggle Button */\n        .menu-toggle {\n            position: fixed;\n            top: 30px;\n            right: 30px;\n            z-index: 1001;\n            background: transparent;\n            border: 2px solid rgba(255, 255, 255, 0.5);\n            width: 50px;\n            height: 50px;\n            border-radius: 4px;\n            cursor: pointer;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            gap: 6px;\n            transition: all 0.3s ease;\n        }\n\n        .menu-toggle:hover {\n            border-color: rgba(255, 255, 255, 0.8);\n            background: rgba(255, 255, 255, 0.1);\n        }\n\n        .menu-icon {\n            display: block;\n            width: 25px;\n            height: 2px;\n            background: #ffffff;\n            transition: all 0.3s ease;\n        }\n\n        .menu-toggle.active .menu-icon:nth-child(1) {\n            transform: translateY(8px) rotate(45deg);\n        }\n\n        .menu-toggle.active .menu-icon:nth-child(2) {\n            opacity: 0;\n        }\n\n        .menu-toggle.active .menu-icon:nth-child(3) {\n            transform: translateY(-8px) rotate(-45deg);\n        }\n\n        /* Menu Overlay */\n        .menu-overlay {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.95);\n            z-index: 1000;\n            opacity: 0;\n            visibility: hidden;\n            transition: opacity 0.4s ease, visibility 0.4s ease;\n            overflow-y: auto;\n        }\n\n        .menu-overlay.active {\n            opacity: 1;\n            visibility: visible;\n        }\n\n        .menu-content {\n            max-width: 600px;\n            margin: 0 auto;\n            padding: 100px 40px 60px;\n            position: relative;\n        }\n\n        .menu-close {\n            position: absolute;\n            top: 30px;\n            right: 30px;\n            background: transparent;\n            border: 2px solid rgba(255, 255, 255, 0.5);\n            color: #ffffff;\n            padding: 12px 24px;\n            font-size: 1rem;\n            font-family: 'Raleway', sans-serif;\n            font-weight: 300;\n            letter-spacing: 1px;\n            text-transform: uppercase;\n            cursor: pointer;\n            transition: all 0.3s ease;\n        }\n\n        .menu-close:hover {\n            border-color: rgba(255, 255, 255, 0.8);\n            background: rgba(255, 255, 255, 0.1);\n        }\n\n        .menu-header {\n            text-align: right;\n            margin-bottom: 60px;\n        }\n\n        .menu-header h2 {\n            font-family: 'Raleway', sans-serif;\n            font-size: 1.2rem;\n            font-weight: 300;\n            letter-spacing: 3px;\n            color: #ffffff;\n            text-transform: uppercase;\n        }\n\n        /* Navigation Menu */\n        .menu-nav {\n            margin: 60px 0;\n        }\n\n        .menu-nav ul {\n            list-style: none;\n            padding: 0;\n            margin: 0;\n        }\n\n        .menu-nav li {\n            margin: 0;\n            padding: 0;\n        }\n\n        .menu-nav a {\n            display: block;\n            font-family: 'Raleway', sans-serif;\n            font-size: 1.8rem;\n            font-weight: 300;\n            color: #ffffff;\n            text-decoration: none;\n            padding: 15px 0;\n            border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n            opacity: 0;\n            transform: translateX(-30px);\n            transition: all 0.3s ease;\n        }\n\n        .menu-nav a.visible {\n            opacity: 1;\n            transform: translateX(0);\n        }\n\n        .menu-nav a:hover {\n            color: rgba(255, 255, 255, 0.7);\n            padding-left: 20px;\n        }\n\n        /* Menu Footer */\n        .menu-footer {\n            margin-top: 60px;\n            padding-top: 40px;\n            border-top: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .search-container {\n            display: flex;\n            margin-bottom: 30px;\n            border: 1px solid rgba(255, 255, 255, 0.3);\n        }\n\n        .menu-search {\n            flex: 1;\n            background: transparent;\n            border: none;\n            padding: 15px 20px;\n            color: #ffffff;\n            font-family: 'Raleway', sans-serif;\n            font-size: 1rem;\n            outline: none;\n        }\n\n        .menu-search::placeholder {\n            color: rgba(255, 255, 255, 0.5);\n        }\n\n        .search-btn {\n            background: transparent;\n            border: none;\n            border-left: 1px solid rgba(255, 255, 255, 0.3);\n            padding: 15px 20px;\n            color: #ffffff;\n            cursor: pointer;\n            transition: background 0.3s ease;\n        }\n\n        .search-btn:hover {\n            background: rgba(255, 255, 255, 0.1);\n        }\n\n        .login-btn {\n            width: 100%;\n            background: transparent;\n            border: 2px solid #ffffff;\n            color: #ffffff;\n            padding: 15px;\n            font-family: 'Raleway', sans-serif;\n            font-size: 1rem;\n            font-weight: 400;\n            letter-spacing: 2px;\n            text-transform: uppercase;\n            cursor: pointer;\n            transition: all 0.3s ease;\n        }\n\n        .login-btn:hover {\n            background: #ffffff;\n            color: #000000;\n        }\n\n        /* Mobile Responsive */\n        @media (max-width: 768px) {\n            .menu-toggle {\n                top: 20px;\n                right: 20px;\n                width: 45px;\n                height: 45px;\n            }\n\n            .menu-content {\n                padding: 80px 20px 40px;\n            }\n\n            .menu-close {\n                top: 20px;\n                right: 80px;\n                padding: 10px 20px;\n                font-size: 0.9rem;\n            }\n\n            .menu-nav a {\n                font-size: 1.4rem;\n                padding: 12px 0;\n            }\n\n            .menu-header h2 {\n                font-size: 0.9rem;\n            }\n        }\n\n        /* Smooth page transitions */\n        .page-transition {\n            animation: fadeIn 0.5s ease;\n        }\n\n        @keyframes fadeIn {\n            from {\n                opacity: 0;\n                transform: translateY(20px);\n            }\n            to {\n                opacity: 1;\n                transform: translateY(0);\n            }\n        }\n    `;\n    document.head.appendChild(style);\n\n    console.log('ðŸ”— Navigation menu initialized!');\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\package-cli.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\setup-music.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\shop.js","messages":[{"ruleId":"max-statements","severity":1,"message":"Async method 'downloadProduct' has too many statements (52). Maximum allowed is 30.","line":152,"column":26,"nodeType":"FunctionExpression","messageId":"exceed","endLine":263,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'basePath' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":173,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":173,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"basePath"},"fix":{"range":[6592,6690],"text":""},"desc":"Remove unused variable 'basePath'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Shop Manager\r\n * Handles product purchases and downloads\r\n */\r\n\r\nclass ShopManager {\r\n    constructor() {\r\n        this.products = [\r\n            {\r\n                id: 'andromedian-free-pirate',\r\n                name: 'Andromedian Free Pirate',\r\n                price: 0.00,\r\n                currency: 'Â£',\r\n                // Download the product image (Law of Universe PNG)\r\n                // Primary: Local file in repository\r\n                downloadUrl: './images/law-of-universe.png',\r\n                downloadFilename: 'law-of-universe.png',\r\n                // Fallback: Google Drive URL if local file not available\r\n                fallbackUrl: 'https://drive.google.com/uc?export=download&id=1uhU4yviOcpKgXoMhC01p5Ng5Htrx1yY_',\r\n                description: 'Download your Law of Universe image - \"Think universe is a black box of ADRIANO\\'s computation, but with a BAGGIA\\'s single assumption \\'hidden equation\\' power input=power output.\"',\r\n            },\r\n        ];\r\n        this.purchasedProducts = this.loadPurchasedProducts();\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.renderProducts();\r\n        this.setupEventListeners();\r\n    }\r\n\r\n    loadPurchasedProducts() {\r\n        try {\r\n            const stored = localStorage.getItem('purchased_products');\r\n            return stored ? JSON.parse(stored) : [];\r\n        } catch (error) {\r\n            console.error('Error loading purchased products:', error);\r\n            return [];\r\n        }\r\n    }\r\n\r\n    savePurchasedProducts() {\r\n        try {\r\n            localStorage.setItem('purchased_products', JSON.stringify(this.purchasedProducts));\r\n        } catch (error) {\r\n            console.error('Error saving purchased products:', error);\r\n        }\r\n    }\r\n\r\n    renderProducts() {\r\n        const productContainer = document.querySelector('.product-card');\r\n        if (!productContainer) return;\r\n\r\n        const product = this.products[0];\r\n        const isPurchased = this.purchasedProducts.includes(product.id);\r\n\r\n        // Update button based on purchase status\r\n        const button = productContainer.querySelector('.buy-button') || \r\n                      productContainer.querySelector('button');\r\n        \r\n        if (button) {\r\n            if (isPurchased) {\r\n                button.innerHTML = 'ðŸ“¥ Download';\r\n                button.className = 'download-button';\r\n                button.onclick = () => this.downloadProduct(product.id);\r\n            } else {\r\n                button.innerHTML = product.price === 0 ? 'ðŸ›’ Get Free' : `ðŸ›’ Buy Now - ${product.currency}${product.price.toFixed(2)}`;\r\n                button.className = 'buy-button';\r\n                button.onclick = () => this.purchaseProduct(product.id);\r\n            }\r\n        }\r\n    }\r\n\r\n    setupEventListeners() {\r\n        // Handle any dynamically added buttons\r\n        document.addEventListener('click', (e) => {\r\n            if (e.target.classList.contains('buy-button')) {\r\n                const productId = e.target.dataset.productId || this.products[0].id;\r\n                this.purchaseProduct(productId);\r\n            } else if (e.target.classList.contains('download-button')) {\r\n                const productId = e.target.dataset.productId || this.products[0].id;\r\n                this.downloadProduct(productId);\r\n            }\r\n        });\r\n    }\r\n\r\n    async purchaseProduct(productId) {\r\n        const product = this.products.find((p) => p.id === productId);\r\n        if (!product) {\r\n            alert('Product not found');\r\n            return;\r\n        }\r\n\r\n        // For free products, directly mark as purchased and download\r\n        if (product.price === 0) {\r\n            if (!this.purchasedProducts.includes(productId)) {\r\n                this.purchasedProducts.push(productId);\r\n                this.savePurchasedProducts();\r\n            }\r\n            \r\n            // Show success message\r\n            this.showPurchaseSuccess(product);\r\n            \r\n            // Auto-download after a short delay\r\n            setTimeout(() => {\r\n                this.downloadProduct(productId);\r\n            }, 1000);\r\n        } else {\r\n            // For paid products, show payment modal (future implementation)\r\n            alert(`Payment integration coming soon!\\n\\nProduct: ${product.name}\\nPrice: ${product.currency}${product.price.toFixed(2)}`);\r\n        }\r\n    }\r\n\r\n    showPurchaseSuccess(product) {\r\n        // Create success notification\r\n        const notification = document.createElement('div');\r\n        notification.className = 'purchase-notification';\r\n        notification.innerHTML = `\r\n            <div class=\"notification-content\">\r\n                <h3>âœ… Purchase Successful!</h3>\r\n                <p>You've successfully acquired: <strong>${product.name}</strong></p>\r\n                <p>Your download will start shortly...</p>\r\n            </div>\r\n        `;\r\n        notification.style.cssText = `\r\n            position: fixed;\r\n            top: 20px;\r\n            right: 20px;\r\n            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);\r\n            border: 2px solid var(--gold-accent, #d4af37);\r\n            border-radius: 8px;\r\n            padding: 1.5rem;\r\n            z-index: 10000;\r\n            max-width: 350px;\r\n            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);\r\n            animation: slideInRight 0.3s ease-out;\r\n        `;\r\n\r\n        document.body.appendChild(notification);\r\n\r\n        // Remove after 5 seconds\r\n        setTimeout(() => {\r\n            notification.style.animation = 'slideOutRight 0.3s ease-out';\r\n            setTimeout(() => {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                }\r\n            }, 300);\r\n        }, 5000);\r\n    }\r\n\r\n    async downloadProduct(productId) {\r\n        const product = this.products.find((p) => p.id === productId);\r\n        if (!product) {\r\n            alert('Product not found');\r\n            return;\r\n        }\r\n\r\n        // Check if product was purchased\r\n        if (!this.purchasedProducts.includes(productId) && product.price > 0) {\r\n            alert('Please purchase this product first');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Build the full URL for local files on GitLab Pages\r\n            const getFullUrl = (relativePath) => {\r\n                if (relativePath.startsWith('http')) {\r\n                    return relativePath;\r\n                }\r\n                // Get base URL for GitLab Pages\r\n                const baseUrl = window.location.origin;\r\n                const basePath = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));\r\n                // Remove leading ./ from path\r\n                const cleanPath = relativePath.replace(/^\\.\\//, '');\r\n                // Try root-relative first (works for GitLab Pages)\r\n                return `${baseUrl}/${cleanPath}`;\r\n            };\r\n\r\n            // Try local file first (convert to full URL for GitLab Pages)\r\n            if (product.downloadUrl && !product.downloadUrl.startsWith('http')) {\r\n                const fullUrl = getFullUrl(product.downloadUrl);\r\n                console.log(`ðŸ“¥ Attempting download from: ${fullUrl}`);\r\n                \r\n                // Use fetch method for reliable download on GitLab Pages\r\n                try {\r\n                    const response = await fetch(fullUrl, { mode: 'cors' });\r\n                    if (response.ok) {\r\n                        const blob = await response.blob();\r\n                        const url = window.URL.createObjectURL(blob);\r\n                        const link = document.createElement('a');\r\n                        link.href = url;\r\n                        link.download = product.downloadFilename || 'law-of-universe.png';\r\n                        link.style.display = 'none';\r\n                        document.body.appendChild(link);\r\n                        link.click();\r\n                        \r\n                        // Clean up after a delay\r\n                        setTimeout(() => {\r\n                            document.body.removeChild(link);\r\n                            window.URL.revokeObjectURL(url);\r\n                        }, 100);\r\n                        \r\n                        console.log(`âœ… Download started: ${product.name} (${(blob.size / 1024).toFixed(2)} KB)`);\r\n                        return;\r\n                    } else {\r\n                        console.warn(`âš ï¸ Local file not accessible (${response.status}), trying fallback...`);\r\n                        throw new Error(`File not found: ${response.status}`);\r\n                    }\r\n                } catch (error) {\r\n                    console.warn('Direct download failed, trying fallback:', error);\r\n                    // Continue to fallback method below\r\n                }\r\n            }\r\n\r\n            // For external URLs or if local file failed, use fallback\r\n            const urlToFetch = product.fallbackUrl || \r\n                              (product.downloadUrl?.startsWith('http') ? product.downloadUrl : null);\r\n            \r\n            if (urlToFetch) {\r\n                console.log(`ðŸ“¥ Fetching from fallback URL: ${urlToFetch}`);\r\n                \r\n                try {\r\n                    // Fetch the image and create a download\r\n                    const response = await fetch(urlToFetch, { mode: 'cors' });\r\n                    if (!response.ok) {\r\n                        throw new Error(`Failed to fetch image: ${response.status} ${response.statusText}`);\r\n                    }\r\n\r\n                    const blob = await response.blob();\r\n                    console.log(`ðŸ“¦ Blob created: ${(blob.size / 1024).toFixed(2)} KB, type: ${blob.type}`);\r\n                    \r\n                    const url = window.URL.createObjectURL(blob);\r\n                    const link = document.createElement('a');\r\n                    link.href = url;\r\n                    link.download = product.downloadFilename || 'law-of-universe.png';\r\n                    link.style.display = 'none';\r\n                    document.body.appendChild(link);\r\n                    link.click();\r\n                    \r\n                    // Clean up after a delay\r\n                    setTimeout(() => {\r\n                        document.body.removeChild(link);\r\n                        window.URL.revokeObjectURL(url);\r\n                    }, 100);\r\n\r\n                    console.log(`âœ… Download started (fallback): ${product.name}`);\r\n                } catch (error) {\r\n                    console.error('Fallback download failed:', error);\r\n                    throw error;\r\n                }\r\n            } else {\r\n                alert(\r\n                    `Download file not configured.\\n\\nPlease ensure the file is available.\\n\\nProduct: ${product.name}`\r\n                );\r\n            }\r\n        } catch (error) {\r\n            console.error('Error downloading product:', error);\r\n            alert(\r\n                `Download failed. Please try again or contact support.\\n\\nError: ${error.message}\\n\\nTip: The file may still be processing on GitLab Pages. Please wait a moment and try again.`\r\n            );\r\n        }\r\n    }\r\n}\r\n\r\n// Initialize shop manager when DOM is ready\r\nif (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', () => {\r\n        window.shopManager = new ShopManager();\r\n    });\r\n} else {\r\n    window.shopManager = new ShopManager();\r\n}\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\space-wallpaper.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\stellar-ai-cli\\index.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'puterInstance' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":16,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":18,"suggestions":[{"messageId":"removeVar","data":{"varName":"puterInstance"},"fix":{"range":[465,490],"text":""},"desc":"Remove unused variable 'puterInstance'."}]},{"ruleId":"prefer-const","severity":1,"message":"'puterInstance' is never reassigned. Use 'const' instead.","line":16,"column":5,"nodeType":"Identifier","messageId":"useConst","endLine":16,"endColumn":18,"fix":{"range":[465,490],"text":"const puterInstance = null;"}},{"ruleId":"no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":50,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":20},{"ruleId":"max-lines-per-function","severity":1,"message":"Method 'initializeTools' has too many lines (276). Maximum allowed is 200.","line":83,"column":5,"nodeType":"MethodDefinition","messageId":"exceed","endLine":381,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":255,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":255,"endColumn":36},{"ruleId":"complexity","severity":1,"message":"Async method 'handleCommand' has a complexity of 38. Maximum allowed is 25.","line":452,"column":5,"nodeType":"FunctionExpression","messageId":"complex","endLine":452,"endColumn":24},{"ruleId":"max-statements","severity":1,"message":"Async method 'handleCommand' has too many statements (41). Maximum allowed is 40.","line":452,"column":24,"nodeType":"FunctionExpression","messageId":"exceed","endLine":588,"endColumn":6},{"ruleId":"complexity","severity":1,"message":"Async method 'handleLogin' has a complexity of 27. Maximum allowed is 25.","line":590,"column":5,"nodeType":"FunctionExpression","messageId":"complex","endLine":590,"endColumn":22},{"ruleId":"max-statements","severity":1,"message":"Async method 'handleLogin' has too many statements (75). Maximum allowed is 40.","line":590,"column":22,"nodeType":"FunctionExpression","messageId":"exceed","endLine":722,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":617,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":617,"endColumn":24},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":828,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":828,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":837,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":837,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":934,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":934,"endColumn":23},{"ruleId":"no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":1012,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":1012,"endColumn":24},{"ruleId":"complexity","severity":1,"message":"Async method 'callAIAPI' has a complexity of 32. Maximum allowed is 25.","line":1021,"column":5,"nodeType":"FunctionExpression","messageId":"complex","endLine":1021,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":1141,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":1141,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":1188,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":1188,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":1207,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":1207,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":1213,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":1213,"endColumn":20},{"ruleId":"max-depth","severity":1,"message":"Blocks are nested too deeply (6). Maximum allowed is 5.","line":1354,"column":29,"nodeType":"TryStatement","messageId":"tooDeeply","endLine":1371,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":20,"fixableErrorCount":0,"fixableWarningCount":1,"source":"#!/usr/bin/env node\r\n\r\n/**\r\n * Stellar AI CLI - Terminal Interface\r\n * Run AI chat locally with tool calling and file system integration\r\n */\r\n\r\nconst readline = require('readline'); // Built-in Node.js module\r\nconst fs = require('fs-extra');\r\nconst path = require('path');\r\nconst chalk = require('chalk');\r\nconst mime = require('mime-types');\r\nconst { exec } = require('child_process');\r\n\r\n// Initialize Puter.js (note: puter is a global from @heyputer/puter.js)\r\nlet puterInstance = null;\r\nlet puterInitialized = false;\r\n\r\nasync function initPuter() {\r\n    try {\r\n        // Try to load Puter.js Node.js SDK\r\n        const { init } = require('@heyputer/puter.js/src/init.cjs');\r\n        \r\n        // Check for saved auth token\r\n        const configPath = path.join(process.cwd(), '.stellar-ai-config.json');\r\n        let config = {};\r\n        if (await fs.pathExists(configPath)) {\r\n            config = JSON.parse(await fs.readFile(configPath, 'utf8'));\r\n        }\r\n        \r\n        // Initialize Puter with auth token if available\r\n        if (config.puterAuthToken) {\r\n            puter = init(config.puterAuthToken);\r\n            puterInitialized = true;\r\n            \r\n            // Verify token is still valid\r\n            if (puter.auth && puter.auth.isSignedIn && puter.auth.isSignedIn()) {\r\n                return true;\r\n            } else {\r\n                // Token might be expired, but still initialized\r\n                console.log(chalk.yellow('âš ï¸  Saved token may be expired. Use /login to re-authenticate.'));\r\n                return false;\r\n            }\r\n        } else {\r\n            // Initialize without auth (will need to login)\r\n            puter = init();\r\n            puterInitialized = true;\r\n            return false; // Not authenticated\r\n        }\r\n    } catch (_error) {\r\n        console.log(chalk.yellow('âš ï¸  Puter.js not available, using fallback mode'));\r\n        console.log(chalk.gray('   Install: npm install @heyputer/puter.js'));\r\n        puterInitialized = false;\r\n        return false;\r\n    }\r\n}\r\n\r\nclass StellarAICLI {\r\n    constructor() {\r\n        this.conversationHistory = [];\r\n        this.currentModel = 'sonnet-4.5';\r\n        this.availableModels = [\r\n            'sonnet-4.5',\r\n            'sonnet-4',\r\n            'opus-4',\r\n            'haiku-4',\r\n            'gpt-4o',\r\n            'gpt-4-turbo',\r\n            'gpt-3.5-turbo',\r\n            'gemini-pro',\r\n            'llama-3.1'\r\n        ];\r\n        this.agents = []; // Multi-agent support\r\n        this.activeTasks = new Map(); // Track parallel agent tasks\r\n        this.tools = this.initializeTools();\r\n        this.rl = null;\r\n        this.configPath = path.join(process.cwd(), '.stellar-ai-config.json');\r\n        this.puterAuthenticated = false;\r\n        this.loginAttempts = 0; // Track login attempts\r\n        this.loadConfig();\r\n    }\r\n\r\n    initializeTools() {\r\n        return {\r\n            // File System Tools\r\n            read_file: {\r\n                name: 'read_file',\r\n                description: 'Read the contents of a file. Provide the file path.',\r\n                parameters: {\r\n                    type: 'object',\r\n                    properties: {\r\n                        file_path: {\r\n                            type: 'string',\r\n                            description: 'The path to the file to read'\r\n                        }\r\n                    },\r\n                    required: ['file_path']\r\n                },\r\n                execute: async (params) => {\r\n                    try {\r\n                        const filePath = path.resolve(params.file_path);\r\n                        const content = await fs.readFile(filePath, 'utf8');\r\n                        return {\r\n                            success: true,\r\n                            content: content,\r\n                            size: content.length,\r\n                            path: filePath\r\n                        };\r\n                    } catch (error) {\r\n                        return {\r\n                            success: false,\r\n                            error: error.message\r\n                        };\r\n                    }\r\n                }\r\n            },\r\n            write_file: {\r\n                name: 'write_file',\r\n                description: 'Write content to a file. Creates the file if it doesn\\'t exist.',\r\n                parameters: {\r\n                    type: 'object',\r\n                    properties: {\r\n                        file_path: {\r\n                            type: 'string',\r\n                            description: 'The path to the file to write'\r\n                        },\r\n                        content: {\r\n                            type: 'string',\r\n                            description: 'The content to write to the file'\r\n                        }\r\n                    },\r\n                    required: ['file_path', 'content']\r\n                },\r\n                execute: async (params) => {\r\n                    try {\r\n                        const filePath = path.resolve(params.file_path);\r\n                        await fs.ensureDir(path.dirname(filePath));\r\n                        await fs.writeFile(filePath, params.content, 'utf8');\r\n                        return {\r\n                            success: true,\r\n                            message: `File written successfully: ${filePath}`,\r\n                            path: filePath\r\n                        };\r\n                    } catch (error) {\r\n                        return {\r\n                            success: false,\r\n                            error: error.message\r\n                        };\r\n                    }\r\n                }\r\n            },\r\n            list_files: {\r\n                name: 'list_files',\r\n                description: 'List files and directories in a given path.',\r\n                parameters: {\r\n                    type: 'object',\r\n                    properties: {\r\n                        directory_path: {\r\n                            type: 'string',\r\n                            description: 'The directory path to list (defaults to current directory)'\r\n                        },\r\n                        recursive: {\r\n                            type: 'boolean',\r\n                            description: 'Whether to list recursively (default: false)'\r\n                        }\r\n                    },\r\n                    required: []\r\n                },\r\n                execute: async (params) => {\r\n                    try {\r\n                        const dirPath = params.directory_path ? path.resolve(params.directory_path) : process.cwd();\r\n                        // const recursive = params.recursive || false; // Unused\r\n                        \r\n                        if (!await fs.pathExists(dirPath)) {\r\n                            return {\r\n                                success: false,\r\n                                error: 'Directory does not exist'\r\n                            };\r\n                        }\r\n\r\n                        const stats = await fs.stat(dirPath);\r\n                        if (!stats.isDirectory()) {\r\n                            return {\r\n                                success: false,\r\n                                error: 'Path is not a directory'\r\n                            };\r\n                        }\r\n\r\n                        const items = await fs.readdir(dirPath);\r\n                        const result = [];\r\n\r\n                        for (const item of items) {\r\n                            const itemPath = path.join(dirPath, item);\r\n                            const stat = await fs.stat(itemPath);\r\n                            result.push({\r\n                                name: item,\r\n                                path: itemPath,\r\n                                type: stat.isDirectory() ? 'directory' : 'file',\r\n                                size: stat.size,\r\n                                modified: stat.mtime\r\n                            });\r\n                        }\r\n\r\n                        return {\r\n                            success: true,\r\n                            items: result,\r\n                            count: result.length,\r\n                            path: dirPath\r\n                        };\r\n                    } catch (error) {\r\n                        return {\r\n                            success: false,\r\n                            error: error.message\r\n                        };\r\n                    }\r\n                }\r\n            },\r\n            analyze_image: {\r\n                name: 'analyze_image',\r\n                description: 'Analyze an image file. Returns image metadata and can extract text if OCR is available.',\r\n                parameters: {\r\n                    type: 'object',\r\n                    properties: {\r\n                        image_path: {\r\n                            type: 'string',\r\n                            description: 'The path to the image file'\r\n                        }\r\n                    },\r\n                    required: ['image_path']\r\n                },\r\n                execute: async (params) => {\r\n                    try {\r\n                        const imagePath = path.resolve(params.image_path);\r\n                        \r\n                        if (!await fs.pathExists(imagePath)) {\r\n                            return {\r\n                                success: false,\r\n                                error: 'Image file does not exist'\r\n                            };\r\n                        }\r\n\r\n                        const stats = await fs.stat(imagePath);\r\n                        const mimeType = mime.lookup(imagePath);\r\n                        \r\n                        // Try to get image dimensions if sharp is available\r\n                        let dimensions = null;\r\n                        try {\r\n                            const sharp = require('sharp');\r\n                            const metadata = await sharp(imagePath).metadata();\r\n                            dimensions = {\r\n                                width: metadata.width,\r\n                                height: metadata.height,\r\n                                format: metadata.format\r\n                            };\r\n                        } catch (_e) {\r\n                            // Sharp not available or error\r\n                        }\r\n\r\n                        return {\r\n                            success: true,\r\n                            path: imagePath,\r\n                            size: stats.size,\r\n                            mimeType: mimeType,\r\n                            dimensions: dimensions,\r\n                            modified: stats.mtime\r\n                        };\r\n                    } catch (error) {\r\n                        return {\r\n                            success: false,\r\n                            error: error.message\r\n                        };\r\n                    }\r\n                }\r\n            },\r\n            execute_command: {\r\n                name: 'execute_command',\r\n                description: 'Execute a shell command. Use with caution. Only safe commands are allowed.',\r\n                parameters: {\r\n                    type: 'object',\r\n                    properties: {\r\n                        command: {\r\n                            type: 'string',\r\n                            description: 'The shell command to execute'\r\n                        }\r\n                    },\r\n                    required: ['command']\r\n                },\r\n                execute: async (params) => {\r\n                    try {\r\n                        const { exec } = require('child_process');\r\n                        const { promisify } = require('util');\r\n                        const execAsync = promisify(exec);\r\n                        \r\n                        // Security: Block dangerous commands\r\n                        const dangerousCommands = ['rm -rf', 'del /f', 'format', 'mkfs'];\r\n                        const lowerCommand = params.command.toLowerCase();\r\n                        \r\n                        if (dangerousCommands.some(cmd => lowerCommand.includes(cmd))) {\r\n                            return {\r\n                                success: false,\r\n                                error: 'Command blocked for security reasons'\r\n                            };\r\n                        }\r\n\r\n                        const { stdout, stderr } = await execAsync(params.command, {\r\n                            cwd: process.cwd(),\r\n                            maxBuffer: 1024 * 1024 * 10 // 10MB\r\n                        });\r\n\r\n                        return {\r\n                            success: true,\r\n                            stdout: stdout,\r\n                            stderr: stderr || null\r\n                        };\r\n                    } catch (error) {\r\n                        return {\r\n                            success: false,\r\n                            error: error.message,\r\n                            stderr: error.stderr || null\r\n                        };\r\n                    }\r\n                }\r\n            },\r\n            search_files: {\r\n                name: 'search_files',\r\n                description: 'Search for files by name pattern in a directory.',\r\n                parameters: {\r\n                    type: 'object',\r\n                    properties: {\r\n                        pattern: {\r\n                            type: 'string',\r\n                            description: 'The file name pattern to search for (supports wildcards)'\r\n                        },\r\n                        directory_path: {\r\n                            type: 'string',\r\n                            description: 'The directory to search in (defaults to current directory)'\r\n                        }\r\n                    },\r\n                    required: ['pattern']\r\n                },\r\n                execute: async (params) => {\r\n                    try {\r\n                        const dirPath = params.directory_path ? path.resolve(params.directory_path) : process.cwd();\r\n                        const pattern = params.pattern;\r\n                        \r\n                        // Simple glob-like search\r\n                        const items = await fs.readdir(dirPath);\r\n                        const matches = items.filter(item => {\r\n                            // Convert pattern to regex\r\n                            const regex = new RegExp(pattern.replace(/\\*/g, '.*').replace(/\\?/g, '.'), 'i');\r\n                            return regex.test(item);\r\n                        });\r\n\r\n                        const results = [];\r\n                        for (const match of matches) {\r\n                            const itemPath = path.join(dirPath, match);\r\n                            const stat = await fs.stat(itemPath);\r\n                            results.push({\r\n                                name: match,\r\n                                path: itemPath,\r\n                                type: stat.isDirectory() ? 'directory' : 'file',\r\n                                size: stat.size\r\n                            });\r\n                        }\r\n\r\n                        return {\r\n                            success: true,\r\n                            matches: results,\r\n                            count: results.length,\r\n                            pattern: pattern\r\n                        };\r\n                    } catch (error) {\r\n                        return {\r\n                            success: false,\r\n                            error: error.message\r\n                        };\r\n                    }\r\n                }\r\n            }\r\n        };\r\n    }\r\n\r\n    async init() {\r\n        // Enhanced welcome screen\r\n        console.clear();\r\n        console.log(chalk.cyan.bold('\\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—'));\r\n        console.log(chalk.cyan.bold('â•‘                                                           â•‘'));\r\n        console.log(chalk.cyan.bold('â•‘') + chalk.white.bold('   ðŸŒŸ  STELLAR AI - Terminal Interface  ðŸŒŸ   ') + chalk.cyan.bold('â•‘'));\r\n        console.log(chalk.cyan.bold('â•‘                                                           â•‘'));\r\n        console.log(chalk.cyan.bold('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\n'));\r\n        \r\n        console.log(chalk.gray('   Your intelligent cosmic assistant with tool calling'));\r\n        console.log(chalk.gray(`   Current directory: ${chalk.yellow(process.cwd())}\\n`));\r\n\r\n        // Initialize Puter.js with better UI\r\n        process.stdout.write(chalk.blue('   ðŸ”Œ Initializing Puter.js'));\r\n        const hasAuth = await initPuter();\r\n        process.stdout.write('\\r' + ' '.repeat(50) + '\\r');\r\n        \r\n        if (puterInitialized) {\r\n            if (hasAuth && puter && puter.auth) {\r\n                this.puterAuthenticated = puter.auth.isSignedIn();\r\n                if (this.puterAuthenticated) {\r\n                    console.log(chalk.green('   âœ… Puter.js authenticated'));\r\n                } else {\r\n                    console.log(chalk.yellow('   âš ï¸  Puter.js not authenticated. Use /login to sign in'));\r\n                }\r\n            } else {\r\n                console.log(chalk.yellow('   âš ï¸  Puter.js initialized but not authenticated. Use /login to sign in'));\r\n            }\r\n        } else {\r\n            console.log(chalk.yellow('   âš ï¸  Puter.js not available. Install: npm install @heyputer/puter.js'));\r\n            console.log(chalk.gray('      Using fallback mode (limited functionality)'));\r\n        }\r\n\r\n        console.log(chalk.cyan('\\n   ðŸ’¡ Quick Tips:'));\r\n        console.log(chalk.gray('      â€¢ Type a message to chat'));\r\n        console.log(chalk.gray('      â€¢ Use /help for commands'));\r\n        console.log(chalk.gray('      â€¢ Use /agent task to run parallel tasks'));\r\n        console.log(chalk.gray('      â€¢ Include file paths in messages for file operations\\n'));\r\n\r\n        this.rl = readline.createInterface({\r\n            input: process.stdin,\r\n            output: process.stdout,\r\n            prompt: chalk.cyan('stellar-ai> ')\r\n        });\r\n\r\n        this.rl.on('line', async (input) => {\r\n            const trimmed = input.trim();\r\n            \r\n            if (trimmed === '') {\r\n                this.rl.prompt();\r\n                return;\r\n            }\r\n\r\n            // Handle commands\r\n            if (trimmed.startsWith('/')) {\r\n                await this.handleCommand(trimmed);\r\n            } else {\r\n                await this.handleMessage(trimmed);\r\n            }\r\n        });\r\n\r\n        this.rl.on('close', () => {\r\n            console.log(chalk.yellow('\\nðŸ‘‹ Goodbye!'));\r\n            process.exit(0);\r\n        });\r\n\r\n        this.rl.prompt();\r\n    }\r\n\r\n    async handleCommand(command) {\r\n        const parts = command.split(' ');\r\n        const cmd = parts[0].substring(1).toLowerCase();\r\n        const args = parts.slice(1);\r\n\r\n        switch (cmd) {\r\n            case 'model':\r\n            case 'm':\r\n                if (args.length > 0) {\r\n                    const model = args[0];\r\n                    if (this.availableModels.includes(model)) {\r\n                        this.currentModel = model;\r\n                        this.saveConfig();\r\n                        console.log(chalk.green(`âœ“ Model changed to: ${model}`));\r\n                    } else {\r\n                        console.log(chalk.red(`âœ— Invalid model. Available: ${this.availableModels.join(', ')}`));\r\n                    }\r\n                } else {\r\n                    console.log(chalk.cyan(`Current model: ${this.currentModel}`));\r\n                    console.log(chalk.gray(`Available models: ${this.availableModels.join(', ')}`));\r\n                }\r\n                break;\r\n\r\n            case 'clear':\r\n            case 'c':\r\n                this.conversationHistory = [];\r\n                console.log(chalk.green('âœ“ Conversation history cleared'));\r\n                break;\r\n\r\n            case 'history':\r\n            case 'h':\r\n                console.log(chalk.cyan('\\nðŸ“œ Conversation History:'));\r\n                this.conversationHistory.forEach((msg, i) => {\r\n                    const role = msg.role === 'user' ? chalk.blue('You') : chalk.green('AI');\r\n                    const preview = msg.content.substring(0, 60) + (msg.content.length > 60 ? '...' : '');\r\n                    console.log(chalk.gray(`  ${i + 1}. [${role}] ${preview}`));\r\n                });\r\n                console.log('');\r\n                break;\r\n\r\n            case 'tools':\r\n            case 't':\r\n                console.log(chalk.cyan('\\nðŸ”§ Available Tools:'));\r\n                Object.keys(this.tools).forEach(toolName => {\r\n                    const tool = this.tools[toolName];\r\n                    console.log(chalk.gray(`  â€¢ ${toolName}: ${tool.description}`));\r\n                });\r\n                console.log('');\r\n                break;\r\n\r\n            case 'agent':\r\n            case 'a':\r\n                if (args.length > 0 && args[0] === 'add') {\r\n                    // Add a new agent\r\n                    const agentName = args[1] || `agent-${this.agents.length + 1}`;\r\n                    const agentModel = args[2] || this.currentModel;\r\n                    this.agents.push({\r\n                        name: agentName,\r\n                        model: agentModel,\r\n                        history: [],\r\n                        id: Date.now() + Math.random()\r\n                    });\r\n                    console.log(chalk.green(`âœ“ Agent \"${agentName}\" added with model ${agentModel}`));\r\n                } else if (args.length > 0 && args[0] === 'list') {\r\n                    console.log(chalk.cyan('\\nðŸ¤– Active Agents:'));\r\n                    if (this.agents.length === 0) {\r\n                        console.log(chalk.gray('  No agents active. Use /agent add [name] [model] to add one.'));\r\n                    } else {\r\n                        this.agents.forEach((agent, i) => {\r\n                            const hasTask = this.activeTasks.has(agent.id);\r\n                            const status = hasTask ? chalk.yellow(' [Working]') : chalk.green(' [Idle]');\r\n                            console.log(chalk.gray(`  ${i + 1}. ${agent.name} (${agent.model})${status}`));\r\n                        });\r\n                    }\r\n                    console.log('');\r\n                } else if (args.length > 0 && args[0] === 'remove' || args[0] === 'rm') {\r\n                    const agentName = args[1];\r\n                    const index = this.agents.findIndex(a => a.name === agentName);\r\n                    if (index !== -1) {\r\n                        this.agents.splice(index, 1);\r\n                        console.log(chalk.green(`âœ“ Agent \"${agentName}\" removed`));\r\n                    } else {\r\n                        console.log(chalk.red(`âœ— Agent \"${agentName}\" not found`));\r\n                    }\r\n                } else if (args.length > 0 && args[0] === 'task' || args[0] === 't') {\r\n                    // Parallel task execution: /agent task [agent1,agent2,...] [task]\r\n                    if (args.length < 3) {\r\n                        console.log(chalk.yellow('Usage: /agent task [agent1,agent2,...] [task description]'));\r\n                        console.log(chalk.gray('   Example: /agent task researcher,coder \"Analyze the codebase and write tests\"'));\r\n                    } else {\r\n                        const agentNames = args[1].split(',').map(n => n.trim());\r\n                        const task = args.slice(2).join(' ');\r\n                        await this.executeParallelTask(agentNames, task);\r\n                    }\r\n                } else {\r\n                    console.log(chalk.cyan('\\nðŸ¤– Agent Commands:'));\r\n                    console.log(chalk.gray('  /agent add [name] [model]  - Add a new agent'));\r\n                    console.log(chalk.gray('  /agent list                 - List active agents'));\r\n                    console.log(chalk.gray('  /agent remove [name]        - Remove an agent'));\r\n                    console.log(chalk.gray('  /agent task [agents] [task] - Execute task with multiple agents in parallel'));\r\n                    console.log(chalk.gray('    Example: /agent task researcher,coder \"Analyze and document\"'));\r\n                    console.log('');\r\n                }\r\n                break;\r\n\r\n            case 'login':\r\n            case 'l':\r\n                await this.handleLogin();\r\n                break;\r\n\r\n            case 'logout':\r\n                await this.handleLogout();\r\n                break;\r\n\r\n            case 'auth':\r\n            case 'status':\r\n                this.showAuthStatus();\r\n                break;\r\n\r\n            case 'help':\r\n            case '?':\r\n                this.showHelp();\r\n                break;\r\n\r\n            case 'exit':\r\n            case 'quit':\r\n            case 'q':\r\n                this.rl.close();\r\n                return;\r\n\r\n            default:\r\n                console.log(chalk.red(`âœ— Unknown command: ${cmd}`));\r\n                console.log(chalk.yellow('Type /help for available commands'));\r\n        }\r\n\r\n        this.rl.prompt();\r\n    }\r\n\r\n    async handleLogin() {\r\n        if (!puterInitialized || !puter) {\r\n            console.log(chalk.red('âœ— Puter.js is not available. Install: npm install @heyputer/puter.js'));\r\n            return;\r\n        }\r\n\r\n        // Check if already authenticated first\r\n        if (puter.auth && puter.auth.isSignedIn && puter.auth.isSignedIn()) {\r\n            console.log(chalk.green('âœ… Already authenticated!'));\r\n            await this.saveAuthentication();\r\n            this.puterAuthenticated = true;\r\n            return;\r\n        }\r\n\r\n        // Check for saved token\r\n        const config = await this.loadConfigData();\r\n        if (config.puterAuthToken) {\r\n            try {\r\n                const { init } = require('@heyputer/puter.js/src/init.cjs');\r\n                const testPuter = init(config.puterAuthToken);\r\n                if (testPuter.auth && testPuter.auth.isSignedIn && testPuter.auth.isSignedIn()) {\r\n                    console.log(chalk.green('âœ… Found valid saved token!'));\r\n                    puter = testPuter;\r\n                    await this.saveAuthentication();\r\n                    this.puterAuthenticated = true;\r\n                    return;\r\n                }\r\n            } catch (_e) {\r\n                // Token invalid, continue with login\r\n            }\r\n        }\r\n\r\n        // Track login attempts to prevent infinite retries\r\n        // Use a static counter that persists across login calls\r\n        if (!StellarAICLI.loginAttempts) {\r\n            StellarAICLI.loginAttempts = 0;\r\n        }\r\n        \r\n        if (StellarAICLI.loginAttempts >= 3) {\r\n            console.log(chalk.red('\\nâœ— Maximum login attempts (3) reached.'));\r\n            console.log(chalk.yellow('   Please copy your token from the Stellar AI web page'));\r\n            console.log(chalk.yellow('   and add it to .stellar-ai-config.json as \"puterAuthToken\"'));\r\n            console.log(chalk.gray('   Or wait a moment and try /login again\\n'));\r\n            // Don't reset here - let user wait or manually reset\r\n            return;\r\n        }\r\n\r\n        StellarAICLI.loginAttempts++;\r\n        this.loginAttempts = StellarAICLI.loginAttempts;\r\n\r\n        try {\r\n            console.log(chalk.blue('\\nðŸ” Signing in to Puter.js...'));\r\n            console.log(chalk.gray(`   Attempt ${StellarAICLI.loginAttempts}/3\\n`));\r\n            \r\n            if (puter.auth && puter.auth.signIn) {\r\n                // Try to get the auth URL first, then open browser manually\r\n                let authUrl = null;\r\n                \r\n                // Wrap signIn in a try-catch to handle environment-specific errors\r\n                try {\r\n                    // Try to get auth URL if available\r\n                    if (puter.auth.getAuthUrl) {\r\n                        authUrl = puter.auth.getAuthUrl();\r\n                    } else if (puter.auth.signInUrl) {\r\n                        authUrl = puter.auth.signInUrl;\r\n                    }\r\n                    \r\n                    // Open browser manually if we have a URL\r\n                    if (authUrl) {\r\n                        this.openBrowser(authUrl);\r\n                        // Wait a bit for browser to open\r\n                        await new Promise(resolve => setTimeout(resolve, 1000));\r\n                    }\r\n                    \r\n                    await puter.auth.signIn();\r\n                } catch (signInError) {\r\n                    // Handle specific errors like \"screen is not defined\" in headless environments\r\n                    if (signInError.message && signInError.message.includes('screen')) {\r\n                        // Try to open Puter.com manually\r\n                        console.log(chalk.yellow('âš ï¸  Opening browser manually...'));\r\n                        this.openBrowser('https://puter.com');\r\n                        console.log(chalk.gray('   Please complete authentication in the browser.'));\r\n                        console.log(chalk.gray('   Waiting for authentication...'));\r\n                        \r\n                        // Poll for authentication status - ONLY ONCE, max 3 attempts\r\n                        const authenticated = await this.pollForAuthentication(3, 2000);\r\n                        if (authenticated) {\r\n                            StellarAICLI.loginAttempts = 0; // Reset on success\r\n                            this.loginAttempts = 0;\r\n                            this.puterAuthenticated = true;\r\n                        }\r\n                        return; // Stop here, don't retry\r\n                    } else {\r\n                        throw signInError;\r\n                    }\r\n                }\r\n                \r\n                // Check if signed in immediately after signIn()\r\n                if (puter.auth.isSignedIn()) {\r\n                    await this.saveAuthentication();\r\n                    this.puterAuthenticated = true;\r\n                    StellarAICLI.loginAttempts = 0; // Reset on success\r\n                    this.loginAttempts = 0;\r\n                    console.log(chalk.green('âœ… Successfully signed in to Puter.js!'));\r\n                } else {\r\n                    // Only poll if signIn() didn't throw an error but also didn't authenticate\r\n                    // This should rarely happen, but if it does, poll ONCE\r\n                    console.log(chalk.yellow('âš ï¸  Waiting for browser authentication...'));\r\n                    const authenticated = await this.pollForAuthentication(3, 2000);\r\n                    if (authenticated) {\r\n                        StellarAICLI.loginAttempts = 0; // Reset on success\r\n                        this.loginAttempts = 0;\r\n                        this.puterAuthenticated = true;\r\n                    }\r\n                }\r\n            } else {\r\n                console.log(chalk.red('âœ— Authentication not available. Please check Puter.js installation.'));\r\n            }\r\n        } catch (error) {\r\n            // Provide more helpful error messages\r\n            if (error.message && error.message.includes('screen')) {\r\n                console.error(chalk.red('âœ— Login error: Browser authentication not available in this environment'));\r\n                // Try to open browser manually anyway\r\n                console.log(chalk.yellow('\\nðŸ’¡ Opening browser manually...'));\r\n                this.openBrowser('https://puter.com');\r\n                console.log(chalk.gray('   1. Complete authentication in the browser'));\r\n                console.log(chalk.gray('   2. Get your auth token from the Stellar AI web page'));\r\n                console.log(chalk.gray('   3. Add it to .stellar-ai-config.json as \"puterAuthToken\"'));\r\n            } else {\r\n                console.error(chalk.red(`âœ— Login error: ${error.message}`));\r\n            }\r\n        }\r\n    }\r\n    \r\n    openBrowser(url) {\r\n        const platform = process.platform;\r\n        let command;\r\n        \r\n        if (platform === 'win32') {\r\n            command = `start \"\" \"${url}\"`;\r\n        } else if (platform === 'darwin') {\r\n            command = `open \"${url}\"`;\r\n        } else {\r\n            // Linux and others\r\n            command = `xdg-open \"${url}\"`;\r\n        }\r\n        \r\n        exec(command, (error) => {\r\n            if (error) {\r\n                console.log(chalk.yellow(`âš ï¸  Could not open browser automatically. Please visit: ${url}`));\r\n            } else {\r\n                console.log(chalk.green(`âœ… Browser opened: ${url}`));\r\n            }\r\n        });\r\n    }\r\n    \r\n    async saveAuthentication() {\r\n        if (puter && puter.auth && puter.auth.isSignedIn()) {\r\n            this.puterAuthenticated = true;\r\n            \r\n            // Save auth token if available\r\n            const config = await this.loadConfigData();\r\n            if (puter.auth.getToken) {\r\n                config.puterAuthToken = puter.auth.getToken();\r\n            }\r\n            await this.saveConfigData(config);\r\n        }\r\n    }\r\n    \r\n    async pollForAuthentication(maxAttempts = 3, interval = 2000) {\r\n        // Poll only 3 times (6 seconds total) - stop if not authenticated\r\n        console.log(chalk.blue('   ðŸ”„ Checking authentication status...'));\r\n        console.log(chalk.gray('   Complete the sign-in process in your browser, then return here.'));\r\n        console.log(chalk.gray('   The CLI will check 3 times (6 seconds total).\\n'));\r\n        \r\n        for (let attempt = 1; attempt <= maxAttempts; attempt++) {\r\n            await new Promise(resolve => setTimeout(resolve, interval));\r\n            \r\n            // Check if Puter.js is now authenticated\r\n            if (puter && puter.auth && puter.auth.isSignedIn()) {\r\n                await this.saveAuthentication();\r\n                console.log(chalk.green('\\nâœ… Authentication successful!'));\r\n                console.log(chalk.green('   You are now signed in to Puter.js.'));\r\n                console.log(chalk.gray('   Your authentication token has been saved.'));\r\n                return true;\r\n            }\r\n            \r\n            console.log(chalk.gray(`   Attempt ${attempt}/${maxAttempts}...`));\r\n        }\r\n        \r\n        console.log(chalk.yellow('\\nâš ï¸  Authentication not detected after 3 attempts.'));\r\n        console.log(chalk.gray('   If you completed authentication in the browser:'));\r\n        console.log(chalk.gray('   1. Copy your token from the Stellar AI web page'));\r\n        console.log(chalk.gray('   2. Add it to .stellar-ai-config.json as \"puterAuthToken\"'));\r\n        console.log(chalk.gray('   3. Or run /login again to retry'));\r\n        return false;\r\n    }\r\n\r\n    async handleLogout() {\r\n        if (!puterInitialized || !puter) {\r\n            console.log(chalk.red('âœ— Puter.js is not available'));\r\n            return;\r\n        }\r\n\r\n        try {\r\n            if (puter.auth && puter.auth.signOut) {\r\n                puter.auth.signOut();\r\n                this.puterAuthenticated = false;\r\n                \r\n                // Remove auth token from config\r\n                const config = await this.loadConfigData();\r\n                delete config.puterAuthToken;\r\n                await this.saveConfigData(config);\r\n                \r\n                console.log(chalk.green('âœ… Signed out from Puter.js'));\r\n            } else {\r\n                console.log(chalk.yellow('âš ï¸  Already signed out'));\r\n            }\r\n        } catch (error) {\r\n            console.error(chalk.red(`âœ— Logout error: ${error.message}`));\r\n        }\r\n    }\r\n\r\n    showAuthStatus() {\r\n        console.log(chalk.cyan('\\nðŸ” Authentication Status:'));\r\n        console.log(chalk.gray(`   Puter.js: ${puterInitialized ? chalk.green('âœ“ Available') : chalk.red('âœ— Not available')}`));\r\n        console.log(chalk.gray(`   Authenticated: ${this.puterAuthenticated ? chalk.green('âœ“ Yes') : chalk.red('âœ— No')}`));\r\n        if (!this.puterAuthenticated && puterInitialized) {\r\n            console.log(chalk.yellow('\\n   ðŸ’¡ Use /login to sign in to Puter.js'));\r\n        }\r\n        console.log('');\r\n    }\r\n\r\n    async loadConfigData() {\r\n        try {\r\n            if (await fs.pathExists(this.configPath)) {\r\n                return JSON.parse(await fs.readFile(this.configPath, 'utf8'));\r\n            }\r\n        } catch (_e) {\r\n            // Ignore errors\r\n        }\r\n        return {};\r\n    }\r\n\r\n    async saveConfigData(config) {\r\n        try {\r\n            await fs.writeFile(this.configPath, JSON.stringify(config, null, 2), 'utf8');\r\n        } catch (_e) {\r\n            // Ignore errors\r\n        }\r\n    }\r\n\r\n    showHelp() {\r\n        console.log(chalk.cyan('\\nðŸ“– Available Commands:'));\r\n        console.log(chalk.gray('  /model [name]     - Change AI model'));\r\n        console.log(chalk.gray('  /login            - Sign in to Puter.js'));\r\n        console.log(chalk.gray('  /logout           - Sign out from Puter.js'));\r\n        console.log(chalk.gray('  /auth              - Show authentication status'));\r\n        console.log(chalk.gray('  /clear             - Clear conversation history'));\r\n        console.log(chalk.gray('  /history           - Show conversation history'));\r\n        console.log(chalk.gray('  /tools             - List available tools'));\r\n        console.log(chalk.gray('  /agent add [name]  - Add a new agent'));\r\n        console.log(chalk.gray('  /agent list        - List active agents'));\r\n        console.log(chalk.gray('  /agent remove [n]  - Remove an agent'));\r\n        console.log(chalk.gray('  /agent task [a] [t] - Run parallel task with agents'));\r\n        console.log(chalk.gray('  /help              - Show this help'));\r\n        console.log(chalk.gray('  /exit              - Exit Stellar AI'));\r\n        console.log(chalk.gray('\\nðŸ’¡ Tip: You can add file paths and image paths to your messages!'));\r\n        console.log(chalk.gray('   Example: \"Read the file at ./data.txt\"'));\r\n        console.log(chalk.gray('   Example: \"Analyze the image at ./photo.jpg\"\\n'));\r\n    }\r\n\r\n    async handleMessage(message) {\r\n        // Check if message contains file paths\r\n        const filePaths = this.extractFilePaths(message);\r\n        \r\n        // Add user message to history\r\n        this.conversationHistory.push({\r\n            role: 'user',\r\n            content: message,\r\n            filePaths: filePaths,\r\n            timestamp: new Date().toISOString()\r\n        });\r\n\r\n        // Show interactive processing indicator\r\n        const spinner = ['â ‹', 'â ™', 'â ¹', 'â ¸', 'â ¼', 'â ´', 'â ¦', 'â §', 'â ‡', 'â '];\r\n        let spinnerIndex = 0;\r\n        const spinnerInterval = setInterval(() => {\r\n            process.stdout.write(`\\r${chalk.blue(spinner[spinnerIndex])} ${chalk.gray('Processing')} ${chalk.gray('.'.repeat((spinnerIndex % 3) + 1))}   `);\r\n            spinnerIndex = (spinnerIndex + 1) % spinner.length;\r\n        }, 100);\r\n\r\n        try {\r\n            // Get AI response with tool calling\r\n            const response = await this.getAIResponse(message, filePaths);\r\n            \r\n            clearInterval(spinnerInterval);\r\n            process.stdout.write('\\r' + ' '.repeat(50) + '\\r'); // Clear spinner\r\n            \r\n            // Add AI response to history\r\n            this.conversationHistory.push({\r\n                role: 'assistant',\r\n                content: response.text,\r\n                toolsUsed: response.toolsUsed || [],\r\n                timestamp: new Date().toISOString()\r\n            });\r\n\r\n            // Enhanced output formatting\r\n            console.log(chalk.cyan('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”'));\r\n            console.log(chalk.green.bold('ðŸ¤– Stellar AI:'));\r\n            console.log(chalk.white(response.text));\r\n            \r\n            if (response.toolsUsed && response.toolsUsed.length > 0) {\r\n                console.log(chalk.gray(`\\nðŸ”§ Tools used: ${chalk.yellow(response.toolsUsed.join(', '))}`));\r\n            }\r\n            console.log(chalk.cyan('â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n'));\r\n\r\n        } catch (error) {\r\n            clearInterval(spinnerInterval);\r\n            process.stdout.write('\\r' + ' '.repeat(50) + '\\r'); // Clear spinner\r\n            console.error(chalk.red(`\\nâœ— Error: ${error.message}`));\r\n            console.log('');\r\n        }\r\n\r\n        this.rl.prompt();\r\n    }\r\n\r\n    extractFilePaths(message) {\r\n        // Simple regex to find file paths\r\n        const pathPattern = /(?:^|\\s)([./]?[^\\s]+\\.(?:txt|js|json|py|jpg|jpeg|png|gif|pdf|md|html|css|xml|yaml|yml|csv|log|sh|bat|exe|zip|tar|gz))/gi;\r\n        const matches = message.match(pathPattern);\r\n        return matches ? matches.map(m => m.trim()) : [];\r\n    }\r\n\r\n    async getAIResponse(message, filePaths = []) {\r\n        // Load file contents if file paths are provided\r\n        const fileContents = {};\r\n        for (const filePath of filePaths) {\r\n            try {\r\n                const resolvedPath = path.resolve(filePath);\r\n                if (await fs.pathExists(resolvedPath)) {\r\n                    const content = await fs.readFile(resolvedPath, 'utf8');\r\n                    fileContents[filePath] = content.substring(0, 10000); // Limit to 10KB per file\r\n                }\r\n            } catch (e) {\r\n                // Ignore errors\r\n            }\r\n        }\r\n\r\n        // Prepare messages for AI\r\n        const messages = this.conversationHistory.slice(-10).map(msg => ({\r\n            role: msg.role,\r\n            content: msg.content\r\n        }));\r\n\r\n        // Add file contents to the last message if available\r\n        if (Object.keys(fileContents).length > 0) {\r\n            const lastMsg = messages[messages.length - 1];\r\n            lastMsg.content += '\\n\\nFile contents:\\n' + \r\n                Object.entries(fileContents).map(([path, content]) => \r\n                    `\\n--- ${path} ---\\n${content}`\r\n                ).join('\\n');\r\n        }\r\n\r\n        // Prepare tools for AI\r\n        const tools = Object.values(this.tools).map(tool => ({\r\n            type: 'function',\r\n            function: {\r\n                name: tool.name,\r\n                description: tool.description,\r\n                parameters: tool.parameters\r\n            }\r\n        }));\r\n\r\n        try {\r\n            // Try to use Puter.js API or fallback\r\n            const response = await this.callAIAPI(messages, tools);\r\n            \r\n            // Check if AI wants to use tools\r\n            if (response.tool_calls && response.tool_calls.length > 0) {\r\n                const toolsUsed = [];\r\n                const toolResults = [];\r\n\r\n                for (const toolCall of response.tool_calls) {\r\n                    const tool = this.tools[toolCall.function.name];\r\n                    if (tool) {\r\n                        try {\r\n                            const params = JSON.parse(toolCall.function.arguments || '{}');\r\n                            const result = await tool.execute(params);\r\n                            toolResults.push({\r\n                                tool_call_id: toolCall.id,\r\n                                role: 'tool',\r\n                                name: toolCall.function.name,\r\n                                content: JSON.stringify(result)\r\n                            });\r\n                            toolsUsed.push(toolCall.function.name);\r\n                        } catch (error) {\r\n                            toolResults.push({\r\n                                tool_call_id: toolCall.id,\r\n                                role: 'tool',\r\n                                name: toolCall.function.name,\r\n                                content: JSON.stringify({ success: false, error: error.message })\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Get final response with tool results\r\n                const finalMessages = [...messages, response, ...toolResults];\r\n                const finalResponse = await this.callAIAPI(finalMessages, tools);\r\n                \r\n                return {\r\n                    text: finalResponse.content || finalResponse.message || 'Tool execution completed.',\r\n                    toolsUsed: toolsUsed\r\n                };\r\n            }\r\n\r\n            return {\r\n                text: response.content || response.message || response.text || 'I apologize, but I could not generate a response.',\r\n                toolsUsed: []\r\n            };\r\n\r\n        } catch (_error) {\r\n            // Fallback response\r\n            return {\r\n                text: this.getFallbackResponse(message),\r\n                toolsUsed: []\r\n            };\r\n        }\r\n    }\r\n\r\n    async callAIAPI(messages, tools) {\r\n        // Try Puter.js first if available and authenticated\r\n        if (puterInitialized && puter && this.puterAuthenticated && puter.ai) {\r\n            try {\r\n                // Prepare tools for Puter.js\r\n                const puterTools = Object.values(tools).map(tool => ({\r\n                    type: 'function',\r\n                    function: {\r\n                        name: tool.name,\r\n                        description: tool.description,\r\n                        parameters: tool.parameters\r\n                    }\r\n                }));\r\n\r\n                // Prepare messages for Puter.js\r\n                const puterMessages = messages.map(msg => {\r\n                    if (msg.role === 'tool') {\r\n                        // Convert tool results to Puter format\r\n                        return {\r\n                            role: 'tool',\r\n                            tool_call_id: msg.tool_call_id,\r\n                            name: msg.name,\r\n                            content: msg.content\r\n                        };\r\n                    }\r\n                    return {\r\n                        role: msg.role,\r\n                        content: msg.content\r\n                    };\r\n                });\r\n\r\n                // Call Puter.js AI with tool calling\r\n                let response;\r\n                if (puter.ai.chat) {\r\n                    response = await puter.ai.chat(puterMessages, {\r\n                        model: this.currentModel,\r\n                        tools: puterTools.length > 0 ? puterTools : undefined\r\n                    });\r\n                } else if (puter.ai.complete) {\r\n                    response = await puter.ai.complete({\r\n                        messages: puterMessages,\r\n                        model: this.currentModel,\r\n                        tools: puterTools.length > 0 ? puterTools : undefined\r\n                    });\r\n                } else {\r\n                    throw new Error('Puter.js AI methods not available');\r\n                }\r\n\r\n                // Handle tool calls if present\r\n                if (response.tool_calls && response.tool_calls.length > 0) {\r\n                    const toolsUsed = [];\r\n                    const toolResults = [];\r\n\r\n                    for (const toolCall of response.tool_calls) {\r\n                        const tool = this.tools[toolCall.function.name];\r\n                        if (tool) {\r\n                            try {\r\n                                const params = JSON.parse(toolCall.function.arguments || '{}');\r\n                                const result = await tool.execute(params);\r\n                                \r\n                                toolResults.push({\r\n                                    tool_call_id: toolCall.id,\r\n                                    role: 'tool',\r\n                                    name: toolCall.function.name,\r\n                                    content: JSON.stringify(result)\r\n                                });\r\n                                toolsUsed.push(toolCall.function.name);\r\n                            } catch (error) {\r\n                                toolResults.push({\r\n                                    tool_call_id: toolCall.id,\r\n                                    role: 'tool',\r\n                                    name: toolCall.function.name,\r\n                                    content: JSON.stringify({ success: false, error: error.message })\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // Get final response with tool results\r\n                    const finalMessages = [...puterMessages, response, ...toolResults];\r\n                    const finalResponse = await puter.ai.chat(finalMessages, {\r\n                        model: this.currentModel\r\n                    });\r\n\r\n                    return {\r\n                        content: finalResponse.content || finalResponse.message || finalResponse.text || 'Tool execution completed.',\r\n                        toolsUsed: toolsUsed\r\n                    };\r\n                }\r\n\r\n                // Return response without tool calls\r\n                return {\r\n                    content: response.content || response.message || response.text || 'I apologize, but I could not generate a response.',\r\n                    toolsUsed: []\r\n                };\r\n\r\n            } catch (error) {\r\n                console.error(chalk.red(`\\nâš ï¸  Puter.js error: ${error.message}`));\r\n                console.log(chalk.gray('   Falling back to local response...\\n'));\r\n                // Fall through to fallback\r\n            }\r\n        }\r\n\r\n        // Fallback: Try to use tools heuristically\r\n        const lastMessage = messages[messages.length - 1]?.content || '';\r\n        \r\n        // Simple heuristic: if message mentions files, try to use file tools\r\n        if (lastMessage.toLowerCase().includes('read') && lastMessage.toLowerCase().includes('file')) {\r\n            const filePathMatch = lastMessage.match(/(?:^|\\s)([^\\s]+\\.(?:txt|js|json|py|md|html|css))/i);\r\n            if (filePathMatch) {\r\n                const filePath = filePathMatch[1].trim();\r\n                try {\r\n                    const tool = this.tools.read_file;\r\n                    const result = await tool.execute({ file_path: filePath });\r\n                    if (result.success) {\r\n                        return {\r\n                            content: `I read the file \"${filePath}\". Here's what it contains:\\n\\n${result.content.substring(0, 500)}${result.content.length > 500 ? '...' : ''}`,\r\n                            toolsUsed: ['read_file']\r\n                        };\r\n                    }\r\n                } catch (e) {\r\n                    // Continue to fallback\r\n                }\r\n            }\r\n        }\r\n\r\n        // Final fallback response\r\n        if (!puterInitialized || !this.puterAuthenticated) {\r\n            return {\r\n                content: this.getFallbackResponse(lastMessage) + '\\n\\nðŸ’¡ Tip: Use /login to authenticate with Puter.js for full AI capabilities!',\r\n                toolsUsed: []\r\n            };\r\n        }\r\n\r\n        return {\r\n            content: this.getFallbackResponse(lastMessage),\r\n            toolsUsed: []\r\n        };\r\n    }\r\n\r\n    getFallbackResponse(message) {\r\n        const lower = message.toLowerCase();\r\n        \r\n        if (lower.includes('file') && lower.includes('read')) {\r\n            return 'I can help you read files! Try: \"Read the file at ./example.txt\" or provide a file path in your message.';\r\n        }\r\n        \r\n        if (lower.includes('image') || lower.includes('photo') || lower.includes('picture')) {\r\n            return 'I can analyze images! Try: \"Analyze the image at ./photo.jpg\" or provide an image path.';\r\n        }\r\n        \r\n        if (lower.includes('list') && lower.includes('file')) {\r\n            return 'I can list files! Try: \"List files in ./directory\" or \"List files in the current directory\".';\r\n        }\r\n        \r\n        return `I understand you said: \"${message}\". I'm Stellar AI, your cosmic assistant! I can help you with file operations, image analysis, and more. Try using file paths in your messages, or type /tools to see what I can do.`;\r\n    }\r\n\r\n    loadConfig() {\r\n        try {\r\n            if (fs.existsSync(this.configPath)) {\r\n                const config = JSON.parse(fs.readFileSync(this.configPath, 'utf8'));\r\n                this.currentModel = config.model || this.currentModel;\r\n                if (config.history) {\r\n                    this.conversationHistory = config.history;\r\n                }\r\n            }\r\n        } catch (_e) {\r\n            // Ignore errors\r\n        }\r\n    }\r\n\r\n    saveConfig() {\r\n        try {\r\n            const config = {\r\n                model: this.currentModel,\r\n                history: this.conversationHistory.slice(-20) // Keep last 20 messages\r\n            };\r\n            \r\n            // Preserve auth token if it exists\r\n            if (fs.existsSync(this.configPath)) {\r\n                try {\r\n                    const existing = JSON.parse(fs.readFileSync(this.configPath, 'utf8'));\r\n                    if (existing.puterAuthToken) {\r\n                        config.puterAuthToken = existing.puterAuthToken;\r\n                    }\r\n                } catch (e) {\r\n                    // Ignore\r\n                }\r\n            }\r\n            \r\n            fs.writeFileSync(this.configPath, JSON.stringify(config, null, 2));\r\n        } catch (_e) {\r\n            // Ignore errors\r\n        }\r\n    }\r\n\r\n    async executeParallelTask(agentNames, task) {\r\n        // Find agents by name\r\n        const selectedAgents = this.agents.filter(agent => agentNames.includes(agent.name));\r\n        \r\n        if (selectedAgents.length === 0) {\r\n            console.log(chalk.red(`âœ— No agents found with names: ${agentNames.join(', ')}`));\r\n            console.log(chalk.yellow('   Use /agent list to see available agents'));\r\n            return;\r\n        }\r\n\r\n        console.log(chalk.cyan(`\\nðŸš€ Executing parallel task with ${selectedAgents.length} agent(s)...`));\r\n        console.log(chalk.gray(`   Task: ${task}\\n`));\r\n\r\n        // Create task promises for parallel execution\r\n        const taskPromises = selectedAgents.map(async (agent) => {\r\n            const taskId = Date.now() + Math.random();\r\n            this.activeTasks.set(agent.id, { taskId, startTime: Date.now(), task });\r\n            \r\n            try {\r\n                console.log(chalk.blue(`   ðŸ¤– ${agent.name} (${agent.model}) starting...`));\r\n                \r\n                // Create a message for this agent\r\n                const agentMessage = `As ${agent.name}, ${task}`;\r\n                \r\n                // Get AI response for this agent\r\n                const response = await this.getAIResponseForAgent(agent, agentMessage);\r\n                \r\n                this.activeTasks.delete(agent.id);\r\n                \r\n                console.log(chalk.green(`   âœ… ${agent.name} completed`));\r\n                \r\n                return {\r\n                    agent: agent.name,\r\n                    model: agent.model,\r\n                    response: response.text || response.content,\r\n                    toolsUsed: response.toolsUsed || []\r\n                };\r\n            } catch (error) {\r\n                this.activeTasks.delete(agent.id);\r\n                console.log(chalk.red(`   âœ— ${agent.name} failed: ${error.message}`));\r\n                return {\r\n                    agent: agent.name,\r\n                    model: agent.model,\r\n                    response: `Error: ${error.message}`,\r\n                    toolsUsed: []\r\n                };\r\n            }\r\n        });\r\n\r\n        // Execute all tasks in parallel\r\n        const results = await Promise.all(taskPromises);\r\n\r\n        // Display results\r\n        console.log(chalk.cyan('\\nðŸ“Š Task Results:\\n'));\r\n        results.forEach((result, _index) => {\r\n            console.log(chalk.yellow(`â”â”â” ${result.agent} (${result.model}) â”â”â”`));\r\n            console.log(chalk.white(result.response));\r\n            if (result.toolsUsed.length > 0) {\r\n                console.log(chalk.gray(`\\nðŸ”§ Tools used: ${result.toolsUsed.join(', ')}`));\r\n            }\r\n            console.log('');\r\n        });\r\n\r\n        console.log(chalk.green(`âœ… All ${results.length} agent(s) completed their tasks!\\n`));\r\n    }\r\n\r\n    async getAIResponseForAgent(agent, message) {\r\n        // Add message to agent's history\r\n        agent.history.push({\r\n            role: 'user',\r\n            content: message,\r\n            timestamp: new Date().toISOString()\r\n        });\r\n\r\n        // Prepare messages for AI (use agent's history)\r\n        const messages = agent.history.slice(-10).map(msg => ({\r\n            role: msg.role,\r\n            content: msg.content\r\n        }));\r\n\r\n        // Prepare tools\r\n        const tools = Object.values(this.tools).map(tool => ({\r\n            type: 'function',\r\n            function: {\r\n                name: tool.name,\r\n                description: tool.description,\r\n                parameters: tool.parameters\r\n            }\r\n        }));\r\n\r\n        try {\r\n            // Use Puter.js API with agent's model\r\n            if (puterInitialized && puter && this.puterAuthenticated && puter.ai) {\r\n                const puterTools = tools.map(tool => ({\r\n                    type: 'function',\r\n                    function: {\r\n                        name: tool.function.name,\r\n                        description: tool.function.description,\r\n                        parameters: tool.function.parameters\r\n                    }\r\n                }));\r\n\r\n                const puterMessages = messages.map(msg => {\r\n                    if (msg.role === 'tool') {\r\n                        return {\r\n                            role: 'assistant',\r\n                            content: msg.content\r\n                        };\r\n                    }\r\n                    return msg;\r\n                });\r\n\r\n                let response;\r\n                if (puter.ai.chat) {\r\n                    response = await puter.ai.chat(puterMessages, { \r\n                        model: agent.model,\r\n                        tools: puterTools \r\n                    });\r\n                } else {\r\n                    response = await puter.ai.complete({\r\n                        model: agent.model,\r\n                        messages: puterMessages,\r\n                        tools: puterTools\r\n                    });\r\n                }\r\n\r\n                const responseText = response.message?.content || response.content || response.text || '';\r\n                \r\n                // Handle tool calls if present\r\n                if (response.tool_calls && response.tool_calls.length > 0) {\r\n                    const toolsUsed = [];\r\n                    const toolResults = [];\r\n\r\n                    for (const toolCall of response.tool_calls) {\r\n                        const tool = this.tools[toolCall.function.name];\r\n                        if (tool) {\r\n                            try {\r\n                                const params = JSON.parse(toolCall.function.arguments || '{}');\r\n                                const result = await tool.execute(params);\r\n                                toolResults.push({\r\n                                    tool_call_id: toolCall.id,\r\n                                    role: 'tool',\r\n                                    name: toolCall.function.name,\r\n                                    content: JSON.stringify(result)\r\n                                });\r\n                                toolsUsed.push(toolCall.function.name);\r\n                            } catch (error) {\r\n                                toolResults.push({\r\n                                    tool_call_id: toolCall.id,\r\n                                    role: 'tool',\r\n                                    name: toolCall.function.name,\r\n                                    content: JSON.stringify({ success: false, error: error.message })\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    // Get final response with tool results\r\n                    const finalMessages = [...puterMessages, response, ...toolResults];\r\n                    const finalResponse = await puter.ai.chat(finalMessages, { \r\n                        model: agent.model \r\n                    });\r\n\r\n                    const finalText = finalResponse.message?.content || finalResponse.content || responseText;\r\n                    \r\n                    // Add to agent history\r\n                    agent.history.push({\r\n                        role: 'assistant',\r\n                        content: finalText,\r\n                        toolsUsed: toolsUsed,\r\n                        timestamp: new Date().toISOString()\r\n                    });\r\n\r\n                    return {\r\n                        text: finalText,\r\n                        toolsUsed: toolsUsed\r\n                    };\r\n                }\r\n\r\n                // Add to agent history\r\n                agent.history.push({\r\n                    role: 'assistant',\r\n                    content: responseText,\r\n                    timestamp: new Date().toISOString()\r\n                });\r\n\r\n                return {\r\n                    text: responseText,\r\n                    toolsUsed: []\r\n                };\r\n            }\r\n\r\n            // Fallback\r\n            return {\r\n                text: `I understand you want me to: ${message}`,\r\n                toolsUsed: []\r\n            };\r\n        } catch (error) {\r\n            return {\r\n                text: `Error: ${error.message}`,\r\n                toolsUsed: []\r\n            };\r\n        }\r\n    }\r\n}\r\n\r\n// Run CLI\r\nif (require.main === module) {\r\n    const cli = new StellarAICLI();\r\n    cli.init().catch(error => {\r\n        console.error(chalk.red(`\\nâœ— Fatal error: ${error.message}`));\r\n        process.exit(1);\r\n    });\r\n}\r\n\r\nmodule.exports = StellarAICLI;\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\stellar-ai-cli\\package-cli.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\stellar-ai.js","messages":[{"ruleId":"max-depth","severity":1,"message":"Blocks are nested too deeply (6). Maximum allowed is 5.","line":53,"column":29,"nodeType":"IfStatement","messageId":"tooDeeply","endLine":56,"endColumn":30},{"ruleId":"max-statements","severity":1,"message":"Method 'setupEventListeners' has too many statements (38). Maximum allowed is 30.","line":72,"column":24,"nodeType":"FunctionExpression","messageId":"exceed","endLine":188,"endColumn":6},{"ruleId":"max-statements","severity":1,"message":"Async method 'sendMessage' has too many statements (38). Maximum allowed is 30.","line":243,"column":22,"nodeType":"FunctionExpression","messageId":"exceed","endLine":315,"endColumn":6},{"ruleId":"max-statements","severity":1,"message":"Async method 'downloadCLI' has too many statements (31). Maximum allowed is 30.","line":823,"column":22,"nodeType":"FunctionExpression","messageId":"exceed","endLine":891,"endColumn":6},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":848,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":848,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":1091,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":1091,"endColumn":36},{"ruleId":"no-empty","severity":1,"message":"Empty block statement.","line":1091,"column":38,"nodeType":"BlockStatement","messageId":"unexpected","endLine":1091,"endColumn":40,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[44838,44838],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'_e' is defined but never used.","line":1093,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":1093,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Stellar AI - Advanced Chat Interface with Puter.js\r\n * Features: Image upload, chat history, user authentication\r\n */\r\n\r\nclass StellarAI {\r\n    constructor() {\r\n        this.currentChatId = null;\r\n        this.chats = [];\r\n        this.currentUser = null;\r\n        this.attachedImages = [];\r\n        this.isProcessing = false;\r\n        this.selectedModel = 'sonnet-4.5'; // Default model\r\n        \r\n        this.init();\r\n    }\r\n    \r\n    async init() {\r\n        console.log('ðŸŒŸ Initializing Stellar AI...');\r\n        \r\n        // Initialize Puter\r\n        await this.initPuter();\r\n        \r\n        // Load user session\r\n        this.loadUserSession();\r\n        \r\n        // Load chat history\r\n        this.loadChatHistory();\r\n        \r\n        // Setup event listeners\r\n        this.setupEventListeners();\r\n        \r\n        // Create initial chat if none exists\r\n        if (this.chats.length === 0) {\r\n            this.createNewChat();\r\n        }\r\n        \r\n        console.log('âœ… Stellar AI initialized');\r\n    }\r\n    \r\n    async initPuter() {\r\n        try {\r\n            // Initialize Puter SDK\r\n            if (typeof puter !== 'undefined') {\r\n                console.log('âœ… Puter SDK loaded');\r\n                this.puterAvailable = true;\r\n                \r\n                // Check if user is authenticated and store token for CLI use\r\n                if (puter.auth && puter.auth.isSignedIn && puter.auth.isSignedIn()) {\r\n                    try {\r\n                        if (puter.auth.getToken) {\r\n                            const token = puter.auth.getToken();\r\n                            if (token) {\r\n                                localStorage.setItem('puterAuthToken', token);\r\n                                console.log('âœ… Puter.js authenticated - token saved for CLI');\r\n                            }\r\n                        }\r\n                    } catch (e) {\r\n                        console.warn('Could not get Puter token:', e);\r\n                    }\r\n                }\r\n            } else {\r\n                console.warn('âš ï¸  Puter SDK not available, using fallback');\r\n                this.puterAvailable = false;\r\n            }\r\n        } catch (error) {\r\n            console.error('âŒ Error initializing Puter:', error);\r\n            this.puterAvailable = false;\r\n        }\r\n    }\r\n    \r\n    setupEventListeners() {\r\n        // Send button\r\n        const sendBtn = document.getElementById('send-btn');\r\n        if (sendBtn) {\r\n            sendBtn.addEventListener('click', () => this.sendMessage());\r\n        }\r\n        \r\n        // Message input\r\n        const messageInput = document.getElementById('message-input');\r\n        if (!messageInput) {\r\n            console.warn('âš ï¸ Message input not found');\r\n            return;\r\n        }\r\n        \r\n        messageInput.addEventListener('keydown', (e) => {\r\n            if (e.key === 'Enter' && !e.shiftKey) {\r\n                e.preventDefault();\r\n                this.sendMessage();\r\n            }\r\n            \r\n            // Auto-resize textarea\r\n            this.autoResizeTextarea(messageInput);\r\n        });\r\n        \r\n        messageInput.addEventListener('input', () => {\r\n            this.updateCharCount();\r\n            this.autoResizeTextarea(messageInput);\r\n        });\r\n        \r\n        // Attach button\r\n        const attachBtn = document.getElementById('attach-btn');\r\n        const fileInput = document.getElementById('file-input');\r\n        if (attachBtn && fileInput) {\r\n            attachBtn.addEventListener('click', () => {\r\n                fileInput.click();\r\n            });\r\n        }\r\n        \r\n        // File input\r\n        if (fileInput) {\r\n            fileInput.addEventListener('change', (e) => {\r\n                this.handleFileUpload(e.target.files);\r\n            });\r\n        }\r\n        \r\n        // New chat button\r\n        const newChatBtn = document.getElementById('new-chat-btn');\r\n        if (newChatBtn) {\r\n            newChatBtn.addEventListener('click', () => {\r\n                this.createNewChat();\r\n            });\r\n        }\r\n        \r\n        // Clear chat button\r\n        const clearChatBtn = document.getElementById('clear-chat-btn');\r\n        if (clearChatBtn) {\r\n            clearChatBtn.addEventListener('click', () => {\r\n                this.clearCurrentChat();\r\n            });\r\n        }\r\n        \r\n        // Export chat button\r\n        const exportChatBtn = document.getElementById('export-chat-btn');\r\n        if (exportChatBtn) {\r\n            exportChatBtn.addEventListener('click', () => {\r\n                this.exportChat();\r\n            });\r\n        }\r\n        \r\n        // Model selector\r\n        const modelSelector = document.getElementById('model-selector');\r\n        if (modelSelector) {\r\n            modelSelector.addEventListener('change', (e) => {\r\n                this.selectedModel = e.target.value;\r\n                this.saveModelPreference();\r\n                this.showModelChangeNotification();\r\n            });\r\n            \r\n            // Load saved model preference\r\n            this.loadModelPreference();\r\n        }\r\n        \r\n        // Login button\r\n        const loginBtn = document.getElementById('login-btn');\r\n        if (loginBtn) {\r\n            loginBtn.addEventListener('click', () => {\r\n                this.showLoginModal();\r\n            });\r\n        }\r\n\r\n        // CLI Download button\r\n        const downloadCliBtn = document.getElementById('download-cli-btn');\r\n        if (downloadCliBtn) {\r\n            downloadCliBtn.addEventListener('click', () => {\r\n                this.downloadCLI();\r\n            });\r\n        }\r\n        \r\n        // Copy token button\r\n        const copyTokenBtn = document.getElementById('copy-token-btn');\r\n        if (copyTokenBtn) {\r\n            copyTokenBtn.addEventListener('click', () => {\r\n                const tokenInput = document.getElementById('puter-token-input');\r\n                if (tokenInput && tokenInput.value) {\r\n                    tokenInput.select();\r\n                    document.execCommand('copy');\r\n                    copyTokenBtn.textContent = 'Copied!';\r\n                    setTimeout(() => {\r\n                        copyTokenBtn.textContent = 'Copy';\r\n                    }, 2000);\r\n                }\r\n            });\r\n        }\r\n        \r\n        // Check and display Puter token if available\r\n        this.checkPuterToken();\r\n    }\r\n    \r\n    autoResizeTextarea(textarea) {\r\n        textarea.style.height = 'auto';\r\n        textarea.style.height = Math.min(textarea.scrollHeight, 200) + 'px';\r\n    }\r\n    \r\n    updateCharCount() {\r\n        const input = document.getElementById('message-input');\r\n        const charCount = document.getElementById('char-count');\r\n        if (!input || !charCount) return;\r\n        const count = input.value.length;\r\n        charCount.textContent = `${count} / 4000`;\r\n    }\r\n    \r\n    createNewChat() {\r\n        const chatId = 'chat_' + Date.now();\r\n        const chat = {\r\n            id: chatId,\r\n            title: 'New Chat',\r\n            messages: [],\r\n            createdAt: new Date().toISOString(),\r\n            updatedAt: new Date().toISOString()\r\n        };\r\n        \r\n        this.chats.unshift(chat);\r\n        this.switchToChat(chatId);\r\n        this.updateChatHistory();\r\n        this.saveChatHistory();\r\n        \r\n        // Hide welcome message\r\n        this.hideWelcome();\r\n    }\r\n    \r\n    switchToChat(chatId) {\r\n        this.currentChatId = chatId;\r\n        const chat = this.chats.find(c => c.id === chatId);\r\n        \r\n        if (chat) {\r\n            const chatTitle = document.getElementById('current-chat-title');\r\n            if (chatTitle) {\r\n                chatTitle.textContent = chat.title;\r\n            }\r\n            this.renderMessages(chat.messages);\r\n            this.updateChatHistory();\r\n        }\r\n    }\r\n    \r\n    hideWelcome() {\r\n        const welcome = document.querySelector('.welcome-message');\r\n        if (welcome) {\r\n            welcome.style.display = 'none';\r\n        }\r\n    }\r\n    \r\n    async sendMessage() {\r\n        if (this.isProcessing) return;\r\n        \r\n        const input = document.getElementById('message-input');\r\n        if (!input) {\r\n            console.warn('âš ï¸ Message input not found');\r\n            return;\r\n        }\r\n        const message = input.value.trim();\r\n        \r\n        if (!message && this.attachedImages.length === 0) return;\r\n        \r\n        this.hideWelcome();\r\n        this.isProcessing = true;\r\n        const sendBtnEl = document.getElementById('send-btn');\r\n        if (sendBtnEl) {\r\n            sendBtnEl.disabled = true;\r\n        }\r\n        \r\n        // Create user message\r\n        const userMessage = {\r\n            role: 'user',\r\n            content: message,\r\n            images: [...this.attachedImages],\r\n            timestamp: new Date().toISOString()\r\n        };\r\n        \r\n        // Add to current chat\r\n        const chat = this.chats.find(c => c.id === this.currentChatId);\r\n        if (chat) {\r\n            chat.messages.push(userMessage);\r\n            \r\n            // Update chat title if first message\r\n            if (chat.messages.length === 1 && message) {\r\n                chat.title = message.substring(0, 50) + (message.length > 50 ? '...' : '');\r\n                const chatTitle = document.getElementById('current-chat-title');\r\n                if (chatTitle) {\r\n                    chatTitle.textContent = chat.title;\r\n                }\r\n            }\r\n            \r\n            // Render message\r\n            this.appendMessage(userMessage);\r\n            \r\n            // Clear input\r\n            input.value = '';\r\n            this.attachedImages = [];\r\n            const attachmentsPreview = document.getElementById('attachments-preview');\r\n            if (attachmentsPreview) {\r\n                attachmentsPreview.innerHTML = '';\r\n            }\r\n            this.updateCharCount();\r\n            input.style.height = 'auto';\r\n            \r\n            // Show loading indicator\r\n            this.showLoadingIndicator();\r\n            \r\n            // Get AI response\r\n            await this.getAIResponse(chat);\r\n            \r\n            // Save chat\r\n            this.saveChatHistory();\r\n            this.updateChatHistory();\r\n        }\r\n        \r\n        this.isProcessing = false;\r\n        if (sendBtnEl) {\r\n            sendBtnEl.disabled = false;\r\n        }\r\n        if (input) {\r\n            input.focus();\r\n        }\r\n    }\r\n    \r\n    async getAIResponse(chat) {\r\n        try {\r\n            let responseText = '';\r\n            \r\n            // Check if using fallback model\r\n            if (this.selectedModel === 'fallback') {\r\n                responseText = this.getFallbackResponse(chat.messages[chat.messages.length - 1].content);\r\n            } else if (this.puterAvailable && typeof puter !== 'undefined' && puter.ai) {\r\n                // Use Puter AI with selected model\r\n                console.log(`Using Puter AI with model: ${this.selectedModel}...`);\r\n                \r\n                // Prepare messages for Puter\r\n                const messages = chat.messages.slice(-10).map(msg => ({\r\n                    role: msg.role,\r\n                    content: msg.content\r\n                }));\r\n                \r\n                try {\r\n                    // Call Puter AI with model parameter\r\n                    const aiOptions = {\r\n                        model: this.selectedModel,\r\n                        messages: messages\r\n                    };\r\n                    \r\n                    // Try different Puter API formats\r\n                    let response;\r\n                    if (puter.ai.chat) {\r\n                        response = await puter.ai.chat(messages, { model: this.selectedModel });\r\n                    } else if (puter.ai.complete) {\r\n                        response = await puter.ai.complete(aiOptions);\r\n                    } else {\r\n                        // Fallback to basic chat\r\n                        response = await puter.ai.chat(messages);\r\n                    }\r\n                    \r\n                    responseText = response.message?.content || response.content || response.text || response;\r\n                    \r\n                    if (!responseText) {\r\n                        throw new Error('Empty response from AI');\r\n                    }\r\n                } catch (puterError) {\r\n                    console.warn(`Puter AI error with ${this.selectedModel}, using fallback:`, puterError);\r\n                    responseText = this.getFallbackResponse(chat.messages[chat.messages.length - 1].content);\r\n                }\r\n            } else {\r\n                // Fallback response if Puter not available\r\n                responseText = this.getFallbackResponse(chat.messages[chat.messages.length - 1].content);\r\n            }\r\n            \r\n            // Create AI message\r\n            const aiMessage = {\r\n                role: 'assistant',\r\n                content: responseText,\r\n                model: this.selectedModel, // Store which model was used\r\n                timestamp: new Date().toISOString()\r\n            };\r\n            \r\n            // Remove loading indicator\r\n            this.hideLoadingIndicator();\r\n            \r\n            // Add AI response to chat\r\n            chat.messages.push(aiMessage);\r\n            chat.updatedAt = new Date().toISOString();\r\n            \r\n            // Render AI response\r\n            this.appendMessage(aiMessage);\r\n            \r\n        } catch (error) {\r\n            console.error('Error getting AI response:', error);\r\n            this.hideLoadingIndicator();\r\n            \r\n            const errorMessage = {\r\n                role: 'assistant',\r\n                content: 'I apologize, but I encountered an error processing your request. Please try again.',\r\n                timestamp: new Date().toISOString()\r\n            };\r\n            \r\n            chat.messages.push(errorMessage);\r\n            this.appendMessage(errorMessage);\r\n        }\r\n    }\r\n    \r\n    getFallbackResponse(userMessage) {\r\n        const responses = {\r\n            'exoplanet': 'Exoplanets are planets that orbit stars outside our solar system. The Kepler mission has discovered thousands of exoplanets, many of which are in the habitable zone of their stars. Would you like to know more about specific types of exoplanets?',\r\n            'andromeda': 'The Andromeda Galaxy (M31) is the nearest major galaxy to the Milky Way, located about 2.5 million light-years away. It contains approximately one trillion stars and is on a collision course with our galaxy, though this won\\'t happen for another 4 billion years!',\r\n            'kepler': 'Kepler objects are celestial bodies discovered by NASA\\'s Kepler Space Telescope. The Kepler mission discovered over 2,600 confirmed exoplanets by monitoring the brightness of stars and detecting tiny dips that indicate a planet passing in front of them.',\r\n            'default': `I'm Stellar AI, your cosmic assistant! I can help you learn about exoplanets, galaxies, space exploration, and the Kepler mission. What would you like to know about?`\r\n        };\r\n        \r\n        const lowerMessage = userMessage.toLowerCase();\r\n        for (const [key, response] of Object.entries(responses)) {\r\n            if (lowerMessage.includes(key)) {\r\n                return response;\r\n            }\r\n        }\r\n        \r\n        return responses.default;\r\n    }\r\n    \r\n    showLoadingIndicator() {\r\n        const loadingHtml = `\r\n            <div class=\"message ai-message loading-message\">\r\n                <div class=\"message-avatar\">ðŸŒŸ</div>\r\n                <div class=\"message-content\">\r\n                    <div class=\"message-loading\">\r\n                        <div class=\"loading-dot\"></div>\r\n                        <div class=\"loading-dot\"></div>\r\n                        <div class=\"loading-dot\"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `;\r\n        \r\n        const container = document.getElementById('messages-container');\r\n        container.insertAdjacentHTML('beforeend', loadingHtml);\r\n        container.scrollTop = container.scrollHeight;\r\n    }\r\n    \r\n    hideLoadingIndicator() {\r\n        const loading = document.querySelector('.loading-message');\r\n        if (loading) {\r\n            loading.remove();\r\n        }\r\n    }\r\n    \r\n    appendMessage(message) {\r\n        const container = document.getElementById('messages-container');\r\n        const messageHtml = this.createMessageHTML(message);\r\n        container.insertAdjacentHTML('beforeend', messageHtml);\r\n        container.scrollTop = container.scrollHeight;\r\n    }\r\n    \r\n    renderMessages(messages) {\r\n        const container = document.getElementById('messages-container');\r\n        container.innerHTML = '';\r\n        \r\n        if (messages.length === 0) {\r\n            // Show welcome message\r\n            container.innerHTML = this.getWelcomeHTML();\r\n            return;\r\n        }\r\n        \r\n        messages.forEach(message => {\r\n            container.insertAdjacentHTML('beforeend', this.createMessageHTML(message));\r\n        });\r\n        \r\n        container.scrollTop = container.scrollHeight;\r\n    }\r\n    \r\n    createMessageHTML(message) {\r\n        const time = new Date(message.timestamp).toLocaleTimeString('en-US', {\r\n            hour: '2-digit',\r\n            minute: '2-digit'\r\n        });\r\n        \r\n        const isUser = message.role === 'user';\r\n        const avatar = isUser ? 'ðŸ‘¤' : 'ðŸŒŸ';\r\n        let author = isUser ? 'You' : 'Stellar AI';\r\n        \r\n        // Add model info to AI messages\r\n        if (!isUser && message.model) {\r\n            author += ` (${this.getModelDisplayName(message.model)})`;\r\n        }\r\n        \r\n        const messageClass = isUser ? 'user-message' : 'ai-message';\r\n        \r\n        let imagesHTML = '';\r\n        if (message.images && message.images.length > 0) {\r\n            imagesHTML = '<div class=\"message-images\">' +\r\n                message.images.map(img => {\r\n                    // Escape image URL to prevent XSS\r\n                    const safeUrl = this.escapeHtml(img.url || '');\r\n                    return `<img src=\"${safeUrl}\" alt=\"Uploaded image\" class=\"message-image\" data-url=\"${safeUrl}\">`;\r\n                }).join('') +\r\n                '</div>';\r\n        }\r\n        \r\n        // Escape all user-provided content\r\n        const safeAuthor = this.escapeHtml(author);\r\n        const safeTime = this.escapeHtml(time);\r\n        const safeMessageClass = this.escapeHtml(messageClass);\r\n        \r\n        return `\r\n            <div class=\"message ${safeMessageClass}\">\r\n                <div class=\"message-avatar\">${avatar}</div>\r\n                <div class=\"message-content\">\r\n                    <div class=\"message-header\">\r\n                        <span class=\"message-author\">${safeAuthor}</span>\r\n                        <span class=\"message-time\">${safeTime}</span>\r\n                    </div>\r\n                    <div class=\"message-text\">${this.formatText(message.content)}</div>\r\n                    ${imagesHTML}\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n    \r\n    escapeHtml(text) {\r\n        if (!text) return '';\r\n        const div = document.createElement('div');\r\n        div.textContent = text;\r\n        return div.innerHTML;\r\n    }\r\n    \r\n    formatText(text) {\r\n        if (!text) return '';\r\n        // First escape HTML to prevent XSS\r\n        const escaped = this.escapeHtml(text);\r\n        // Then apply safe formatting (markdown-like)\r\n        return escaped\r\n            .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\r\n            .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\r\n            .replace(/`(.*?)`/g, '<code>$1</code>');\r\n    }\r\n    \r\n    getWelcomeHTML() {\r\n        return `\r\n            <div class=\"welcome-message\">\r\n                <div class=\"welcome-icon\">ðŸŒŒ</div>\r\n                <h2>Welcome to Stellar AI</h2>\r\n                <p>Your intelligent cosmic companion powered by advanced AI</p>\r\n                <div class=\"welcome-features\">\r\n                    <div class=\"feature\">\r\n                        <span>ðŸ’¬</span>\r\n                        <span>Natural Conversations</span>\r\n                    </div>\r\n                    <div class=\"feature\">\r\n                        <span>ðŸ–¼ï¸</span>\r\n                        <span>Image Analysis</span>\r\n                    </div>\r\n                    <div class=\"feature\">\r\n                        <span>ðŸ“š</span>\r\n                        <span>Knowledge Base</span>\r\n                    </div>\r\n                    <div class=\"feature\">\r\n                        <span>ðŸ’¾</span>\r\n                        <span>Save History</span>\r\n                    </div>\r\n                </div>\r\n                <div class=\"example-prompts\">\r\n                    <p>Try asking:</p>\r\n                    <button class=\"example-prompt\" onclick=\"usePrompt('Tell me about exoplanets')\">\r\n                        Tell me about exoplanets\r\n                    </button>\r\n                    <button class=\"example-prompt\" onclick=\"usePrompt('Explain the Andromeda galaxy')\">\r\n                        Explain the Andromeda galaxy\r\n                    </button>\r\n                    <button class=\"example-prompt\" onclick=\"usePrompt('What is a Kepler object?')\">\r\n                        What is a Kepler object?\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        `;\r\n    }\r\n    \r\n    handleFileUpload(files) {\r\n        Array.from(files).forEach(file => {\r\n            if (!file.type.startsWith('image/')) {\r\n                alert('Please select only image files');\r\n                return;\r\n            }\r\n            \r\n            if (file.size > 10 * 1024 * 1024) {\r\n                alert('Image size must be less than 10MB');\r\n                return;\r\n            }\r\n            \r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n                const imageData = {\r\n                    url: e.target.result,\r\n                    name: file.name,\r\n                    type: file.type\r\n                };\r\n                \r\n                this.attachedImages.push(imageData);\r\n                this.updateAttachmentsPreview();\r\n            };\r\n            reader.readAsDataURL(file);\r\n        });\r\n    }\r\n    \r\n    updateAttachmentsPreview() {\r\n        const preview = document.getElementById('attachments-preview');\r\n        if (!preview) return;\r\n        \r\n        preview.innerHTML = '';\r\n        \r\n        this.attachedImages.forEach((img, index) => {\r\n            const item = document.createElement('div');\r\n            item.className = 'attachment-item';\r\n            \r\n            // Escape image URL and name to prevent XSS\r\n            const safeUrl = this.escapeHtml(img.url || '');\r\n            const safeName = this.escapeHtml(img.name || '');\r\n            \r\n            // Create image element safely\r\n            const imgEl = document.createElement('img');\r\n            imgEl.src = safeUrl;\r\n            imgEl.className = 'attachment-thumbnail';\r\n            imgEl.alt = safeName;\r\n            \r\n            // Create remove button safely\r\n            const removeBtn = document.createElement('button');\r\n            removeBtn.className = 'remove-attachment';\r\n            removeBtn.textContent = 'Ã—';\r\n            removeBtn.addEventListener('click', () => {\r\n                this.removeAttachment(index);\r\n            });\r\n            \r\n            item.appendChild(imgEl);\r\n            item.appendChild(removeBtn);\r\n            preview.appendChild(item);\r\n        });\r\n    }\r\n    \r\n    removeAttachment(index) {\r\n        this.attachedImages.splice(index, 1);\r\n        this.updateAttachmentsPreview();\r\n    }\r\n    \r\n    updateChatHistory() {\r\n        const container = document.getElementById('chat-history-list');\r\n        container.innerHTML = '';\r\n        \r\n        this.chats.forEach(chat => {\r\n            const isActive = chat.id === this.currentChatId;\r\n            const lastMessage = chat.messages[chat.messages.length - 1];\r\n            const preview = lastMessage ? lastMessage.content.substring(0, 40) + '...' : 'Empty chat';\r\n            \r\n            const item = document.createElement('div');\r\n            item.className = 'history-item' + (isActive ? ' active' : '');\r\n            item.onclick = () => this.switchToChat(chat.id);\r\n            item.innerHTML = `\r\n                <div class=\"history-title\">${chat.title}</div>\r\n                <div class=\"history-preview\">${preview}</div>\r\n            `;\r\n            container.appendChild(item);\r\n        });\r\n    }\r\n    \r\n    clearCurrentChat() {\r\n        const chat = this.chats.find(c => c.id === this.currentChatId);\r\n        if (chat && confirm('Clear all messages in this chat?')) {\r\n            chat.messages = [];\r\n            chat.title = 'New Chat';\r\n            chat.updatedAt = new Date().toISOString();\r\n            \r\n            const chatTitle = document.getElementById('current-chat-title');\r\n            if (chatTitle) {\r\n                chatTitle.textContent = 'New Chat';\r\n            }\r\n            \r\n            this.renderMessages([]);\r\n            this.saveChatHistory();\r\n            this.updateChatHistory();\r\n        }\r\n    }\r\n    \r\n    exportChat() {\r\n        const chat = this.chats.find(c => c.id === this.currentChatId);\r\n        if (!chat || chat.messages.length === 0) {\r\n            alert('No messages to export');\r\n            return;\r\n        }\r\n        \r\n        const chatText = chat.messages.map(msg => {\r\n            const author = msg.role === 'user' ? 'You' : 'Stellar AI';\r\n            const time = new Date(msg.timestamp).toLocaleString();\r\n            return `[${time}] ${author}: ${msg.content}`;\r\n        }).join('\\n\\n');\r\n        \r\n        const blob = new Blob([chatText], { type: 'text/plain' });\r\n        const url = URL.createObjectURL(blob);\r\n        const a = document.createElement('a');\r\n        a.href = url;\r\n        a.download = `stellar-ai-${chat.title.replace(/[^a-z0-9]/gi, '-')}.txt`;\r\n        a.click();\r\n        URL.revokeObjectURL(url);\r\n    }\r\n    \r\n    saveChatHistory() {\r\n        try {\r\n            localStorage.setItem('stellarAI_chats', JSON.stringify(this.chats));\r\n            localStorage.setItem('stellarAI_currentChatId', this.currentChatId);\r\n            \r\n            // Also save to backend if user is logged in\r\n            if (this.currentUser) {\r\n                this.saveToBackend();\r\n            }\r\n        } catch (error) {\r\n            console.error('Error saving chat history:', error);\r\n        }\r\n    }\r\n    \r\n    loadChatHistory() {\r\n        try {\r\n            const saved = localStorage.getItem('stellarAI_chats');\r\n            if (saved) {\r\n                this.chats = JSON.parse(saved);\r\n            }\r\n            \r\n            const savedChatId = localStorage.getItem('stellarAI_currentChatId');\r\n            if (savedChatId && this.chats.find(c => c.id === savedChatId)) {\r\n                this.currentChatId = savedChatId;\r\n                this.switchToChat(savedChatId);\r\n            }\r\n            \r\n            this.updateChatHistory();\r\n        } catch (error) {\r\n            console.error('Error loading chat history:', error);\r\n        }\r\n    }\r\n    \r\n    loadUserSession() {\r\n        const user = localStorage.getItem('stellarAI_user');\r\n        if (user) {\r\n            this.currentUser = JSON.parse(user);\r\n            this.updateUserUI();\r\n        }\r\n    }\r\n    \r\n    loadModelPreference() {\r\n        const savedModel = localStorage.getItem('stellarAI_selectedModel');\r\n        if (savedModel) {\r\n            this.selectedModel = savedModel;\r\n            const modelSelector = document.getElementById('model-selector');\r\n            if (modelSelector) {\r\n                modelSelector.value = savedModel;\r\n            }\r\n        }\r\n    }\r\n    \r\n    saveModelPreference() {\r\n        localStorage.setItem('stellarAI_selectedModel', this.selectedModel);\r\n    }\r\n    \r\n    showModelChangeNotification() {\r\n        // Create temporary notification\r\n        const notification = document.createElement('div');\r\n        notification.className = 'model-change-notification';\r\n        notification.textContent = `Switched to ${this.getModelDisplayName(this.selectedModel)}`;\r\n        document.body.appendChild(notification);\r\n        \r\n        setTimeout(() => {\r\n            notification.classList.add('show');\r\n        }, 10);\r\n        \r\n        setTimeout(() => {\r\n            notification.classList.remove('show');\r\n            setTimeout(() => notification.remove(), 300);\r\n        }, 2000);\r\n    }\r\n    \r\n    getModelDisplayName(model) {\r\n        const modelNames = {\r\n            'sonnet-4.5': 'Claude Sonnet 4.5',\r\n            'sonnet-4': 'Claude Sonnet 4',\r\n            'opus-4': 'Claude Opus 4',\r\n            'haiku-4': 'Claude Haiku 4',\r\n            'gpt-4o': 'GPT-4o',\r\n            'gpt-4-turbo': 'GPT-4 Turbo',\r\n            'gpt-3.5-turbo': 'GPT-3.5 Turbo',\r\n            'gemini-pro': 'Gemini Pro',\r\n            'llama-3.1': 'Llama 3.1',\r\n            'fallback': 'Fallback (Demo)'\r\n        };\r\n        return modelNames[model] || model;\r\n    }\r\n    \r\n    updateUserUI() {\r\n        if (this.currentUser) {\r\n            const userName = document.querySelector('.user-name');\r\n            const userAvatar = document.querySelector('.user-avatar');\r\n            if (userName) userName.textContent = this.currentUser.name;\r\n            if (userAvatar) userAvatar.textContent = this.currentUser.name.charAt(0).toUpperCase();\r\n            const loginBtn = document.getElementById('login-btn');\r\n            if (loginBtn) {\r\n                loginBtn.textContent = 'Logout';\r\n                loginBtn.onclick = () => this.logout();\r\n            }\r\n        }\r\n    }\r\n    \r\n    showLoginModal() {\r\n        const loginModal = document.getElementById('login-modal');\r\n        if (loginModal) {\r\n            loginModal.classList.add('show');\r\n        }\r\n    }\r\n    \r\n    logout() {\r\n        if (confirm('Logout? Your chat history will be cleared from this device.')) {\r\n            localStorage.removeItem('stellarAI_user');\r\n            this.currentUser = null;\r\n            location.reload();\r\n        }\r\n    }\r\n    \r\n    async saveToBackend() {\r\n        // Placeholder for backend integration\r\n        // Will be implemented in backend API\r\n        console.log('Saving to backend...');\r\n    }\r\n\r\n    async downloadCLI() {\r\n        const btn = document.getElementById('download-cli-btn');\r\n        const originalText = btn.innerHTML;\r\n        \r\n        // Show loading state\r\n        btn.disabled = true;\r\n        btn.innerHTML = '<span>â³</span> Preparing download...';\r\n        \r\n        try {\r\n            // Try backend endpoint first (if available)\r\n            const backendUrl = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' \r\n                ? 'http://localhost:3001' \r\n                : '';\r\n            \r\n            let downloadUrl = '';\r\n            let useBackend = false;\r\n            \r\n            if (backendUrl) {\r\n                // Test if backend is available\r\n                try {\r\n                    const testResponse = await fetch(`${backendUrl}/health`, { method: 'GET', timeout: 2000 });\r\n                    if (testResponse.ok) {\r\n                        downloadUrl = `${backendUrl}/api/cli/download`;\r\n                        useBackend = true;\r\n                    }\r\n                } catch (_e) {\r\n                    console.log('Backend not available, using GitLab direct download');\r\n                }\r\n            }\r\n            \r\n            if (!useBackend) {\r\n                // Use pre-packaged zip file from GitLab Pages\r\n                // This zip contains only the stellar-ai-cli folder\r\n                const baseUrl = window.location.origin;\r\n                downloadUrl = `${baseUrl}/stellar-ai-cli.zip`;\r\n            }\r\n            \r\n            // Create download link\r\n            const link = document.createElement('a');\r\n            link.href = downloadUrl;\r\n            link.download = 'stellar-ai-cli.zip';\r\n            link.target = '_blank';\r\n            link.style.display = 'none';\r\n            document.body.appendChild(link);\r\n            \r\n            // Trigger download\r\n            link.click();\r\n            \r\n            // Show detailed instructions\r\n            setTimeout(() => {\r\n                btn.disabled = false;\r\n                btn.innerHTML = originalText;\r\n                this.showDownloadInstructions(useBackend);\r\n            }, 1000);\r\n            \r\n            // Clean up\r\n            setTimeout(() => {\r\n                if (document.body.contains(link)) {\r\n                    document.body.removeChild(link);\r\n                }\r\n            }, 3000);\r\n            \r\n        } catch (error) {\r\n            console.error('Download error:', error);\r\n            btn.disabled = false;\r\n            btn.innerHTML = originalText;\r\n            alert('âŒ Download failed. Please visit the GitLab repository to download manually:\\n\\nhttps://gitlab.com/imtherushwar/new-starsiadr');\r\n        }\r\n    }\r\n    \r\n    showDownloadInstructions(useBackend) {\r\n        // Create modal for instructions\r\n        const modal = document.createElement('div');\r\n        modal.id = 'download-instructions-modal';\r\n        modal.style.cssText = `\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background: rgba(0, 0, 0, 0.9);\r\n            z-index: 10000;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            padding: 20px;\r\n        `;\r\n        \r\n        modal.innerHTML = `\r\n            <div style=\"\r\n                background: linear-gradient(135deg, rgba(10, 10, 15, 0.95), rgba(20, 20, 30, 0.95));\r\n                border: 2px solid rgba(186, 148, 79, 0.5);\r\n                border-radius: 20px;\r\n                padding: 3rem;\r\n                max-width: 700px;\r\n                max-height: 90vh;\r\n                overflow-y: auto;\r\n                position: relative;\r\n            \">\r\n                <button onclick=\"this.closest('#download-instructions-modal').remove()\" style=\"\r\n                    position: absolute;\r\n                    top: 1rem;\r\n                    right: 1rem;\r\n                    background: transparent;\r\n                    border: 2px solid rgba(186, 148, 79, 0.5);\r\n                    color: #ba944f;\r\n                    width: 40px;\r\n                    height: 40px;\r\n                    border-radius: 50%;\r\n                    cursor: pointer;\r\n                    font-size: 1.5rem;\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                \">&times;</button>\r\n                \r\n                <h2 style=\"color: #ba944f; margin-bottom: 1.5rem; font-size: 2rem;\">ðŸ“¥ Download & Setup Instructions</h2>\r\n                \r\n                ${useBackend ? `\r\n                    <div style=\"background: rgba(74, 222, 128, 0.1); border: 1px solid rgba(74, 222, 128, 0.3); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;\">\r\n                        <p style=\"color: #4ade80; margin: 0;\">âœ… Download started! You're downloading only the Stellar AI CLI package - ready to use!</p>\r\n                    </div>\r\n                ` : `\r\n                    <div style=\"background: rgba(255, 193, 7, 0.1); border: 1px solid rgba(255, 193, 7, 0.3); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;\">\r\n                        <p style=\"color: #ffc107; margin: 0;\">âš ï¸ You're downloading the full repository. After extraction, navigate to the <code>stellar-ai-cli</code> folder.</p>\r\n                    </div>\r\n                `}\r\n                \r\n                <div style=\"background: rgba(74, 222, 128, 0.1); border: 1px solid rgba(74, 222, 128, 0.3); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;\">\r\n                    <p style=\"color: #4ade80; margin: 0; font-weight: 600;\">âœ¨ All-in-One Package!</p>\r\n                    <p style=\"color: rgba(255, 255, 255, 0.8); margin: 0.5rem 0 0 0; font-size: 0.9rem;\">\r\n                        This package includes automatic setup scripts. No manual configuration needed!\r\n                    </p>\r\n                </div>\r\n                \r\n                <h3 style=\"color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;\">Step 1: Extract the ZIP File</h3>\r\n                <p style=\"color: rgba(255, 255, 255, 0.8); margin-bottom: 1.5rem; line-height: 1.6;\">\r\n                    ${useBackend ? \r\n                        'Extract the downloaded ZIP file to a location of your choice. You\\'ll see a folder named <code style=\"background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;\">stellar-ai-cli</code> - this is the complete CLI package, ready to use!' :\r\n                        'Extract the downloaded ZIP file to a location of your choice. You\\'ll see a folder named <code style=\"background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;\">stellar-ai-cli</code> or <code style=\"background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;\">new-starsiadr-main</code>. Navigate to the <code>stellar-ai-cli</code> folder inside.'\r\n                    }\r\n                </p>\r\n                \r\n                <h3 style=\"color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;\">Step 2: Automatic Setup (Recommended)</h3>\r\n                <p style=\"color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;\">\r\n                    <strong>Windows:</strong> Double-click <code style=\"background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;\">setup.bat</code>\r\n                </p>\r\n                <p style=\"color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;\">\r\n                    <strong>Linux/Mac:</strong> Open terminal and run:\r\n                </p>\r\n                <div style=\"background: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; font-family: 'Courier New', monospace;\">\r\n                    <code style=\"color: #4ade80;\">chmod +x setup.sh</code><br>\r\n                    <code style=\"color: #4ade80;\">./setup.sh</code>\r\n                </div>\r\n                <p style=\"color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-bottom: 1.5rem;\">\r\n                    The setup script will automatically check for Node.js, install all dependencies, and configure everything for you!\r\n                </p>\r\n                \r\n                <h3 style=\"color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;\">Step 3: Start Stellar AI CLI</h3>\r\n                <p style=\"color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;\">\r\n                    <strong>Windows:</strong> Double-click <code style=\"background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;\">start.bat</code>\r\n                </p>\r\n                <p style=\"color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;\">\r\n                    <strong>Linux/Mac:</strong> Run:\r\n                </p>\r\n                <div style=\"background: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; font-family: 'Courier New', monospace;\">\r\n                    <code style=\"color: #4ade80;\">./start.sh</code>\r\n                </div>\r\n                <p style=\"color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-bottom: 1.5rem;\">\r\n                    Or manually: <code style=\"background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;\">node index.js</code>\r\n                </p>\r\n                \r\n                <h3 style=\"color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;\">Step 5: Authenticate with Puter.js (Optional)</h3>\r\n                <p style=\"color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;\">\r\n                    If you want to use Puter.js features, run:\r\n                </p>\r\n                <div style=\"background: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; font-family: 'Courier New', monospace;\">\r\n                    <code style=\"color: #4ade80;\">/login</code>\r\n                </div>\r\n                <p style=\"color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-bottom: 1.5rem;\">\r\n                    This will open a browser window for Puter.js authentication.\r\n                </p>\r\n                \r\n                <h3 style=\"color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;\">Available Commands</h3>\r\n                <div style=\"background: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; font-family: 'Courier New', monospace; font-size: 0.9rem;\">\r\n                    <code style=\"color: #4ade80;\">/help</code> - Show all commands<br>\r\n                    <code style=\"color: #4ade80;\">/model [name]</code> - Change AI model<br>\r\n                    <code style=\"color: #4ade80;\">/login</code> - Authenticate with Puter.js<br>\r\n                    <code style=\"color: #4ade80;\">/logout</code> - Sign out from Puter.js<br>\r\n                    <code style=\"color: #4ade80;\">/agent add [name] [model]</code> - Add multi-agent<br>\r\n                    <code style=\"color: #4ade80;\">/clear</code> - Clear chat history\r\n                </div>\r\n                \r\n                <div style=\"margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(186, 148, 79, 0.3);\">\r\n                    <p style=\"color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; margin-bottom: 1rem;\">\r\n                        Need help? Visit the repository:\r\n                    </p>\r\n                    <a href=\"https://gitlab.com/imtherushwar/new-starsiadr\" target=\"_blank\" style=\"\r\n                        display: inline-block;\r\n                        padding: 0.75rem 1.5rem;\r\n                        background: rgba(186, 148, 79, 0.2);\r\n                        border: 2px solid rgba(186, 148, 79, 0.5);\r\n                        border-radius: 10px;\r\n                        color: #ba944f;\r\n                        text-decoration: none;\r\n                        font-weight: 600;\r\n                    \">ðŸ“¦ View Repository</a>\r\n                </div>\r\n            </div>\r\n        `;\r\n        \r\n        document.body.appendChild(modal);\r\n        \r\n        // Close on outside click\r\n        modal.addEventListener('click', (e) => {\r\n            if (e.target === modal) {\r\n                modal.remove();\r\n            }\r\n        });\r\n    }\r\n    \r\n    checkPuterToken() {\r\n        // Check if Puter.js token is available\r\n        const tokenSection = document.getElementById('puter-token-section');\r\n        const tokenInput = document.getElementById('puter-token-input');\r\n        \r\n        if (!tokenSection || !tokenInput) return;\r\n        \r\n        // Check localStorage first\r\n        const savedToken = localStorage.getItem('puterAuthToken');\r\n        if (savedToken) {\r\n            tokenInput.value = savedToken;\r\n            tokenSection.style.display = 'block';\r\n            return;\r\n        }\r\n        \r\n        // Check if Puter.js is available and authenticated - only check 3 times\r\n        if (typeof puter !== 'undefined' && puter.auth) {\r\n            let attempts = 0;\r\n            const maxAttempts = 3;\r\n            \r\n            const checkAuth = setInterval(() => {\r\n                attempts++;\r\n                try {\r\n                    if (puter.auth.isSignedIn && puter.auth.isSignedIn()) {\r\n                        if (puter.auth.getToken) {\r\n                            const token = puter.auth.getToken();\r\n                            if (token) {\r\n                                tokenInput.value = token;\r\n                                tokenSection.style.display = 'block';\r\n                                localStorage.setItem('puterAuthToken', token);\r\n                                clearInterval(checkAuth);\r\n                                return;\r\n                            }\r\n                        }\r\n                    }\r\n                    \r\n                    // Also try accessing Puter's internal storage\r\n                    if (typeof puter.storage !== 'undefined' && puter.storage.get) {\r\n                        try {\r\n                            puter.storage.get('auth_token').then(token => {\r\n                                if (token) {\r\n                                    tokenInput.value = token;\r\n                                    tokenSection.style.display = 'block';\r\n                                    localStorage.setItem('puterAuthToken', token);\r\n                                    clearInterval(checkAuth);\r\n                                }\r\n                            }).catch(() => {});\r\n                        } catch (_e) {}\r\n                    }\r\n                } catch (_e) {\r\n                    // Ignore errors\r\n                }\r\n                \r\n                // Stop after 3 attempts\r\n                if (attempts >= maxAttempts) {\r\n                    clearInterval(checkAuth);\r\n                }\r\n            }, 2000);\r\n        }\r\n    }\r\n}\r\n\r\n// Global functions (exposed for HTML onclick handlers)\r\nwindow.usePrompt = function(prompt) {\r\n    const messageInput = document.getElementById('message-input');\r\n    if (messageInput) {\r\n        messageInput.value = prompt;\r\n        messageInput.focus();\r\n    }\r\n};\r\n\r\nwindow.hideLoginModal = function() {\r\n    const loginModal = document.getElementById('login-modal');\r\n    if (loginModal) {\r\n        loginModal.classList.remove('show');\r\n    }\r\n};\r\n\r\n// Make hideLoginModal globally accessible\r\nif (typeof window !== 'undefined') {\r\n    window.hideLoginModal = window.hideLoginModal || function() {\r\n        const loginModal = document.getElementById('login-modal');\r\n        if (loginModal) {\r\n            loginModal.classList.remove('show');\r\n        }\r\n    };\r\n}\r\n\r\nwindow.handleLogin = function(event) {\r\n    event.preventDefault();\r\n    const form = event.target;\r\n    const emailInput = form.querySelector('input[type=\"email\"]');\r\n    const email = emailInput ? emailInput.value : '';\r\n    \r\n    // Simulated login\r\n    const user = {\r\n        name: email.split('@')[0],\r\n        email: email\r\n    };\r\n    \r\n    localStorage.setItem('stellarAI_user', JSON.stringify(user));\r\n    stellarAI.currentUser = user;\r\n    stellarAI.updateUserUI();\r\n    \r\n    // Call hideLoginModal - it's now guaranteed to exist\r\n    if (typeof window.hideLoginModal === 'function') {\r\n        window.hideLoginModal();\r\n    }\r\n    \r\n    alert('Login successful! Your chats will now be saved.');\r\n}\r\n\r\n// Initialize Stellar AI\r\nlet stellarAI;\r\nwindow.addEventListener('load', () => {\r\n    stellarAI = new StellarAI();\r\n});\r\n\r\n\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\supabase-config.js","messages":[],"suppressedMessages":[{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":32,"column":38,"nodeType":"Identifier","messageId":"undef","endLine":32,"endColumn":44,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'module' is not defined.","line":34,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":34,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]},{"filePath":"C:\\Users\\adyba\\adriano-to-the-star\\universal-graphics.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":["@stylistic/no-extra-semi"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"no-extra-semi","url":"https://eslint.style/rules/no-extra-semi"}}]}},{"ruleId":"wrap-iife","replacedBy":["@stylistic/wrap-iife"],"info":{"message":"Formatting rules are being moved out of ESLint core.","url":"https://eslint.org/blog/2023/10/deprecating-formatting-rules/","deprecatedSince":"8.53.0","availableUntil":"11.0.0","replacedBy":[{"message":"ESLint Stylistic now maintains deprecated stylistic core rules.","url":"https://eslint.style/guide/migration","plugin":{"name":"@stylistic/eslint-plugin","url":"https://eslint.style"},"rule":{"name":"wrap-iife","url":"https://eslint.style/rules/wrap-iife"}}]}},{"ruleId":"no-new-object","replacedBy":["no-object-constructor"],"info":{"message":"The new rule flags more situations where object literal syntax can be used, and it does not report a problem when the `Object` constructor is invoked with an argument.","url":"https://eslint.org/blog/2023/09/eslint-v8.50.0-released/","deprecatedSince":"8.50.0","availableUntil":"11.0.0","replacedBy":[{"rule":{"name":"no-object-constructor","url":"https://eslint.org/docs/rules/no-object-constructor"}}]}}]}]