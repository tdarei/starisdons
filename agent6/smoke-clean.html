<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Agent 6 Smoke Test - Clean Version</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
    .container { max-width: 1200px; margin: 0 auto; }
    .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 10px; text-align: center; margin-bottom: 30px; }
    .header h1 { margin: 0; font-size: 2.5rem; }
    .header p { margin: 10px 0 0 0; opacity: 0.9; }
    .controls { margin: 20px 0; text-align: center; }
    .btn { background: #667eea; color: white; border: none; padding: 12px 24px; margin: 5px; border-radius: 5px; cursor: pointer; font-size: 14px; }
    .btn:hover { background: #5a6fd8; }
    .status { background: white; padding: 20px; border-radius: 10px; margin: 20px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .status h3 { margin-top: 0; color: #333; }
    .module-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
    .module-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    .module-card h4 { margin-top: 0; color: #667eea; }
    .toast-container { position: fixed; top: 20px; right: 20px; z-index: 1000; max-width: 400px; }
    .toast { background: white; padding: 15px 20px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); border-left: 4px solid #667eea; animation: slideIn 0.3s ease; }
    @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    .error { border-left-color: #e74c3c; }
    .success { border-left-color: #2ecc71; }
    .warning { border-left-color: #f39c12; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üöÄ Agent 6 Smoke Test</h1>
      <p>Clean version - No duplicate module loading</p>
    </div>

    <div class="controls">
      <button class="btn" onclick="runBasicTests()">üîß Basic Tests</button>
      <button class="btn" onclick="runAIMLTests()">ü§ñ AI/ML Tests</button>
      <button class="btn" onclick="runBlockchainTests()">‚õìÔ∏è Blockchain Tests</button>
      <button class="btn" onclick="runSecurityTests()">üîí Security Tests</button>
      <button class="btn" onclick="runUITests()">üé® UI Tests</button>
      <button class="btn" onclick="clearToasts()">üßπ Clear</button>
    </div>

    <div class="status">
      <h3>üìä Test Status</h3>
      <div id="test-status">Ready to run tests...</div>
    </div>

    <div class="module-grid" id="module-grid">
      <!-- Test results will appear here -->
    </div>
  </div>

  <div class="toast-container" id="toast-container"></div>

  <!-- Load only essential modules for testing -->
  <script src="./modules.js"></script>

  <script>
    let testResults = [];
    
    function showToast(message, type = 'info') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      container.appendChild(toast);
      
      setTimeout(() => {
        toast.style.animation = 'slideIn 0.3s ease reverse';
        setTimeout(() => toast.remove(), 300);
      }, 4000);
    }

    function updateStatus(message) {
      document.getElementById('test-status').textContent = message;
    }

    function addTestResult(category, module, status, details) {
      const grid = document.getElementById('module-grid');
      const card = document.createElement('div');
      card.className = 'module-card';
      card.innerHTML = `
        <h4>${module}</h4>
        <p><strong>Category:</strong> ${category}</p>
        <p><strong>Status:</strong> <span style="color: ${status === '‚úÖ' ? '#2ecc71' : '#e74c3c'}">${status}</span></p>
        <p><strong>Details:</strong> ${details}</p>
      `;
      grid.appendChild(card);
    }

    async function runBasicTests() {
      updateStatus('Running basic module tests...');
      showToast('üîß Starting basic module tests', 'info');
      
      try {
        // Test basic modules
        if (window.LeadScoring) {
          const ls = new LeadScoring();
          const score = ls.score({activity: 0.8, fit: 0.6, intent: 0.9});
          addTestResult('AI/ML', 'LeadScoring', '‚úÖ', `Score: ${score.toFixed(2)}`);
        } else {
          addTestResult('AI/ML', 'LeadScoring', '‚ùå', 'Module not loaded');
        }

        if (window.IamSystem) {
          const iam = new IamSystem();
          iam.addPermission('read');
          iam.addRole('viewer', ['read']);
          iam.addUser('user1', ['viewer']);
          const canRead = iam.can('user1', 'read');
          addTestResult('Security', 'IamSystem', '‚úÖ', `Can read: ${canRead}`);
        } else {
          addTestResult('Security', 'IamSystem', '‚ùå', 'Module not loaded');
        }

        if (window.BlockchainWallet) {
          const wallet = new BlockchainWallet();
          addTestResult('Blockchain', 'BlockchainWallet', '‚úÖ', 'Module loaded successfully');
        } else {
          addTestResult('Blockchain', 'BlockchainWallet', '‚ùå', 'Module not loaded');
        }

        updateStatus('Basic tests completed');
        showToast('‚úÖ Basic tests completed', 'success');
      } catch (error) {
        updateStatus(`Basic tests failed: ${error.message}`);
        showToast(`‚ùå Basic tests failed: ${error.message}`, 'error');
      }
    }

    async function runAIMLTests() {
      updateStatus('Running AI/ML module tests...');
      showToast('ü§ñ Starting AI/ML tests', 'info');
      
      try {
        const modules = [
          'LeadScoring', 'CustomerLifetimeValue', 'CustomerChurnPrediction',
          'ComputerVision', 'NaturalLanguageProcessing', 'TextToSpeech'
        ];
        
        for (const moduleName of modules) {
          if (window[moduleName]) {
            addTestResult('AI/ML', moduleName, '‚úÖ', 'Module loaded');
          } else {
            addTestResult('AI/ML', moduleName, '‚ùå', 'Module not loaded');
          }
        }
        
        updateStatus('AI/ML tests completed');
        showToast('‚úÖ AI/ML tests completed', 'success');
      } catch (error) {
        updateStatus(`AI/ML tests failed: ${error.message}`);
        showToast(`‚ùå AI/ML tests failed: ${error.message}`, 'error');
      }
    }

    async function runBlockchainTests() {
      updateStatus('Running Blockchain module tests...');
      showToast('‚õìÔ∏è Starting Blockchain tests', 'info');
      
      try {
        const modules = [
          'BlockchainWallet', 'BlockchainExplorer', 'ZeroKnowledgeProofs',
          'SmartContractDeployment', 'NftMinting', 'PrivacyCoins'
        ];
        
        for (const moduleName of modules) {
          if (window[moduleName]) {
            addTestResult('Blockchain', moduleName, '‚úÖ', 'Module loaded');
          } else {
            addTestResult('Blockchain', moduleName, '‚ùå', 'Module not loaded');
          }
        }
        
        updateStatus('Blockchain tests completed');
        showToast('‚úÖ Blockchain tests completed', 'success');
      } catch (error) {
        updateStatus(`Blockchain tests failed: ${error.message}`);
        showToast(`‚ùå Blockchain tests failed: ${error.message}`, 'error');
      }
    }

    async function runSecurityTests() {
      updateStatus('Running Security module tests...');
      showToast('üîí Starting Security tests', 'info');
      
      try {
        const modules = [
          'IamSystem', 'MfaSystem', 'SiemSystem', 'SecurityAuditLog',
          'VulnerabilityScanner', 'ThreatIntelligence'
        ];
        
        for (const moduleName of modules) {
          if (window[moduleName]) {
            addTestResult('Security', moduleName, '‚úÖ', 'Module loaded');
          } else {
            addTestResult('Security', moduleName, '‚ùå', 'Module not loaded');
          }
        }
        
        updateStatus('Security tests completed');
        showToast('‚úÖ Security tests completed', 'success');
      } catch (error) {
        updateStatus(`Security tests failed: ${error.message}`);
        showToast(`‚ùå Security tests failed: ${error.message}`, 'error');
      }
    }

    async function runUITests() {
      updateStatus('Running UI module tests...');
      showToast('üé® Starting UI tests', 'info');
      
      try {
        const modules = [
          'CodeEditor', 'RichTextEditor', 'MarkdownEditor',
          'VideoPlayer', 'AudioPlayer', 'ImageViewer',
          'Modal', 'Carousel', 'Accordion'
        ];
        
        for (const moduleName of modules) {
          if (window[moduleName]) {
            addTestResult('UI', moduleName, '‚úÖ', 'Module loaded');
          } else {
            addTestResult('UI', moduleName, '‚ùå', 'Module not loaded');
          }
        }
        
        updateStatus('UI tests completed');
        showToast('‚úÖ UI tests completed', 'success');
      } catch (error) {
        updateStatus(`UI tests failed: ${error.message}`);
        showToast(`‚ùå UI tests failed: ${error.message}`, 'error');
      }
    }

    function clearToasts() {
      document.getElementById('toast-container').innerHTML = '';
      document.getElementById('module-grid').innerHTML = '';
      updateStatus('Ready to run tests...');
      showToast('üßπ Test results cleared', 'info');
    }

    // Auto-run basic test on load
    window.addEventListener('load', async () => {
      showToast('üöÄ Agent 6 Clean Smoke Test Loaded', 'success');
      updateStatus('Agent 6 modules loaded. Ready for testing.');
      
      // Wait for modules to load
      await new Promise(resolve => setTimeout(resolve, 1000));
      
      // Run basic test automatically
      await runBasicTests();
    });
  </script>
</body>
</html>