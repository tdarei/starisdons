(()=>{"use strict";var e,t={835:(e,t,n)=>{function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function r(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function a(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,s=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=a.call(n)).done)&&(s.push(o.value),s.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw r}}return s}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=n(467),l=n(29),c=n(212),d=n(756),u=n.n(d);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var h,p=function(){return(0,c.A)(function e(){var t=this;(0,l.A)(this,e),this.currentChatId=null,this.chats=[],this.currentUser=null,this.attachedImages=[],this.attachedFiles=[],this.isProcessing=!1,this.selectedModel="sonnet-4.5",this.voiceEnabled=!1,this.isListening=!1,this.recognition=null,this.synthesis=window.speechSynthesis,this.currentUtterance=null,this.voiceAutoSend=!1,this.voiceCommands={"send message":function(){return t.sendMessage()},"new chat":function(){return t.createNewChat()},"clear input":function(){var e=document.getElementById("message-input");e&&(e.value=""),t.updateCharCount()},"stop listening":function(){t.isListening&&t.recognition.stop()}},this.init()},[{key:"init",value:(v=(0,s.A)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("üåü Initializing Stellar AI..."),"loading"!==document.readyState){e.next=1;break}return e.next=1,new Promise(function(e){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e()});case 1:return e.next=2,this.initPuter();case 2:this.loadUserSession(),this.loadChatHistory(),this.setupEventListeners(),this.initVoiceFeatures(),0===this.chats.length&&this.createNewChat(),console.log("‚úÖ Stellar AI initialized");case 3:case"end":return e.stop()}},e,this)})),function(){return v.apply(this,arguments)})},{key:"initPuter",value:(p=(0,s.A)(u().mark(function e(){var t;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.selectedModel||!this.selectedModel.includes("live")&&!this.selectedModel.includes("native-audio")){e.next=1;break}return console.log("Skipping Puter.js initialization - using live model"),this.puterAvailable=!1,e.abrupt("return");case 1:if(window.PUTER_DISABLE_AUTO_LOGIN=!0,"undefined"!=typeof puter){console.log("‚úÖ Puter SDK loaded"),this.puterAvailable=!0;try{if(puter.auth&&puter.auth.isSignedIn&&"function"==typeof puter.auth.isSignedIn&&puter.auth.isSignedIn())try{puter.auth.getToken&&(t=puter.auth.getToken())&&(localStorage.setItem("puterAuthToken",t),console.log("‚úÖ Puter.js authenticated - token saved for CLI"))}catch(e){console.warn("Could not get Puter token:",e)}}catch(e){console.log("Puter.js auth check skipped (not needed for live models)")}}else console.log("‚ÑπÔ∏è  Puter SDK not available - using backend WebSocket for live models"),this.puterAvailable=!1;e.next=3;break;case 2:e.prev=2,e.catch(0),console.log("‚ÑπÔ∏è  Puter.js initialization skipped (not needed for live models)"),this.puterAvailable=!1;case 3:case"end":return e.stop()}},e,this,[[0,2]])})),function(){return p.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this,t=document.getElementById("send-btn");t&&t.addEventListener("click",function(){return e.sendMessage()});var n=document.getElementById("message-input");n&&(n.addEventListener("keydown",function(t){"Enter"!==t.key||t.shiftKey||(t.preventDefault(),e.sendMessage()),e.autoResizeTextarea(n)}),n.addEventListener("input",function(){e.updateCharCount(),e.autoResizeTextarea(n)}));var o=document.getElementById("attach-btn"),r=document.getElementById("file-input");o&&r&&o.addEventListener("click",function(){r.click()}),r&&r.addEventListener("change",function(t){e.handleFileUpload(t.target.files)});var a=document.getElementById("new-chat-btn");a&&a.addEventListener("click",function(){e.createNewChat()});var i=document.getElementById("clear-chat-btn");i&&i.addEventListener("click",function(){e.clearCurrentChat()});var s=document.getElementById("export-chat-btn");s&&s.addEventListener("click",function(){e.exportChat()});var l=document.getElementById("metrics-btn");l&&l.addEventListener("click",function(){e.showMetricsDashboard()});var c=document.getElementById("model-selector");c&&(c.addEventListener("change",function(t){e.selectedModel=t.target.value,e.saveModelPreference(),e.showModelChangeNotification(),e.selectedModel&&(e.selectedModel.includes("live")||e.selectedModel.includes("native-audio"))?(console.log("Switched to live model - Puter.js not required"),window.PUTER_DISABLE_AUTO_LOGIN=!0,e.puterAvailable=!1):("undefined"==typeof puter&&e.loadPuterJS(),e.checkPuterToken())}),this.loadModelPreference());var d=document.getElementById("login-btn");d&&d.addEventListener("click",function(){e.showLoginModal()});var u=document.getElementById("download-cli-btn");u&&u.addEventListener("click",function(){e.downloadCLI()});var m=document.getElementById("copy-token-btn");m&&m.addEventListener("click",function(){var e=document.getElementById("puter-token-input");e&&e.value&&(e.select(),document.execCommand("copy"),m.textContent="Copied!",setTimeout(function(){m.textContent="Copy"},2e3))}),this.selectedModel&&(this.selectedModel.includes("live")||this.selectedModel.includes("native-audio"))||this.checkPuterToken();var g=document.getElementById("voice-input-btn");g&&g.addEventListener("click",function(){return e.toggleVoiceInput()});var h=document.getElementById("voice-output-btn");h&&h.addEventListener("click",function(){return e.toggleVoiceOutput()});var p=document.getElementById("livekit-voice-btn");p&&p.addEventListener("click",function(){return e.toggleLiveKitVoice()}),this.initLiveKitVoice()}},{key:"initVoiceFeatures",value:function(){var e=this;if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){var t=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new t,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.maxAlternatives=1,this.recognition.onstart=function(){e.isListening=!0,e.updateVoiceInputUI(!0),e.showVoiceIndicator()},this.recognition.onend=function(){e.isListening=!1,e.updateVoiceInputUI(!1),e.hideVoiceIndicator()},this.recognition.onresult=function(t){for(var n="",o="",r=t.resultIndex;r<t.results.length;r++){var a=t.results[r][0].transcript;t.results[r].isFinal?o+=a+" ":n+=a}var i=document.getElementById("message-input");i&&(i.value=o+n,e.updateCharCount(),e.autoResizeTextarea(i),o&&e.handleVoiceCommand(o.trim().toLowerCase()))},this.recognition.onerror=function(t){console.error("Speech recognition error",t.error),e.isListening=!1,e.updateVoiceInputUI(!1),e.hideVoiceIndicator(),"no-speech"===t.error?e.showVoiceNotification("No speech detected. Try again.","warning"):"audio-capture"===t.error?e.showVoiceNotification("Microphone not found. Please check your microphone.","error"):"not-allowed"===t.error?e.showVoiceNotification("Microphone permission denied. Please enable microphone access.","error"):e.showVoiceNotification("Voice recognition error. Please try again.","error")}}else{var n=document.getElementById("voice-input-btn");n&&(n.style.display="none",n.title="Voice input not supported in this browser"),console.warn("Speech recognition not supported")}}},{key:"handleVoiceCommand",value:function(e){for(var t=this,n=0,o=Object.entries(this.voiceCommands);n<o.length;n++){var r=i(o[n],2),a=r[0],s=r[1];if(e.includes(a))return s(),this.showVoiceNotification("Voice command executed: ".concat(a),"success"),!0}return this.voiceAutoSend&&e.length>5&&setTimeout(function(){t.sendMessage()},500),!1}},{key:"updateVoiceInputUI",value:function(e){var t=document.getElementById("voice-input-btn");t&&(e?(t.classList.add("listening"),t.style.color="#ef4444",t.style.animation="pulse 1.5s infinite",t.title="Listening... Click to stop"):(t.classList.remove("listening"),t.style.color="",t.style.animation="",t.title="Voice Input"))}},{key:"showVoiceIndicator",value:function(){var e=document.getElementById("voice-indicator");e||((e=document.createElement("div")).id="voice-indicator",e.style.cssText="\n                position: fixed;\n                top: 50%;\n                left: 50%;\n                transform: translate(-50%, -50%);\n                background: rgba(0, 0, 0, 0.9);\n                border: 3px solid #ef4444;\n                border-radius: 20px;\n                padding: 2rem 3rem;\n                z-index: 10000;\n                text-align: center;\n                color: white;\n                font-family: 'Raleway', sans-serif;\n            ",e.innerHTML='\n                <div style="font-size: 3rem; margin-bottom: 1rem;">üé§</div>\n                <div style="font-size: 1.2rem; font-weight: 600; color: #ef4444;">Listening...</div>\n                <div style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.7;">Speak now</div>\n            ',document.body.appendChild(e)),e.style.display="block"}},{key:"hideVoiceIndicator",value:function(){var e=document.getElementById("voice-indicator");e&&(e.style.display="none")}},{key:"showVoiceNotification",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";if(window.databaseAdvancedFeatures&&window.databaseAdvancedFeatures.showNotification)window.databaseAdvancedFeatures.showNotification(e,t);else{var n=document.createElement("div");n.style.cssText="\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            padding: 1rem 1.5rem;\n            background: ".concat("error"===t?"rgba(239, 68, 68, 0.9)":"success"===t?"rgba(74, 222, 128, 0.9)":"rgba(96, 165, 250, 0.9)",";\n            color: white;\n            border-radius: 8px;\n            z-index: 10001;\n            font-family: 'Raleway', sans-serif;\n            animation: slideIn 0.3s ease;\n        "),n.textContent=e,document.body.appendChild(n),setTimeout(function(){n.style.animation="slideOut 0.3s ease",setTimeout(function(){return n.remove()},300)},3e3)}}},{key:"toggleVoiceInput",value:function(){if(this.recognition)if(this.isListening)this.recognition.stop();else try{this.recognition.start()}catch(e){console.error("Error starting voice recognition:",e),this.showVoiceNotification("Error starting voice recognition. Please try again.","error")}else this.showVoiceNotification("Voice recognition not supported in this browser.","error")}},{key:"toggleVoiceOutput",value:function(){this.voiceEnabled=!this.voiceEnabled;var e=document.getElementById("voice-output-btn");e&&(e.textContent=this.voiceEnabled?"üîä":"üîá",e.style.color=this.voiceEnabled?"#4ade80":""),this.voiceEnabled||this.synthesis.cancel()}},{key:"speak",value:function(e){if(this.voiceEnabled&&this.synthesis){this.synthesis.cancel();var t=e.replace(/[*`#]/g,"").replace(/<[^>]*>/g,"").replace(/\[([^\]]+)\]\([^\)]+\)/g,"$1").replace(/\n{3,}/g,"\n\n").trim(),n=t.length>200?this.splitTextIntoChunks(t,200):[t];this.speakChunks(n,0)}}},{key:"splitTextIntoChunks",value:function(e,t){var n,o=[],r="",a=m(e.match(/[^.!?]+[.!?]+/g)||[e]);try{for(a.s();!(n=a.n()).done;){var i=n.value;(r+i).length<=t?r+=i:(r&&o.push(r.trim()),r=i)}}catch(e){a.e(e)}finally{a.f()}return r&&o.push(r.trim()),o.length>0?o:[e]}},{key:"speakChunks",value:function(e,t){var n=this;if(!(t>=e.length)&&this.voiceEnabled){var o=new SpeechSynthesisUtterance(e[t]);o.lang="en-US",o.rate=1,o.pitch=1,o.volume=1;var r=this.synthesis.getVoices(),a=r.find(function(e){return e.lang.startsWith("en")&&(e.name.includes("Google")||e.name.includes("Natural"))})||r.find(function(e){return e.lang.startsWith("en")})||r[0];a&&(o.voice=a),o.onend=function(){n.speakChunks(e,t+1)},o.onerror=function(o){console.error("Speech synthesis error:",o),n.speakChunks(e,t+1)},this.currentUtterance=o,this.synthesis.speak(o)}}},{key:"initLiveKitVoice",value:function(){var e=this;if("undefined"!=typeof LiveKitVoiceIntegration)this.livekitVoice=new LiveKitVoiceIntegration,this.livekitVoice.init(function(t,n){console.log("LiveKit Status: ".concat(t," - ").concat(n)),e.showNotification(n,"error"===t?"error":"info");var o=document.getElementById("livekit-voice-btn");o&&("connected"===t?(o.textContent="üéôÔ∏è",o.style.color="#4ade80",o.title="Disconnect from voice agent",e.livekitConnected=!0):"disconnected"===t||"error"===t?(o.textContent="üéôÔ∏è",o.style.color="",o.title="Start Live Voice Conversation",e.livekitConnected=!1):"connecting"===t&&(o.textContent="‚è≥",o.style.color="#fbbf24",o.title="Connecting..."))},function(e){e.text&&console.log("LiveKit Transcript:",e.text)}).then(function(e){e||console.error("LiveKit voice integration initialization failed")}).catch(function(e){console.error("Error initializing LiveKit voice integration:",e)});else{console.warn("LiveKit Voice Integration not loaded");var t=document.getElementById("livekit-voice-btn");t&&(t.style.display="none")}}},{key:"toggleLiveKitVoice",value:(h=(0,s.A)(u().mark(function e(){var t,n,o;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.livekitVoice){e.next=1;break}return this.showNotification("LiveKit Voice Integration not available","error"),e.abrupt("return");case 1:if(e.prev=1,!this.livekitConnected){e.next=3;break}return e.next=2,this.livekitVoice.disconnect();case 2:this.showNotification("Disconnected from voice agent","info"),e.next=5;break;case 3:return n=(null===(t=this.currentUser)||void 0===t?void 0:t.email)||"Guest",e.next=4,this.livekitVoice.connect(n);case 4:e.sent?this.showNotification("Connected to voice agent! Start speaking...","success"):this.showNotification("Failed to connect to voice agent","error");case 5:e.next=7;break;case 6:e.prev=6,o=e.catch(1),console.error("Error toggling LiveKit voice:",o),this.showNotification("Error: ".concat(o.message),"error");case 7:case"end":return e.stop()}},e,this,[[1,6]])})),function(){return h.apply(this,arguments)})},{key:"showNotification",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=document.createElement("div");n.className="notification notification-".concat(t),n.textContent=e,n.style.cssText="\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            padding: 12px 20px;\n            background: ".concat("error"===t?"#ef4444":"success"===t?"#4ade80":"#3b82f6",";\n            color: white;\n            border-radius: 8px;\n            z-index: 10000;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n            animation: slideIn 0.3s ease-out;\n        "),document.body.appendChild(n),setTimeout(function(){n.style.animation="slideOut 0.3s ease-out",setTimeout(function(){n.parentNode&&n.parentNode.removeChild(n)},300)},3e3)}},{key:"autoResizeTextarea",value:function(e){e.style.height="auto",e.style.height=Math.min(e.scrollHeight,200)+"px"}},{key:"updateCharCount",value:function(){var e=document.getElementById("message-input"),t=document.getElementById("char-count");if(e&&t){var n=e.value.length;t.textContent="".concat(n," / 4000")}}},{key:"createNewChat",value:function(){var e="chat_"+Date.now(),t={id:e,title:"New Chat",messages:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};this.chats.unshift(t),this.switchToChat(e),this.updateChatHistory(),this.saveChatHistory(),this.hideWelcome()}},{key:"switchToChat",value:function(e){this.currentChatId=e;var t=this.chats.find(function(t){return t.id===e});if(t){var n=document.getElementById("current-chat-title");n&&(n.textContent=t.title),this.renderMessages(t.messages),this.updateChatHistory()}}},{key:"hideWelcome",value:function(){var e=document.querySelector(".welcome-message");e&&(e.style.display="none")}},{key:"sendMessage",value:(g=(0,s.A)(u().mark(function e(){var t,n,o,r,i,s,l,c,d,m,g,h,p,v,f=this;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isProcessing){e.next=1;break}return e.abrupt("return");case 1:if(t=document.getElementById("message-input")){e.next=2;break}return console.warn("‚ö†Ô∏è Message input not found"),e.abrupt("return");case 2:if((n=t.value.trim())||0!==this.attachedImages.length||0!==this.attachedFiles.length){e.next=3;break}return e.abrupt("return");case 3:if(this.hideWelcome(),this.isProcessing=!0,(o=document.getElementById("send-btn"))&&(o.disabled=!0),r={role:"user",content:n,images:a(this.attachedImages),files:a(this.attachedFiles),timestamp:(new Date).toISOString()},!(i=this.chats.find(function(e){return e.id===f.currentChatId}))){e.next=8;break}return i.messages.push(r),1===i.messages.length&&n&&(i.title=n.substring(0,50)+(n.length>50?"...":""),(s=document.getElementById("current-chat-title"))&&(s.textContent=i.title)),this.appendMessage(r),t.value="",this.attachedImages=[],this.attachedFiles=[],(l=document.getElementById("attachments-preview"))&&(l.innerHTML=""),this.updateCharCount(),t.style.height="auto",this.showLoadingIndicator(),c=null,window.aiModelMetrics&&"function"==typeof window.aiModelMetrics&&(d=window.aiModelMetrics())&&(c=d.startRequest(this.selectedModel,n,{hasImages:this.attachedImages.length>0,hasFiles:this.attachedFiles.length>0})),e.prev=4,e.next=5,this.getAIResponse(i);case 5:c&&window.aiModelMetrics&&"function"==typeof window.aiModelMetrics&&(m=window.aiModelMetrics())&&(g=i.messages[i.messages.length-1],h=g&&"assistant"===g.role?g.content:"",m.completeRequest(c,h,null)),window.aiUsageLogger&&"function"==typeof window.aiUsageLogger.log&&window.aiUsageLogger.log({feature:"stellar-ai",model:this.selectedModel,context:{hasImages:this.attachedImages.length>0,hasFiles:this.attachedFiles.length>0,messageLength:n.length}}),e.next=7;break;case 6:throw e.prev=6,v=e.catch(4),c&&window.aiModelMetrics&&"function"==typeof window.aiModelMetrics&&(p=window.aiModelMetrics())&&p.completeRequest(c,null,v),v;case 7:this.saveChatHistory(),this.updateChatHistory();case 8:this.isProcessing=!1,o&&(o.disabled=!1),t&&t.focus();case 9:case"end":return e.stop()}},e,this,[[4,6]])})),function(){return g.apply(this,arguments)})},{key:"getAIResponse",value:(d=(0,s.A)(u().mark(function e(t){var n,o,r,a,i,s,l,c,d,m,g;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n="","gemini-2.5-flash-native-audio-preview-09-2025"!==this.selectedModel&&"gemini-2.5-flash-live-preview"!==this.selectedModel&&"gemini-2.5-flash-live"!==this.selectedModel&&"gemini-live-2.5-flash-preview"!==this.selectedModel&&!this.selectedModel.includes("live")&&!this.selectedModel.includes("native-audio")){e.next=6;break}return console.log("[Stellar AI] Using Live API for model: ".concat(this.selectedModel)),e.prev=1,e.next=2,this.getGeminiLiveResponse(t,!0);case 2:if((n=e.sent)&&!n.trim().startsWith("‚ö†Ô∏è")&&!n.includes("I apologize, but I encountered an error")){e.next=3;break}throw new Error(n||"No response from Gemini Live API");case 3:e.next=5;break;case 4:throw e.prev=4,d=e.catch(1),console.error("[Stellar AI] Gemini Live API failed:",d),d;case 5:e.next=19;break;case 6:if("fallback"!==this.selectedModel){e.next=7;break}n=this.getFallbackResponse(t.messages[t.messages.length-1].content),e.next=19;break;case 7:if(!this.puterAvailable||"undefined"==typeof puter||!puter.ai||this.selectedModel.includes("live")||this.selectedModel.includes("native-audio")){e.next=18;break}if(console.log("Using Puter AI with model: ".concat(this.selectedModel,"...")),o=t.messages.slice(-10).map(function(e){return{role:e.role,content:e.content}}),e.prev=8,a={model:this.selectedModel,messages:o},!puter.ai.chat){e.next=10;break}return e.next=9,puter.ai.chat(o,{model:this.selectedModel});case 9:i=e.sent,e.next=14;break;case 10:if(!puter.ai.complete){e.next=12;break}return e.next=11,puter.ai.complete(a);case 11:i=e.sent,e.next=14;break;case 12:return e.next=13,puter.ai.chat(o);case 13:i=e.sent;case 14:if(n=(null===(r=i.message)||void 0===r?void 0:r.content)||i.content||i.text||i){e.next=15;break}throw new Error("Empty response from AI");case 15:e.next=17;break;case 16:e.prev=16,m=e.catch(8),console.warn("Puter AI error with ".concat(this.selectedModel,", using fallback:"),m),n=this.getFallbackResponse(t.messages[t.messages.length-1].content);case 17:e.next=19;break;case 18:n=this.getFallbackResponse(t.messages[t.messages.length-1].content);case 19:s={role:"assistant",content:n,model:this.selectedModel,timestamp:(new Date).toISOString()},this.hideLoadingIndicator(),t.messages.push(s),t.updatedAt=(new Date).toISOString(),this.streamingMessageElement?this.finalizeStreamingMessage(s):this.appendMessage(s),this.speak(n),e.next=21;break;case 20:e.prev=20,g=e.catch(0),console.error("Error getting AI response:",g),this.hideLoadingIndicator(),l=g.message||"I apologize, but I encountered an error processing your request. Please try again.",c={role:"assistant",content:l,timestamp:(new Date).toISOString(),isError:!0},t.messages.push(c),this.appendMessage(c);case 21:case"end":return e.stop()}},e,this,[[0,20],[1,4],[8,16]])})),function(e){return d.apply(this,arguments)})},{key:"getFallbackResponse",value:function(e){for(var t={exoplanet:"Exoplanets are planets that orbit stars outside our solar system. The Kepler mission has discovered thousands of exoplanets, many of which are in the habitable zone of their stars. Would you like to know more about specific types of exoplanets?",andromeda:"The Andromeda Galaxy (M31) is the nearest major galaxy to the Milky Way, located about 2.5 million light-years away. It contains approximately one trillion stars and is on a collision course with our galaxy, though this won't happen for another 4 billion years!",kepler:"Kepler objects are celestial bodies discovered by NASA's Kepler Space Telescope. The Kepler mission discovered over 2,600 confirmed exoplanets by monitoring the brightness of stars and detecting tiny dips that indicate a planet passing in front of them.",default:"I'm Stellar AI, your cosmic assistant! I can help you learn about exoplanets, galaxies, space exploration, and the Kepler mission. What would you like to know about?"},n=e.toLowerCase(),o=0,r=Object.entries(t);o<r.length;o++){var a=i(r[o],2),s=a[0],l=a[1];if(n.includes(s))return l}return t.default}},{key:"showLoadingIndicator",value:function(){var e=document.getElementById("messages-container");e.insertAdjacentHTML("beforeend",'\n            <div class="message ai-message loading-message">\n                <div class="message-avatar">üåü</div>\n                <div class="message-content">\n                    <div class="message-loading">\n                        <div class="loading-dot"></div>\n                        <div class="loading-dot"></div>\n                        <div class="loading-dot"></div>\n                    </div>\n                </div>\n            </div>\n        '),e.scrollTop=e.scrollHeight}},{key:"hideLoadingIndicator",value:function(){var e=document.querySelector(".loading-message");e&&e.remove()}},{key:"appendMessage",value:function(e){var t=document.getElementById("messages-container"),n=this.createMessageHTML(e);t.insertAdjacentHTML("beforeend",n),t.scrollTop=t.scrollHeight}},{key:"startStreamingMessage",value:function(e){var t=document.getElementById("messages-container");this.hideLoadingIndicator();var n=this.createMessageHTML(e);t.insertAdjacentHTML("beforeend",n);var o=t.querySelectorAll(".message");return this.streamingMessageElement=o[o.length-1],this.streamingMessageId=e.timestamp||Date.now().toString(),this.streamingMessageElement&&(this.streamingMessageElement.dataset.messageId=this.streamingMessageId),t.scrollTop=t.scrollHeight,this.streamingMessageElement}},{key:"updateStreamingMessage",value:function(e){if(this.streamingMessageElement){var t=this.streamingMessageElement.querySelector(".message-text");if(t){var n=t.textContent||"";t.textContent=n+e;var o=document.getElementById("messages-container");o&&(o.scrollTop=o.scrollHeight)}}}},{key:"finalizeStreamingMessage",value:function(e){if(this.streamingMessageElement){var t=this.streamingMessageElement.querySelector(".message-text");t&&(t.innerHTML=this.formatText(e.content)),this.streamingMessageElement=null,this.streamingMessageId=null}}},{key:"renderMessages",value:function(e){var t=this,n=document.getElementById("messages-container");n.innerHTML="",0!==e.length?(e.forEach(function(e){n.insertAdjacentHTML("beforeend",t.createMessageHTML(e))}),n.scrollTop=n.scrollHeight):n.innerHTML=this.getWelcomeHTML()}},{key:"createMessageHTML",value:function(e){var t=this,n=new Date(e.timestamp).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),o="user"===e.role,r=o?"üë§":"üåü",a=o?"You":"Stellar AI";!o&&e.model&&(a+=" (".concat(this.getModelDisplayName(e.model),")"));var i=o?"user-message":"ai-message",s="";e.images&&e.images.length>0&&(s='<div class="message-images">'+e.images.map(function(e){var n=t.escapeHtml(e.url||"");return'<img src="'.concat(n,'" alt="Uploaded image" class="message-image" data-url="').concat(n,'">')}).join("")+"</div>");var l="";e.files&&e.files.length>0&&(l='<div class="message-files">'+e.files.map(function(e){var n=t.escapeHtml(e.name||""),o=t.escapeHtml(e.url||""),r="üìÑ";return"application/pdf"===e.type||e.name.endsWith(".pdf")?r="üìï":e.type.includes("word")||e.name.endsWith(".doc")||e.name.endsWith(".docx")?r="üìò":("text/plain"===e.type||e.name.endsWith(".txt"))&&(r="üìù"),'<div class="message-file">\n                        <span class="file-icon">'.concat(r,'</span>\n                        <span class="file-name">').concat(n,'</span>\n                        <a href="').concat(o,'" download="').concat(n,'" class="file-download">Download</a>\n                    </div>')}).join("")+"</div>");var c=this.escapeHtml(a),d=this.escapeHtml(n),u=this.escapeHtml(i);return'\n            <div class="message '.concat(u,'">\n                <div class="message-avatar">').concat(r,'</div>\n                <div class="message-content">\n                    <div class="message-header">\n                        <span class="message-author">').concat(c,'</span>\n                        <span class="message-time">').concat(d,'</span>\n                    </div>\n                    <div class="message-text">').concat(this.formatText(e.content),"</div>\n                    ").concat(s,"\n                    ").concat(l,"\n                </div>\n            </div>\n        ")}},{key:"escapeHtml",value:function(e){if(!e)return"";var t=document.createElement("div");return t.textContent=e,t.innerHTML}},{key:"formatText",value:function(e){return e?this.escapeHtml(e).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,"<code>$1</code>"):""}},{key:"getWelcomeHTML",value:function(){return'\n            <div class="welcome-message">\n                <div class="welcome-icon">üåå</div>\n                <h2>Welcome to Stellar AI</h2>\n                <p>Your intelligent cosmic companion powered by advanced AI</p>\n                <div class="welcome-features">\n                    <div class="feature">\n                        <span>üí¨</span>\n                        <span>Natural Conversations</span>\n                    </div>\n                    <div class="feature">\n                        <span>üñºÔ∏è</span>\n                        <span>Image Analysis</span>\n                    </div>\n                    <div class="feature">\n                        <span>üìö</span>\n                        <span>Knowledge Base</span>\n                    </div>\n                    <div class="feature">\n                        <span>üíæ</span>\n                        <span>Save History</span>\n                    </div>\n                </div>\n                <div class="example-prompts">\n                    <p>Try asking:</p>\n                    <button class="example-prompt" onclick="usePrompt(\'Tell me about exoplanets\')">\n                        Tell me about exoplanets\n                    </button>\n                    <button class="example-prompt" onclick="usePrompt(\'Explain the Andromeda galaxy\')">\n                        Explain the Andromeda galaxy\n                    </button>\n                    <button class="example-prompt" onclick="usePrompt(\'What is a Kepler object?\')">\n                        What is a Kepler object?\n                    </button>\n                </div>\n            </div>\n        '}},{key:"handleFileUpload",value:function(e){var t=this;Array.from(e).forEach(function(e){if(e.size>10485760)alert("".concat(e.name," is too large. Maximum size is 10MB."));else if(e.type.startsWith("image/")){var n=new FileReader;n.onload=function(n){var o={url:n.target.result,name:e.name,type:e.type,size:e.size};t.attachedImages.push(o),t.updateAttachmentsPreview()},n.readAsDataURL(e)}else if("application/pdf"===e.type||"application/msword"===e.type||"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===e.type||"text/plain"===e.type||e.name.endsWith(".pdf")||e.name.endsWith(".doc")||e.name.endsWith(".docx")||e.name.endsWith(".txt")){var o=new FileReader;o.onload=function(n){var o={url:n.target.result,name:e.name,type:e.type,size:e.size,isDocument:!0};t.attachedFiles.push(o),t.updateAttachmentsPreview()},o.readAsDataURL(e)}else alert("File type ".concat(e.type||"unknown"," is not supported. Please select images, PDF, DOC, DOCX, or TXT files."))})}},{key:"updateAttachmentsPreview",value:function(){var e=this,t=document.getElementById("attachments-preview");t&&(t.innerHTML="",this.attachedImages.forEach(function(n,o){var r=document.createElement("div");r.className="attachment-item";var a=e.escapeHtml(n.url||""),i=e.escapeHtml(n.name||""),s=document.createElement("img");s.src=a,s.className="attachment-thumbnail",s.alt=i;var l=document.createElement("button");l.className="remove-attachment",l.textContent="√ó",l.addEventListener("click",function(){e.removeImageAttachment(o)}),r.appendChild(s),r.appendChild(l),t.appendChild(r)}),this.attachedFiles.forEach(function(n,o){var r=document.createElement("div");r.className="attachment-item file-attachment";var a=e.escapeHtml(n.name||""),i=(n.size/1024).toFixed(1)+" KB",s="üìÑ";"application/pdf"===n.type||n.name.endsWith(".pdf")?s="üìï":n.type.includes("word")||n.name.endsWith(".doc")||n.name.endsWith(".docx")?s="üìò":("text/plain"===n.type||n.name.endsWith(".txt"))&&(s="üìù"),r.innerHTML='\n                <div class="file-icon">'.concat(s,'</div>\n                <div class="file-info">\n                    <div class="file-name">').concat(a,'</div>\n                    <div class="file-size">').concat(i,'</div>\n                </div>\n                <button class="remove-attachment" onclick="window.stellarAI.removeFileAttachment(').concat(o,')">√ó</button>\n            '),t.appendChild(r)}))}},{key:"removeImageAttachment",value:function(e){this.attachedImages.splice(e,1),this.updateAttachmentsPreview()}},{key:"removeFileAttachment",value:function(e){this.attachedFiles.splice(e,1),this.updateAttachmentsPreview()}},{key:"updateChatHistory",value:function(){var e=this,t=document.getElementById("chat-history-list");t.innerHTML="",this.chats.forEach(function(n){var o=n.id===e.currentChatId,r=n.messages[n.messages.length-1],a=r?r.content.substring(0,40)+"...":"Empty chat",i=document.createElement("div");i.className="history-item"+(o?" active":""),i.onclick=function(){return e.switchToChat(n.id)},i.innerHTML='\n                <div class="history-title">'.concat(n.title,'</div>\n                <div class="history-preview">').concat(a,"</div>\n            "),t.appendChild(i)})}},{key:"clearCurrentChat",value:function(){var e=this,t=this.chats.find(function(t){return t.id===e.currentChatId});if(t&&confirm("Clear all messages in this chat?")){t.messages=[],t.title="New Chat",t.updatedAt=(new Date).toISOString();var n=document.getElementById("current-chat-title");n&&(n.textContent="New Chat"),this.renderMessages([]),this.saveChatHistory(),this.updateChatHistory()}}},{key:"showMetricsDashboard",value:function(){if(window.aiModelMetrics&&"function"==typeof window.aiModelMetrics){var e=window.aiModelMetrics();if(e){var t=document.createElement("div");t.className="metrics-modal",t.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.9);\n            z-index: 10000;\n            overflow-y: auto;\n            padding: 2rem;\n        ";var n=document.createElement("div");n.id="metrics-dashboard-container",n.style.cssText="\n            max-width: 1200px;\n            margin: 0 auto;\n            position: relative;\n        ";var o=document.createElement("button");o.textContent="√ó",o.style.cssText="\n            position: absolute;\n            top: 0;\n            right: 0;\n            background: rgba(186, 148, 79, 0.2);\n            border: 2px solid rgba(186, 148, 79, 0.5);\n            color: #ba944f;\n            width: 40px;\n            height: 40px;\n            border-radius: 50%;\n            cursor: pointer;\n            font-size: 1.5rem;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            transition: all 0.3s ease;\n            z-index: 10001;\n        ",o.addEventListener("click",function(){return t.remove()}),o.addEventListener("mouseenter",function(){o.style.background="rgba(186, 148, 79, 0.4)",o.style.transform="scale(1.1)"}),o.addEventListener("mouseleave",function(){o.style.background="rgba(186, 148, 79, 0.2)",o.style.transform="scale(1)"}),n.appendChild(o),t.appendChild(n),document.body.appendChild(t),e.displayDashboard("metrics-dashboard-container")}else alert("Metrics system not initialized. Please refresh the page.")}else alert("Metrics system not available. Please refresh the page.")}},{key:"exportChat",value:function(){var e=this,t=this.chats.find(function(t){return t.id===e.currentChatId});if(t&&0!==t.messages.length){var n=t.messages.map(function(e){var t="user"===e.role?"You":"Stellar AI",n=new Date(e.timestamp).toLocaleString();return"[".concat(n,"] ").concat(t,": ").concat(e.content)}).join("\n\n"),o=new Blob([n],{type:"text/plain"}),r=URL.createObjectURL(o),a=document.createElement("a");a.href=r,a.download="stellar-ai-".concat(t.title.replace(/[^a-z0-9]/gi,"-"),".txt"),a.click(),URL.revokeObjectURL(r)}else alert("No messages to export")}},{key:"saveChatHistory",value:function(){try{localStorage.setItem("stellarAI_chats",JSON.stringify(this.chats)),localStorage.setItem("stellarAI_currentChatId",this.currentChatId),this.currentUser&&this.saveToBackend()}catch(e){console.error("Error saving chat history:",e)}}},{key:"loadChatHistory",value:function(){try{var e=localStorage.getItem("stellarAI_chats");e&&(this.chats=JSON.parse(e));var t=localStorage.getItem("stellarAI_currentChatId");t&&this.chats.find(function(e){return e.id===t})&&(this.currentChatId=t,this.switchToChat(t)),this.updateChatHistory()}catch(e){console.error("Error loading chat history:",e)}}},{key:"loadUserSession",value:function(){var e=localStorage.getItem("stellarAI_user");e&&(this.currentUser=JSON.parse(e),this.updateUserUI())}},{key:"loadModelPreference",value:function(){var e=localStorage.getItem("stellarAI_selectedModel");if(e){this.selectedModel=e;var t=document.getElementById("model-selector");t&&(t.value=e),e&&(e.includes("live")||e.includes("native-audio"))&&(console.log("Saved model is live - Puter.js disabled"),window.PUTER_DISABLE_AUTO_LOGIN=!0,this.puterAvailable=!1)}}},{key:"saveModelPreference",value:function(){localStorage.setItem("stellarAI_selectedModel",this.selectedModel)}},{key:"showModelChangeNotification",value:function(){var e=document.createElement("div");e.className="model-change-notification",e.textContent="Switched to ".concat(this.getModelDisplayName(this.selectedModel)),document.body.appendChild(e),setTimeout(function(){e.classList.add("show")},10),setTimeout(function(){e.classList.remove("show"),setTimeout(function(){return e.remove()},300)},2e3)}},{key:"getModelDisplayName",value:function(e){return{"sonnet-4.5":"Claude Sonnet 4.5","sonnet-4":"Claude Sonnet 4","opus-4":"Claude Opus 4","haiku-4":"Claude Haiku 4","gpt-4o":"GPT-4o","gpt-4-turbo":"GPT-4 Turbo","gpt-3.5-turbo":"GPT-3.5 Turbo","gemini-2.5-flash-native-audio-preview-09-2025":"Gemini 2.5 Flash Native Audio (Live) üé§","gemini-2.5-flash-live":"Gemini 2.5 Flash Live üé§","gemini-pro":"Gemini Pro","llama-3.1":"Llama 3.1",fallback:"Fallback (Demo)"}[e]||e}},{key:"getGeminiLiveResponse",value:(r=(0,s.A)(u().mark(function e(t){var n,o,r,a,i,s,l,c,d,m,g,h,p,v,f,y,b,w,I=arguments;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I.length>1&&void 0!==I[1]&&I[1],e.prev=1,o="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:3001":window.STELLAR_AI_BACKEND_URL||null,r=window.GEMINI_API_KEY||("undefined"!=typeof GEMINI_API_KEY?GEMINI_API_KEY:null),o||r&&"YOUR_GEMINI_API_KEY_HERE"!==r){e.next=2;break}throw new Error("Gemini API key not configured. Please set your API key in gemini-config.js or ensure the backend server is running.");case 2:if(t.messages.filter(function(e){return"user"===e.role}).slice(-1)[0]){e.next=3;break}throw new Error("No user message found");case 3:if(a=t.messages.slice(-10),i=[],a.forEach(function(e){i.push({role:"user"===e.role?"user":"model",parts:[{text:e.content}]})}),0!==i.length){e.next=4;break}throw new Error("No conversation history found");case 4:s=o?["gemini-2.0-flash-live-preview-04-09","gemini-2.5-flash-live","gemini-2.5-flash-native-audio-preview-09-2025","gemini-live-2.5-flash-preview","gemini-2.5-flash","gemini-1.5-flash","gemini-1.5-pro"]:["gemini-2.5-flash","gemini-1.5-flash","gemini-1.5-pro"],l=!1,console.log("[Stellar AI] Model list (in order):",s),console.log("[Stellar AI] Backend URL:",o),c=0,d=s;case 5:if(!(c<d.length)){e.next=12;break}return m=d[c],e.prev=6,console.log("üîç [".concat((new Date).toISOString(),"] Trying model: ").concat(m,"...")),e.next=7,this.callGeminiLiveWebSocket(m,i,r,n);case 7:if(!(g=e.sent)||!g.trim()){e.next=8;break}return console.log("‚úÖ Success with model: ".concat(m)),e.abrupt("return",g);case 8:e.next=11;break;case 9:if(e.prev=9,y=e.catch(6),console.error("‚ùå Model ".concat(m," failed:"),y.message),console.error("üìã Error type:",y.constructor.name),console.error("üìã Full error:",y),!((h=y.message.toLowerCase()).includes("websocket")||h.includes("404")||h.includes("websocket_not_available")||h.includes("vertex ai")||h.includes("endpoint returned")||h.includes("endpoint not available"))){e.next=10;break}return console.log("‚ö†Ô∏è WebSocket not available for live models. Skipping to REST API fallback..."),console.log("üîÑ Breaking out of live models loop..."),l=!0,e.abrupt("continue",12);case 10:return console.log("‚è≠Ô∏è Continuing to next model..."),e.abrupt("continue",11);case 11:c++,e.next=5;break;case 12:if(console.log("üìä Loop completed. WebSocket failed: ".concat(l)),console.log("üîÑ Falling back to REST API streaming..."),console.log("üìù Note: Live models require Vertex AI. Using standard model via REST API."),p=r||window.GEMINI_API_KEY||("undefined"!=typeof GEMINI_API_KEY?GEMINI_API_KEY:null),console.log("üîë API Key check:",{provided:!!r,windowKey:!!window.GEMINI_API_KEY,globalKey:"undefined"!=typeof GEMINI_API_KEY,finalKey:!!p&&"YOUR_GEMINI_API_KEY_HERE"!==p}),p&&"YOUR_GEMINI_API_KEY_HERE"!==p){e.next=13;break}throw console.error("‚ùå API key not available for REST API fallback"),new Error("API key not available for REST API fallback. Please set GEMINI_API_KEY in gemini-config.js");case 13:return e.prev=13,v="gemini-2.5-flash",console.log("üåê Trying REST API streaming with model: ".concat(v,"...")),console.log("üì° Using endpoint: streamGenerateContent (REST API)"),console.log("üì¶ Contents to send: ".concat(i.length," messages")),console.log("üîë Using API key: ".concat(p.substring(0,10),"...")),e.next=14,this.callGeminiLiveWebSocket(v,i,p,n);case 14:if(!(f=e.sent)||!f.trim()){e.next=15;break}return console.log("‚úÖ Success with REST API model: ".concat(v)),console.log("üìä Response length: ".concat(f.length," characters")),e.abrupt("return",f);case 15:console.warn("‚ö†Ô∏è REST API returned empty response");case 16:e.next=20;break;case 17:if(e.prev=17,b=e.catch(13),console.error("‚ùå REST API fallback also failed:",b.message),console.error("üîç Error details:",b),!b.message.includes("API key")){e.next=18;break}throw new Error("API key issue: "+b.message+". Please check your API key in gemini-config.js or backend/.env");case 18:if(!b.message.includes("network")&&!b.message.includes("fetch")){e.next=19;break}throw new Error("Network error: "+b.message+". Please check your internet connection.");case 19:throw new Error("REST API failed: "+b.message+". Please try again or check the console for details.");case 20:throw new Error("All models failed. Please check your API key, network connection, or try again later.");case 21:if(e.prev=21,w=e.catch(1),console.error("Error getting Gemini Live response:",w),!w.message.includes("API key")){e.next=23;break}if("localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||window.STELLAR_AI_BACKEND_URL){e.next=22;break}return e.abrupt("return","‚ö†Ô∏è Gemini API key not configured. Please set your API key in gemini-config.js to use Gemini 2.5 Flash Live.");case 22:return e.abrupt("return","‚ö†Ô∏è Backend server may not be running. Please ensure the backend server is running on port 3001.");case 23:return e.abrupt("return","I apologize, but I encountered an error: ".concat(w.message,". Please try again or switch to another model."));case 24:case"end":return e.stop()}},e,this,[[1,21],[6,9],[13,17]])})),function(e){return r.apply(this,arguments)})},{key:"callGeminiLiveViaBackend",value:(o=(0,s.A)(u().mark(function e(t,n,o){var r,a=this,i=arguments;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>3&&void 0!==i[3]&&i[3],e.abrupt("return",new Promise(function(e,i){console.log("[Stellar AI] Connecting to WebSocket:",t);var s=new WebSocket(t),l="",c=!1,d=!1,u=!1,m=setTimeout(function(){d||(d=!0,console.log("[Stellar AI] WebSocket timeout after 60 seconds"),console.log("[Stellar AI] Timeout state:",{setupComplete:c,responseLength:l.length,model:n}),s.close(),i(new Error("WebSocket timeout")))},6e4);s.onopen=function(){console.log("[Stellar AI] WebSocket opened");var e={setup:{model:"models/".concat(n),generationConfig:{temperature:.7,maxOutputTokens:8192,responseModalities:["TEXT"]}}};s.send(JSON.stringify(e))},s.onmessage=function(t){try{var n,g,h,p,v=JSON.parse(t.data);if(console.log("[Stellar AI] Received WebSocket message:",{hasError:!!v.error,hasSetupComplete:!(!v.setupComplete&&!v.BidiGenerateContentSetupComplete),hasServerContent:!!v.serverContent,hasModelTurn:!(null===(n=v.serverContent)||void 0===n||!n.modelTurn),hasParts:!(null===(g=v.serverContent)||void 0===g||!g.parts),turnComplete:null===(h=v.serverContent)||void 0===h?void 0:h.turnComplete,generationComplete:null===(p=v.serverContent)||void 0===p?void 0:p.generationComplete}),v.error){clearTimeout(m);var f=v.error.message||"Gemini API error",y=v.error.code||"";return console.log("[Stellar AI] Received error from backend:",f,"Code:",y),void(d||(d=!0,clearTimeout(m),"WEBSOCKET_NOT_AVAILABLE"===y||f.includes("WebSocket endpoint not available")||f.includes("404")||f.includes("Live models may require Vertex AI")?(console.log("[Stellar AI] WebSocket not available - will trigger REST fallback"),i(new Error("WEBSOCKET_NOT_AVAILABLE: "+f))):i(new Error(f)),s.close()))}if(v.setupComplete||v.BidiGenerateContentSetupComplete){c=!0;var b={clientContent:{turns:[{role:"user",parts:[{text:o.flatMap(function(e){return e.parts||[]}).filter(function(e){return e.text}).map(function(e){return e.text}).join(" ")}]}],turnComplete:!0}};console.log("[Stellar AI] Sending client content with turns format"),s.send(JSON.stringify(b))}else if(v.serverContent){var w,I,k,x=!1,E="",S=v.serverContent.turnComplete||v.serverContent.generationComplete;if(S&&l.trim()&&console.log("[Stellar AI] Turn complete detected with accumulated text"),null!==(w=v.serverContent.modelTurn)&&void 0!==w&&w.parts?(console.log("[Stellar AI] Processing modelTurn.parts:",{partsCount:v.serverContent.modelTurn.parts.length,parts:v.serverContent.modelTurn.parts.map(function(e){var t;return{hasText:!!e.text,textLength:(null===(t=e.text)||void 0===t?void 0:t.length)||0}})}),v.serverContent.modelTurn.parts.forEach(function(e){e.text&&(E+=e.text,l+=e.text,x=!0)})):v.serverContent.parts&&(console.log("[Stellar AI] Processing serverContent.parts:",{partsCount:v.serverContent.parts.length,parts:v.serverContent.parts.map(function(e){var t;return{hasText:!!e.text,textLength:(null===(t=e.text)||void 0===t?void 0:t.length)||0}})}),v.serverContent.parts.forEach(function(e){e.text&&(E+=e.text,l+=e.text,x=!0)})),S&&!x&&l.trim()&&console.log("[Stellar AI] Turn complete message without text - using accumulated responseText"),x){if(console.log("[Stellar AI] Received text chunk:",{chunkLength:E.length,totalLength:l.length,preview:E.substring(0,50)+"..."}),r&&E)if(u)a.updateStreamingMessage(E);else{var A={role:"assistant",content:E,timestamp:(new Date).toISOString()};a.startStreamingMessage(A),u=!0}}else console.log("[Stellar AI] No text found in serverContent:",{hasModelTurn:!!v.serverContent.modelTurn,hasParts:!!v.serverContent.parts,turnComplete:v.serverContent.turnComplete,generationComplete:v.serverContent.generationComplete});if(((null===(I=v.serverContent)||void 0===I?void 0:I.turnComplete)||(null===(k=v.serverContent)||void 0===k?void 0:k.generationComplete)||v.turnComplete)&&!d){var C,M,T,L;console.log("[Stellar AI] Turn/generation complete detected. Response text length:",l.length),console.log("[Stellar AI] Completion message details:",{hasServerContent:!!v.serverContent,hasModelTurn:!(null===(C=v.serverContent)||void 0===C||!C.modelTurn),hasParts:!(null===(M=v.serverContent)||void 0===M||!M.parts),turnComplete:null===(T=v.serverContent)||void 0===T?void 0:T.turnComplete,generationComplete:null===(L=v.serverContent)||void 0===L?void 0:L.generationComplete,accumulatedTextLength:l.length}),d=!0,clearTimeout(m);var P=l.trim();if(P){if(r&&u&&a.streamingMessageElement){var N={role:"assistant",content:P,timestamp:(new Date).toISOString()};a.finalizeStreamingMessage(N)}else if(!u){console.log("[Stellar AI] ‚úÖ Displaying accumulated response (length:",P.length,")");var _={role:"assistant",content:P,timestamp:(new Date).toISOString()};a.appendMessage(_)}setTimeout(function(){s.close()},100),e(P)}else console.warn("[Stellar AI] ‚ö†Ô∏è Turn complete but no response text accumulated"),setTimeout(function(){s.close()},100),i(new Error("Turn complete but no response received"));return}}}catch(e){console.error("Error parsing WebSocket message:",e)}},s.onerror=function(e){console.error("[Stellar AI] WebSocket error:",e),d||(d=!0,clearTimeout(m),i(new Error("WebSocket connection failed: ".concat(e.message||"Unknown error"))))},s.onclose=function(t){if(clearTimeout(m),console.log("[Stellar AI] WebSocket closed. Code:",t.code,"Reason:",t.reason),console.log("[Stellar AI] Setup complete:",c,"Response text length:",l.length,"Resolved:",d),d)console.log("[Stellar AI] Already resolved, ignoring close event");else if(l&&l.trim()&&(1e3===t.code||1001===t.code)){if(console.log("[Stellar AI] ‚úÖ Normal closure with response text, resolving"),d=!0,!u&&l.trim()){var n={role:"assistant",content:l.trim(),timestamp:(new Date).toISOString()};a.appendMessage(n)}e(l.trim())}else if(l&&l.trim()){if(console.log("[Stellar AI] ‚úÖ Resolving with response text (non-normal closure)"),d=!0,!u&&l.trim()){var o={role:"assistant",content:l.trim(),timestamp:(new Date).toISOString()};a.appendMessage(o)}e(l.trim())}else c?(d=!0,console.log("[Stellar AI] WebSocket closed after setup but no response received"),i(new Error("No response received"))):(d=!0,1006===t.code||1008===t.code?(console.log("[Stellar AI] WebSocket closed abnormally (404 likely) - triggering REST fallback"),i(new Error("WEBSOCKET_NOT_AVAILABLE: WebSocket endpoint requires Vertex AI. Use REST API fallback."))):(console.log("[Stellar AI] WebSocket closed before setup - code:",t.code),i(new Error("Connection closed before setup"))))}}));case 1:case"end":return e.stop()}},e)})),function(e,t,n){return o.apply(this,arguments)})},{key:"callGeminiLiveWebSocket",value:(n=(0,s.A)(u().mark(function e(t,n,o){var r,a,i;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:3001":window.STELLAR_AI_BACKEND_URL||null,a=r?"ws://".concat(r.replace(/^https?:\/\//,""),"/api/gemini-live"):null,console.log("[Stellar AI] WebSocket URL:",a),console.log("[Stellar AI] Backend URL:",r),console.log("[Stellar AI] Model:",t),!a||!t.includes("live")){e.next=1;break}return console.log("[Stellar AI] Using backend WebSocket proxy (API key handled by backend)"),e.abrupt("return",this.callGeminiLiveViaBackend(a,t,n,enableStreaming));case 1:if(i=o||window.GEMINI_API_KEY||("undefined"!=typeof GEMINI_API_KEY?GEMINI_API_KEY:null),console.log("[Stellar AI] API Key check:",{provided:!!o,windowKey:!!window.GEMINI_API_KEY,globalKey:"undefined"!=typeof GEMINI_API_KEY,finalKey:!!i&&"YOUR_GEMINI_API_KEY_HERE"!==i}),i&&"YOUR_GEMINI_API_KEY_HERE"!==i){e.next=2;break}throw console.warn("‚ö†Ô∏è API key not found in frontend. REST API fallback may not work."),console.warn("üí° Set GEMINI_API_KEY in gemini-config.js for direct REST API calls."),new Error("API key required for direct REST API calls. Please set your API key in gemini-config.js or ensure the backend server is running.");case 2:return console.log("[Stellar AI] Using API key for REST API fallback"),e.abrupt("return",new Promise(function(e,r){var a;a=t.includes("live")||t.includes("native-audio")?"gemini-2.0-flash-exp":"gemini-1.5-pro"===t?"gemini-1.5-pro-latest":"gemini-1.5-flash"===t?"gemini-1.5-flash-latest":"gemini-pro"===t?"gemini-pro":"gemini-1.5-flash";var i=o||window.GEMINI_API_KEY||("undefined"!=typeof GEMINI_API_KEY?GEMINI_API_KEY:null),s="https://generativelanguage.googleapis.com/v1beta/models/".concat(a,":streamGenerateContent?key=").concat(i);console.log("[Stellar AI] Calling REST API:",s.replace(/\?key=.*$/,"?key=***")),console.log("[Stellar AI] Model:",a);var l="",c={contents:n,generationConfig:{temperature:.7,maxOutputTokens:8192,topP:.95,topK:40}};console.log("[Stellar AI] Starting REST API fetch request..."),console.log("[Stellar AI] Request URL:",s.replace(/\?key=.*$/,"?key=***")),console.log("[Stellar AI] Request payload size:",JSON.stringify(c).length,"bytes");try{fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}).then(function(t){if(console.log("[Stellar AI] REST API response status:",t.status,t.statusText),console.log("[Stellar AI] Response headers:",Object.fromEntries(t.headers.entries())),!t.ok)return t.json().then(function(e){var n;throw console.error("[Stellar AI] REST API error response:",e),new Error((null===(n=e.error)||void 0===n?void 0:n.message)||"HTTP ".concat(t.status,": ").concat(t.statusText))});console.log("[Stellar AI] ‚úÖ REST API response OK, starting to read stream...");var n=t.body.getReader(),o=new TextDecoder;!function t(){n.read().then(function(n){var a=n.done,i=n.value;if(a)l?e(l.trim()):r(new Error("Empty response from Gemini API"));else try{var s=o.decode(i,{stream:!0});console.log("[Stellar AI] üì• Received chunk:",s.length,"bytes");var c=s.split("\n").filter(function(e){return e.trim()});console.log("[Stellar AI] üìã Parsed",c.length,"lines from chunk");var d,u=m(c);try{for(u.s();!(d=u.n()).done;){var g=d.value;if(g.startsWith("data: ")){var h=g.substring(6);if("[DONE]"===h)return console.log("[Stellar AI] ‚úÖ Stream complete. Total response:",l.length,"characters"),void(l?e(l.trim()):r(new Error("Empty response from Gemini API")));try{var p=JSON.parse(h);if(p.error)return console.error("[Stellar AI] ‚ùå API error in stream:",p.error),void r(new Error("API error: ".concat(p.error.message||JSON.stringify(p.error))));if(p.candidates&&p.candidates[0]){var v=p.candidates[0];v.content&&v.content.parts&&v.content.parts.forEach(function(e){e.text&&(l+=e.text,console.log("[Stellar AI] üìù Received text chunk:",e.text.length,"chars (total:",l.length,")"))})}}catch(e){console.warn("[Stellar AI] ‚ö†Ô∏è Error parsing SSE data:",e,"Data:",h.substring(0,100))}}}}catch(e){u.e(e)}finally{u.f()}t()}catch(e){r(new Error("Error processing stream: ".concat(e.message)))}}).catch(function(e){r(new Error("Stream read error: ".concat(e.message)))})}()}).catch(function(e){console.error("Gemini API request failed:",e),r(new Error("Gemini API request failed: ".concat(e.message)))})}catch(e){r(new Error("Request setup failed: ".concat(e.message)))}}));case 3:case"end":return e.stop()}},e,this)})),function(e,t,o){return n.apply(this,arguments)})},{key:"updateUserUI",value:function(){var e=this;if(this.currentUser){var t=document.querySelector(".user-name"),n=document.querySelector(".user-avatar");t&&(t.textContent=this.currentUser.name),n&&(n.textContent=this.currentUser.name.charAt(0).toUpperCase());var o=document.getElementById("login-btn");o&&(o.textContent="Logout",o.onclick=function(){return e.logout()})}}},{key:"showLoginModal",value:function(){var e=document.getElementById("login-modal");e&&e.classList.add("show")}},{key:"logout",value:function(){confirm("Logout? Your chat history will be cleared from this device.")&&(localStorage.removeItem("stellarAI_user"),this.currentUser=null,location.reload())}},{key:"saveToBackend",value:(t=(0,s.A)(u().mark(function e(){return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Saving to backend...");case 1:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)})},{key:"downloadCLI",value:(e=(0,s.A)(u().mark(function e(){var t,n,o,r,a,i,s,l,c=this;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.getElementById("download-cli-btn"),n=t.innerHTML,t.disabled=!0,t.innerHTML="<span>‚è≥</span> Preparing download...",e.prev=1,o="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:3001":"",r="",a=!1,!o){e.next=5;break}return e.prev=2,e.next=3,fetch("".concat(o,"/health"),{method:"GET",timeout:2e3});case 3:e.sent.ok&&(r="".concat(o,"/api/cli/download"),a=!0),e.next=5;break;case 4:e.prev=4,e.catch(2),console.log("Backend not available, using GitLab direct download");case 5:a||(i=window.location.origin,r="".concat(i,"/stellar-ai-cli.zip")),(s=document.createElement("a")).href=r,s.download="stellar-ai-cli.zip",s.target="_blank",s.style.display="none",document.body.appendChild(s),s.click(),setTimeout(function(){t.disabled=!1,t.innerHTML=n,c.showDownloadInstructions(a)},1e3),setTimeout(function(){document.body.contains(s)&&document.body.removeChild(s)},3e3),e.next=7;break;case 6:e.prev=6,l=e.catch(1),console.error("Download error:",l),t.disabled=!1,t.innerHTML=n,alert("‚ùå Download failed. Please visit the GitLab repository to download manually:\n\nhttps://gitlab.com/adybag14-group/starisdons");case 7:case"end":return e.stop()}},e,null,[[1,6],[2,4]])})),function(){return e.apply(this,arguments)})},{key:"showDownloadInstructions",value:function(e){var t=document.createElement("div");t.id="download-instructions-modal",t.style.cssText="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0, 0, 0, 0.9);\n            z-index: 10000;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            padding: 20px;\n        ",t.innerHTML='\n            <div style="\n                background: linear-gradient(135deg, rgba(10, 10, 15, 0.95), rgba(20, 20, 30, 0.95));\n                border: 2px solid rgba(186, 148, 79, 0.5);\n                border-radius: 20px;\n                padding: 3rem;\n                max-width: 700px;\n                max-height: 90vh;\n                overflow-y: auto;\n                position: relative;\n            ">\n                <button onclick="this.closest(\'#download-instructions-modal\').remove()" style="\n                    position: absolute;\n                    top: 1rem;\n                    right: 1rem;\n                    background: transparent;\n                    border: 2px solid rgba(186, 148, 79, 0.5);\n                    color: #ba944f;\n                    width: 40px;\n                    height: 40px;\n                    border-radius: 50%;\n                    cursor: pointer;\n                    font-size: 1.5rem;\n                    display: flex;\n                    align-items: center;\n                    justify-content: center;\n                ">&times;</button>\n                \n                <h2 style="color: #ba944f; margin-bottom: 1.5rem; font-size: 2rem;">üì• Download & Setup Instructions</h2>\n                \n                '.concat(e?'\n                    <div style="background: rgba(74, 222, 128, 0.1); border: 1px solid rgba(74, 222, 128, 0.3); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;">\n                        <p style="color: #4ade80; margin: 0;">‚úÖ Download started! You\'re downloading only the Stellar AI CLI package - ready to use!</p>\n                    </div>\n                ':'\n                    <div style="background: rgba(255, 193, 7, 0.1); border: 1px solid rgba(255, 193, 7, 0.3); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;">\n                        <p style="color: #ffc107; margin: 0;">‚ö†Ô∏è You\'re downloading the full repository. After extraction, navigate to the <code>stellar-ai-cli</code> folder.</p>\n                    </div>\n                ','\n                \n                <div style="background: rgba(74, 222, 128, 0.1); border: 1px solid rgba(74, 222, 128, 0.3); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem;">\n                    <p style="color: #4ade80; margin: 0; font-weight: 600;">‚ú® All-in-One Package!</p>\n                    <p style="color: rgba(255, 255, 255, 0.8); margin: 0.5rem 0 0 0; font-size: 0.9rem;">\n                        This package includes automatic setup scripts. No manual configuration needed!\n                    </p>\n                </div>\n                \n                <h3 style="color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;">Step 1: Extract the ZIP File</h3>\n                <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1.5rem; line-height: 1.6;">\n                    ').concat(e?'Extract the downloaded ZIP file to a location of your choice. You\'ll see a folder named <code style="background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;">stellar-ai-cli</code> - this is the complete CLI package, ready to use!':'Extract the downloaded ZIP file to a location of your choice. You\'ll see a folder named <code style="background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;">stellar-ai-cli</code> or <code style="background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;">new-starsiadr-main</code>. Navigate to the <code>stellar-ai-cli</code> folder inside.','\n                </p>\n                \n                <h3 style="color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;">Step 2: Automatic Setup (Recommended)</h3>\n                <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;">\n                    <strong>Windows:</strong> Double-click <code style="background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;">setup.bat</code>\n                </p>\n                <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;">\n                    <strong>Linux/Mac:</strong> Open terminal and run:\n                </p>\n                <div style="background: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; font-family: \'Courier New\', monospace;">\n                    <code style="color: #4ade80;">chmod +x setup.sh</code><br>\n                    <code style="color: #4ade80;">./setup.sh</code>\n                </div>\n                <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-bottom: 1.5rem;">\n                    The setup script will automatically check for Node.js, install all dependencies, and configure everything for you!\n                </p>\n                \n                <h3 style="color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;">Step 3: Start Stellar AI CLI</h3>\n                <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;">\n                    <strong>Windows:</strong> Double-click <code style="background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;">start.bat</code>\n                </p>\n                <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;">\n                    <strong>Linux/Mac:</strong> Run:\n                </p>\n                <div style="background: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; font-family: \'Courier New\', monospace;">\n                    <code style="color: #4ade80;">./start.sh</code>\n                </div>\n                <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-bottom: 1.5rem;">\n                    Or manually: <code style="background: rgba(186, 148, 79, 0.2); padding: 2px 6px; border-radius: 3px;">node index.js</code>\n                </p>\n                \n                <h3 style="color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;">Step 5: Authenticate with Puter.js (Optional)</h3>\n                <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 1rem; line-height: 1.6;">\n                    If you want to use Puter.js features, run:\n                </p>\n                <div style="background: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; font-family: \'Courier New\', monospace;">\n                    <code style="color: #4ade80;">/login</code>\n                </div>\n                <p style="color: rgba(255, 255, 255, 0.6); font-size: 0.9rem; margin-bottom: 1.5rem;">\n                    This will open a browser window for Puter.js authentication.\n                </p>\n                \n                <h3 style="color: #ba944f; margin-top: 2rem; margin-bottom: 1rem;">Available Commands</h3>\n                <div style="background: rgba(0, 0, 0, 0.5); padding: 1rem; border-radius: 10px; margin-bottom: 1.5rem; font-family: \'Courier New\', monospace; font-size: 0.9rem;">\n                    <code style="color: #4ade80;">/help</code> - Show all commands<br>\n                    <code style="color: #4ade80;">/model [name]</code> - Change AI model<br>\n                    <code style="color: #4ade80;">/login</code> - Authenticate with Puter.js<br>\n                    <code style="color: #4ade80;">/logout</code> - Sign out from Puter.js<br>\n                    <code style="color: #4ade80;">/agent add [name] [model]</code> - Add multi-agent<br>\n                    <code style="color: #4ade80;">/clear</code> - Clear chat history\n                </div>\n                \n                <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(186, 148, 79, 0.3);">\n                    <p style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; margin-bottom: 1rem;">\n                        Need help? Visit the repository:\n                    </p>\n                    <a href="https://gitlab.com/adybag14-group/starisdons" target="_blank" style="\n                        display: inline-block;\n                        padding: 0.75rem 1.5rem;\n                        background: rgba(186, 148, 79, 0.2);\n                        border: 2px solid rgba(186, 148, 79, 0.5);\n                        border-radius: 10px;\n                        color: #ba944f;\n                        text-decoration: none;\n                        font-weight: 600;\n                    ">üì¶ View Repository</a>\n                </div>\n            </div>\n        '),document.body.appendChild(t),t.addEventListener("click",function(e){e.target===t&&t.remove()})}},{key:"checkPuterToken",value:function(){if(this.selectedModel&&(this.selectedModel.includes("live")||this.selectedModel.includes("native-audio")))console.log("Skipping Puter.js token check - using live model");else{var e=document.getElementById("puter-token-section"),t=document.getElementById("puter-token-input");if(e&&t){var n=localStorage.getItem("puterAuthToken");if(n)return t.value=n,void(e.style.display="block");if("undefined"!=typeof puter&&puter.auth)var o=0,r=setInterval(function(){o++;try{if(puter.auth.isSignedIn&&"function"==typeof puter.auth.isSignedIn&&puter.auth.isSignedIn()&&puter.auth.getToken){var n=puter.auth.getToken();if(n)return t.value=n,e.style.display="block",localStorage.setItem("puterAuthToken",n),void clearInterval(r)}if(void 0!==puter.storage&&puter.storage.get)try{puter.storage.get("auth_token").then(function(n){n&&(t.value=n,e.style.display="block",localStorage.setItem("puterAuthToken",n),clearInterval(r))}).catch(function(){})}catch(e){}}catch(e){}o>=3&&clearInterval(r)},2e3)}}}}]);var e,t,n,o,r,d,g,h,p,v}();function v(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){h||(h=new p)}):h||(h=new p)}window.usePrompt=function(e){var t=document.getElementById("message-input");t&&(t.value=e,t.focus())},window.hideLoginModal=function(){var e=document.getElementById("login-modal");e&&e.classList.remove("show")},"undefined"!=typeof window&&(window.hideLoginModal=window.hideLoginModal||function(){var e=document.getElementById("login-modal");e&&e.classList.remove("show")}),window.handleLogin=function(e){e.preventDefault();var t=e.target.querySelector('input[type="email"]'),n=t?t.value:"",o={name:n.split("@")[0],email:n};localStorage.setItem("stellarAI_user",JSON.stringify(o)),h.currentUser=o,h.updateUserUI(),"function"==typeof window.hideLoginModal&&window.hideLoginModal(),alert("Login successful! Your chats will now be saved.")},window.addEventListener("load",function(){h||(h=new p)}),v(),v()}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.m=t,e=[],o.O=(t,n,r,a)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,r,a]=e[d],s=!0,l=0;l<n.length;l++)(!1&a||i>=a)&&Object.keys(o.O).every(e=>o.O[e](n[l]))?n.splice(l--,1):(s=!1,a<i&&(i=a));if(s){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,r,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[i,s,l]=n,c=0;if(i.some(t=>0!==e[t])){for(r in s)o.o(s,r)&&(o.m[r]=s[r]);if(l)var d=l(o)}for(t&&t(n);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(d)},n=self.webpackChunkadriano_to_the_star=self.webpackChunkadriano_to_the_star||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=o.O(void 0,[277],()=>o(835));r=o.O(r)})();